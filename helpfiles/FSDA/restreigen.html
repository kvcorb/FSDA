<html>
<head>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <title>restreigen :: Functions (Flexible Statistics Data Analysis
  Toolbox™)</title>
  <link href="docstyle.css" rel="stylesheet" type="text/css">
  <meta content="refpage" name="chunktype">
  <meta content="function:FSM" name="refentity">
  <meta content="text/javascript" http-equiv="Content-Script-Type">
  <meta content="fcn" name="toctype">
  <script type="text/javascript" language="javaScript" src="bottom.js">
 </script>
  <style type="text/css">
 .auto-style1 {
        background-color: #FFFFFF;
}</style>
</head>

<body>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<!--FScategory:Clustering-->
<a name="top_of_page"></a> 

<p style="font-size: 1px;"> </p>

<table border="0" cellpadding="0" cellspacing="0" class="nav"
summary="Navigation aid" width="100%">
  <tbody>
    <tr>
      <td valign="baseline"><b>Flexible Statistics Data Analysis
      Toolbox™</b></td>
      <td align="right" valign="baseline"><a href="resindexplot.html"><img
        align="bottom" alt="fanplot" border="0"
        src="images_help/b_prev.gif"></a>   <a href="rlga.html"><img
        align="bottom" alt="FSMeda" border="0"
      src="images_help/b_next.gif"></a></td>
    </tr>
  </tbody>
</table>


<h1 class="reftitle">restreigen</h1>

<p class="purpose">restreigen restricts the eigenvalues according to the
constraint specified in scalar restr. This function is called in every
concentration step of function <a href="tclust.html">tclust</a> and can also be
used inside function <a href="mixsim.html">MixSim</a> to generate groups with
shape restrictions </p>

<h2>Syntax </h2>

<p class="synopsis"><tt>[out] = restreigen(eigenvalues, niini, restr)<br>
[out] = restreigen(eigenvalues, niini, restr, tol, userepmat) <br>
</tt></p>
<a name="f4811966"></a> 

<h2>Description </h2>

<p>Suppose that the data at hand <span class="zptmcm7m-">y</span><sub><span
class="zptmcm7t-x-x-74">1</span></sub><span
class="zptmcm7m-">,...,y</span><sub><span
class="zptmcm7m-x-x-74">n</span></sub> in <span
class="zptmcm7m-">R</span><sup><span class="zptmcm7m-x-x-74">v</span></sup>
come from a probability distribution with density <span
class="zptmcm7v-">∑</span><sub><span class="zptmcm7m-x-x-74">j</span><span
class="zptmcm7t-x-x-74">=1</span></sub><sup><span
class="zptmcm7m-x-x-74">k</span></sup><span
class="zptmcm7m-">π</span><sub><span
class="zptmcm7m-x-x-74">j</span></sub><span class="zptmcm7m-">ϕ</span><span
class="zptmcm7t-">(</span><span class="zptmcm7y-">⋅</span><span
class="zptmcm7m-">,θ</span><sub><span
class="zptmcm7m-x-x-74">j</span></sub><span class="zptmcm7t-">) </span>with
<span class="zptmcm7m-">ϕ</span><span class="zptmcm7t-">(</span><span
class="zptmcm7y-">⋅</span><span class="zptmcm7m-">,θ</span><sub><span
class="zptmcm7m-x-x-74">j</span></sub><span class="zptmcm7t-">) </span>being
the <span class="zptmcm7m-">v</span>-variate (generally multivariate normal)
densities with parameters <span class="zptmcm7m-">θ</span><sub><span
class="zptmcm7m-x-x-74">j</span></sub>, <span class="zptmcm7m-">j </span><span
class="zptmcm7t-">= 1</span><span class="zptmcm7m-">,</span><span
class="zptmcm7m-">…</span><span class="zptmcm7m-">,k</span>. Generally <span
class="zptmcm7m-">θ</span><sub><span class="zptmcm7m-x-x-74">j</span></sub>
<span class="zptmcm7t-">= (</span><span class="zptmcm7m-">μ</span><sub><span
class="zptmcm7m-x-x-74">j</span></sub><span
class="zptmcm7m-">,Σ</span><sub><span
class="zptmcm7m-x-x-74">j</span></sub><span class="zptmcm7t-">) </span>where
<span class="zptmcm7m-">μ</span><sub><span
class="zptmcm7m-x-x-74">j</span></sub> is the population mean and <span
class="zptmcm7m-">Σ</span><sub><span class="zptmcm7m-x-x-74">j</span></sub> is
the covariance matrix for component <span class="zptmcm7m-">j</span>. Let
λ<span class="zptmcm7m-"><sub>l</sub>(Σ</span><sub><span
class="zptmcm7m-x-x-74">j</span></sub>) be the l-th eigenvalue of covariance
matrix of group j, (l = 1,…,v; j = 1,…,k) This routine imposes the
constraint: </p>

<p><img alt="" src="images_help/img1E1.gif"></p>

<p> </p>

<p><tt>restreigen</tt> admits the following inputs</p>

<p> </p>

<table cellspacing="0" class="body" cellpadding="4" border="2">
  <colgroup><col width="29%">
    <col width="71%">
  </colgroup>
  <tbody>
    <tr valign="top">
      <td><p><tt>eigenvalues</tt></p>
      </td>
      <td><p>v x k matrix containing the eigenvalues of the covariance matrices
        of the k groups</p>
      </td>
    </tr>
    <tr valign="top">
      <td><p><tt>niini</tt></p>
      </td>
      <td><p>k x 1 vector containing the size of the k clusters</p>
      </td>
    </tr>
    <tr>
      <td style="height: 32px"><p><tt>restr</tt></p>
      </td>
      <td style="height: 32px"><p>scalar in the interval [1 ∞] which
        specifies the maximum ratio to allow between the largest eigenvalue and
        the smallest eigenvalue of the k covariance matrices which are
        generated.  Setting restr to 1, yields the strongest restriction,
        forcing all eigenvalues/determinants to be equal and so the method
        looks for similarly scattered (respectively spherical) clusters.</p>
      </td>
    </tr>
  </tbody>
</table>

<p>Optional parameters tol and userepmat are referred to tolerance and
efficiency of calculations</p>

<p> </p>

<table cellspacing="0" class="body" cellpadding="4" border="2">
  <colgroup><col width="29%">
    <col width="71%">
  </colgroup>
  <tbody>
    <tr valign="top">
      <td><p><tt>tol</tt></p>
      </td>
      <td><p>scalar defining the tolerance of the procedure. The default value
        is 1e-8</p>
      </td>
    </tr>
    <tr valign="top">
      <td><p><tt>userepmat</tt></p>
      </td>
      <td><p>scalar. If userepmat is true function repmat is used instead of
        bsxfun inside the procedure. Remark: repmat is built in from MATLAB
        2013b so it is faster to use repmat if the current version of MATLAB is
        &gt;2013a</p>
      </td>
    </tr>
  </tbody>
</table>

<p><tt>[out] = restreigen(eigenvalues, niini, restr)</tt> returns a v-by-k
matrix containing restricted eigenvalues. The ratio between two possible
elements in matrix out is not greater than restr. </p>

<h2>References </h2>

<p>Fritz H. Garcia-Escudero, L.A. and Mayo-Iscar, A. (2012), A fast algorithm
for robust constrained clustering. Available at
http://www.eio.uva.es/infor/personas/tclust_algorithm.pdf</p>

<h3>Examples</h3>

<h3>Example 1</h3>

<p class="auto-style1">Impose the constraint that the ratio between largest and
smallest eigenvalue is not greater than 1.1</p>
  
<pre class="programlisting">    % Suppose v=3 and k=4 so the matrix containing the eigenvalues is 3-by-4
   % First column of matrix eigenvalues contains the eigenvalues of the first group
   % Second column of matrix eigenvalues contains the eigenvalues of the second group
   % Thrid column of matrix eigenvalues contains the eigenvalues of the third group
   % Fourth column of matrix eigenvalues contains the eigenvalues of the fourth group
   rng(10,'twister')
   eigenvalues=abs(10*randn(3,4));
   % niini is the vector containing the sizes of the 4 groups
   niini=[30;40;20;10];
   out=restreigen(eigenvalues,niini,1.1)
   disp('Input matrix of unrestricted eigenvalues')
   disp(eigenvalues)
   disp('Output matrix of restricted eigenvalues')
   disp(out)
   disp('Ratio between largest and smallest unrestricted eigenvalues')
   disp(max(max(eigenvalues))/min(min(eigenvalues)))
   disp('Ratio between largest and smallest restricted eigenvalues')
   disp(max(max(out))/min(min(out)))</pre>
<pre>Input matrix of unrestricted eigenvalues
    6.4581   11.1831   11.6942    7.3428
   14.6513    0.0504    5.8652    6.9930
    3.8523    2.5519    7.4491   20.0559</pre>
<pre>Output matrix of restricted eigenvalues
    6.6693    7.3362    7.3362    7.3362
    7.3362    6.6693    6.6693    6.9930
    6.6693    6.6693    7.3362    7.3362</pre>
<pre>Ratio between largest and smallest unrestricted eigenvalues
  397.8522</pre>
<pre>Ratio between largest and smallest restricted eigenvalues
    1.1000</pre>

<p> </p>

<h3>See Also</h3>

<p><tt><a href="tclust.html">tclust</a></tt> </p>


<p></p>

<table border="0" cellpadding="0" cellspacing="0" class="nav"
summary="Navigation aid" width="100%">
  <tbody>
    <tr valign="top">
      <td align="left" width="20"><a href="resindexplot.html"><img align="bottom"
        alt="fanplot" border="0" src="images_help/b_prev.gif"></a> </td>
      <td align="left">resindexplot.html</td>
      <td> </td>
      <td align="right">rlga.html</td>
      <td align="right" width="20"><a href="rlga.html"><img align="bottom"
        alt="FSMeda" border="0" src="images_help/b_next.gif"></a></td>
    </tr>
  </tbody>
</table>
<script type="text/javascript" language="javaScript">
document.write(barra);</script>
<!-- Last updated: Fri Jan 23 17:00:05 EST 2009-->
</body>
</html>
