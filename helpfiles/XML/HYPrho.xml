<?xml version="1.0" encoding="utf-8"?>
<HelpXML>
   <Title><!--This is simply the filename-->HYPrho</Title>
   <Purpose><!--This is the second line of the .m file-->HYPrho computes rho function  using hyperboloc tangent estimator</Purpose>
   <Description><!--Description section--></Description>
   <InpArgs><!--REQUIRED INPUT ARGUMENT SECTION-->
      <Item>
         <Name>u</Name>
         <ShortDesc>scaled residuals or Mahalanobis distances</ShortDesc>
         <TypeInd>Vector</TypeInd>
         <LongDesc>n x 1&#xD;
               vector containing residuals or Mahalanobis distances&#xD;
               for the n units of the sample</LongDesc>
         <Example> </Example>
         <DataType>single| double</DataType>
         <ReqArg>1</ReqArg>
         <Struct> </Struct>
      </Item>
      <Item>
         <Name>cktuning</Name>
         <ShortDesc>tuning parameters</ShortDesc>
         <TypeInd>Vector of length 2 or of length 5</TypeInd>
         <LongDesc>cktuning specifies the value of the tuning&#xD;
                constant c (scalar greater than 0 which controls the&#xD;
                robustness/efficiency of the estimator)&#xD;
                and the prefixed value k (sup of the&#xD;
                change-of-variance sensitivity) and the values of&#xD;
                parameters A, B and d.&#xD;
                cktuning(1) = c;&#xD;
                cktuning(2) = k = supCVC(psi,x) x \in R;&#xD;
                cktuning(3)=A;&#xD;
                cktuning(4)=B;&#xD;
                cktuning(5)=d;&#xD;
                Remark - if length(cktuning)==2 values of A, B and d will be&#xD;
                computed automatically</LongDesc>
         <Example> </Example>
         <DataType>single| double</DataType>
         <ReqArg>1</ReqArg>
         <Struct> </Struct>
      </Item>
   </InpArgs>
   <OptArgs><!--OPTIONAL (NAME/PAIRS) INPUT ARGUMENT SECTION--></OptArgs>
   <OutArgs><!--OUTPUT ARGUMENT SECTION-->
      <Item>
         <Name>rhoHYP</Name>
         <ShortDesc>n x 1 vector </ShortDesc>
         <TypeInd>Hyperbolic rho&#xD;
                associated to the residuals or Mahalanobis distances for&#xD;
                the n units of the sample.</TypeInd>
         <LongDesc> </LongDesc>
      </Item>
   </OutArgs>
   <MoreAbout><!--MORE ABOUT SECTION-->
 Hampel et al. (1981) have introduced a rho function which&#xD;
 minimizes the asymptotic variance of the regression M-estimate, subject&#xD;
 to a bound on the supremum of the Change of Variance Curve of the&#xD;
 estimate. This leads to the Hyperbolic Tangent $\rho$&#xD;
 function, which, for suitable constants $c$, $k$, $A$, $B$ and&#xD;
 $d$, is defined as&#xD;
 &#xD;
&#xD;
 \[&#xD;
  HYPrho(u) =&#xD;
  \left\{&#xD;
  \begin{array}{cc}&#xD;
   	 u^2/2 &amp;	        |u| \leq d, \\&#xD;
   d^2/2 -2 \frac{A}{B} \log  \left\{ \cosh \left[ 0.5 \sqrt{ \frac{(k - 1)  B^2}{A} } (c - |u|) \right] \right\} &amp; \\&#xD;
                          +2 \frac{A}{B}\log \left\{  \cosh \left[ 0.5\sqrt{\frac{(k - 1)  B^2}{A}}(c -d)\right] \right\} &amp;  \\		        	&#xD;
                &amp;                               d \leq |u| &amp;lt;  c, \\&#xD;
                 d^2/2 +2 \frac{A}{B} \log \left\{ \cosh \left[ 0.5 \sqrt{ \frac{(k - 1)  B^2}{A} }(c -d) \right] \right\}	 &amp;&#xD;
                                                        |u| \geq c. \\&#xD;
   \end{array}&#xD;
   \right.&#xD;
 \]&#xD;
 where $0 &amp;lt; d &amp;lt; c$ is such that&#xD;
 \[&#xD;
 d = \sqrt{[A(k-1)]}\tanh [\frac{1}{2}\sqrt{\frac{(k-1)B^2}{A}}(c - d)],&#xD;
 \]&#xD;
 $A$ and $B$ satisfy suitable conditions, and $k$ is related to the bound&#xD;
 in the Change of Variance Curve.&#xD;
&#xD;
 More precisely, it is necessary to have $0 &amp;lt; A &amp;lt; B &amp;lt; 2 *normcdf(c)-1- 2*c*normpdf(c) &amp;lt;1$&#xD;
&#xD;
</MoreAbout>
   <Acknowledgements><!--ACKNOWLEDGEMENTS SECTION--></Acknowledgements>
   <References><!--REFERENCES SECTION-->
      <Item>Hampel F.R., Rousseeuw P.J. and Ronchetti E. (1981),&#xD;
 The Change-of-Variance Curve and Optimal Redescending M-Estimators,&#xD;
 Journal of the American Statistical Association , Vol. 76, No. 375,&#xD;
 pp. 643-648 (HRR)</Item>
      <Item>Riani M., Cerioli A., Atkinson A.C., Perrotta D.  (2014). Monitoring&#xD;
 Robust Regression. Electronic Journal of Statistics, Vol. 8 pp.  646-677</Item>
   </References>
   <SeeAlso><!--SEE ALSO SECTION-->
      <Item>TBrho</Item>
      <Item>HArho</Item>
      <Item>OPTrho</Item>
   </SeeAlso>
   <Ex><!--EXAMPLES SECTION-->
      <Item>
         <Title>Plot of rho function for hyperbolic tangent estimator.</Title>
         <Desc> </Desc>
         <MATLABcode>
&#xD;
    % Plot of rho function for hyperbolic tangent estimator.&#xD;
    x=-8:0.001:8;&#xD;
    ctuning=6;&#xD;
    ktuning=4.5;&#xD;
    rhoHYP=HYPrho(x,[ctuning,ktuning]);&#xD;
    plot(x,rhoHYP)&#xD;
    xlabel('x','Interpreter','Latex')&#xD;
    ylabel(' Hyperbolic $\rho(x) $','Interpreter','Latex')&#xD;
&#xD;</MATLABcode>
         <Exec>0</Exec>
      </Item>
   </Ex>
   <ExtraEx><!--EXTRA EXAMPLES SECTION-->
      <Item>
         <Title>Parameters associated to a value of bdp=1/2.</Title>
         <Desc/>
         <MATLABcode>
    c=2.158325031399727&#xD;
    k=4;&#xD;
    A=0.000162707412432;&#xD;
    B=0.006991738279441   &#xD;
    d=0.016982948780061&#xD;
    x=-8:0.001:8;&#xD;
    rhoHYP=HYPrho(x,[c,k,A,B,d]);&#xD;
    plot(x,rhoHYP)&#xD;
    xlabel('x','Interpreter','Latex')&#xD;
    ylabel(' Hyperbolic $\rho(x) $','Interpreter','Latex')&#xD;
&#xD;</MATLABcode>
         <Exec>0</Exec>
      </Item>
   </ExtraEx>
</HelpXML>