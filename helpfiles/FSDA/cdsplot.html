<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<!--FScategory:Dynamic Statistical Visualization-->

<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>cdsplot:: Functions (Flexible Statistics Data Analysis Toolbox&trade;)</title>
<link href="docstyle.css" rel="stylesheet" type="text/css">
<meta content="refpage" name="chunktype">

<meta content="function:cdsplot" name="refentity">
<meta content="text/javascript" http-equiv="Content-Script-Type">
<meta content="fcn" name="toctype">

<script  type="text/javascript" language="javaScript" src="bottom.js"></script>

</head>


<body>



<a name="top_of_page"></a>
<p style="font-size: 1px;">&nbsp;</p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr>
		<td valign="baseline"><b>Flexible Statistics Data Analysis Toolbox&trade;</b></td>
		<td align="right" valign="baseline"><a href="cabc.html">
		<img align="bottom" alt="brushRES" border="0" src="images_help/b_prev.gif"></a>&nbsp;&nbsp;
		<a href="chkinputm.html">
		<img align="bottom" alt="clickableMultiLegend" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<a name="bq24of9-1"></a><a class="indexterm" name="zmw57dd0e69698"></a>
<h1 class="reftitle">cdsplot</h1>

<p class="purpose">Candlestick plot for robust model selection in linear regression	</p>
<h2>Syntax </h2>
<p class="synopsis"><tt>cdsplot(out)<br>cdsplot(out,<i><tt>param1</tt></i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)<br>
</tt></p>
<a name="bq24of9-2"></a>
<h2>Description</h2>
<p>A powerful graphical tool to perform model selection in regression is the generalized candlestick plot which
summarises the information on forward searches and model choice for
numerous models using a flexible level of trimming. The candlestick plot summarises, for each model, the information in the trajectory of the forward
plots of <em>C<sub>p</sub></em>(<em>m</em>). The starting point is the “candlestick” plot used to summarise
such quantities as the high, low and closing values of stocks. Google provides many
references. However, we need a generalization of this plot. Since we expect any
outliers to enter the search towards the end, the last few values of <em>C<sub>p</sub></em>(<em>m</em>) are of particular
interest, as is the comparison of these values with earlier average behaviour.</p>
<p>The vertical lines in the plot summarise the values of <em>C<sub>p</sub></em>(<em>m</em>) for each model in the
central part of the search. The definition of the candlesticks is:
<br>Lowest Value; minimum in the central part of the search;
<br>Highest Value; maximum in the central part of the search;
<br>Central Box; mean and median of the values in the central part of the search;
filled if mean smaller than median;
<br>Stars; the values in steps “central part” + 1 to n−1 if these lie outside the box;
<br>Unfilled Circle; the final value.
</p>
<p>Thus each point in the standard non-robust <em>C<sub>p</sub></em> plot is replaced by a
single vertical line and a series of extra symbols. The general shape of the 
candlestickplot is similar to that of the standard
<em>C<sub>p</sub></em> plot. For small values of <em>p</em> all models have large values of <em>C<sub>p</sub></em>(<em>m</em>) over the
last values of <em>m</em>. Conversely, for large <em>p</em> there are many models with small
values of <em>C<sub>p</sub></em>(<em>m</em>) over most of the range. What is striking is the decrease in
variability in the values of <em>C<sub>p</sub></em>(<em>m</em>) as <em>p</em> increases. When <em>p</em> is too small, the
values of <em>C<sub>p</sub></em> respond with extreme sensitivity to the addition of extra
observations.</p>
<p><tt>cdsplot(out)</tt> uses as input the output of function <tt>FSRms</tt>. 
</p>
<p><tt>y</tt> is a vector of length n containing the response values, while <tt>X</tt> is the <i>n</i>-by-<i>p-1</i> matrix  
which contains (in the columns) the values of <i>p-1</i> predictive terms</p>
<p><tt><a name="bq24of9-3"></a>cdsplot(out)</tt> needs as input the following information
</p>
<ul type="disc">
	<li><tt>out</tt> &minus; A structure of additional statistics with the following fields.
	<ul type="circle">
		<li>
		<p><tt>Score</tt> &minus; <tt>k</tt>-by-<tt>9</tt> matrix containing 
		statistics which are used to create the candles
              <br>1st col: max Cp values
              <br>2nd col: min Cp values
              <br>3rd col: averages Cp values
              <br>4nd col: median Cp values
              <br>5th col: x coordinates (or size of
              submodel)
              <br>6th col: number of explanatory variables of the submodel
              <br>7th col: y coordinate of final Cp
              <br>8th col: units entering the final step of the search
              <br>9th col: maximum Cp value during the search (This information is used to 
		position the labels on top of each
              model)</p>
		</li>
		<li>
		<p><tt>outl</tt> &minus; <tt>r</tt>-by-<tt>4</tt> 
		matrix containing information about 'influential
              units' or empty matrix
              Influential units in this context are defined as the units
              which enter the subset in the final part of the search and
              bring the value of the Cp below the minimum or
              above the maximum value of the central part of the search
              <br>1st col: x coordinates
              <br>2nd col: y coordinates
              <br>3rd col: step of entry into subset
              <br>4nd col: unit number
              <br>If matrix outl contains more columns they are ignored</p>
		</li>
		
		<li>
		<p><tt>siz</tt> &minus; vector of length 2 containing information about n (number of
              units of the sample and bigP, number of explanatory variables,
              including the constant, in the full model). This
              information is necessary to compute the envelopes </p>
		</li>

	</ul>
	
	
</ul>
<p></p>
<p><tt>cdsplot(out,<i><tt>param1</tt></i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)</tt> 
specifies one or more of the name/value pairs described in the following table.</p>
<table border="2" cellpadding="4" cellspacing="0" class="body">
	<colgroup>
		<col width="21%"><col width="79%">
	</colgroup>
	<thead>
		<tr valign="top">
			<th bgcolor="#B2B2B2">Parameter</th>
			<th bgcolor="#B2B2B2">Value</th>
		</tr>
	</thead>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;CandleWidth&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Scalar defining the width of the boxes associated with
              the central part of the search. The default width is 0.05;</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;Color&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Three elements color vector, [R G B], or a string specifying the
             color name. MATLAB supplies a default color if none is specified
             or if it is empty. The default color differs depending on the
             background color of the figure window. See COLORSPEC in the
             MATLAB Reference Guide for color names.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;quant&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>vector containing quantiles for the horizontal lines
              associated with the confidence bands of Cp
              The default is to plot 2.5% and
              97.5% envelopes. In other words the default is
              quant=[0.025;0.975]).</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 33px"><tt>&#39;LineWidth&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 33px">
		<p> Line Width (in points) for the vertical lines outside the 
              boxes of the candles. The default LineWidth is 0.5 points.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 53px"><tt>&#39;xlimx&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 53px">
		<p>Vector with two elements controlling minimum and maximum on the x axis. 
		Default value is &#39;&#39; (automatic scale).</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;ylimy&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p>Vector with two elements controlling minimum and maximum on the x axis. 
		Default value is &#39;&#39; (automatic scale)</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;label&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p>String vector of length k (number of rows of matrix stat)
		containing the labels of the selected models. Default value is ''
		that is no label is plotted on the screen.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;lablast&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p>Vector with two elements controlling minimum and maximum on the x axis. 
		Default value is &#39;&#39; (automatic scale)</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;laboutl&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p>scalar which specifies whether to add the labels of the
             'influential units'
             <br>if laboutl=1 the unit number is added close to its symbol.
             <br>if laboutl=2 the unit number together with the entry step is
                          added close to its symbol
            <br> else (default) no label is added</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;labbold&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p>cell array of strings which specifies the models which have
             to be highlighted (the linewidth of the vertical lines
             outside the boxes of the models specified in labbold is
             considerably increased). As default labbold=''.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;labenv&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p> If labelv=1 labels of the quantiles used to generate the
		horizontal lines associated with the envelopes are added,
		else if labelv=0 (default) no label is added.</p>
		</td>
	</tr> 
	<tr>
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;barend&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p>scalar which specifies whether to add small horizontal lines
             at the end of the vertical lines representing the whiskers.
             If <tt>barend</tt>=1 horizontal lines are added else (default) no
             additional line is drawn</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;cpbrush&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p>empty value or matrix
             If <tt>cpbrush</tt> is an empty value (default), no brushing is done.
             The activation of this option (cpbrush is a scalar) enables
             the user  to select a set of candles in the candlestick plot
             and to monitor the corresponding forward searches in a new
             plot. Remark: if cpbrush is not an empty value the user has
             to supply the matrix which in the first column contains the
             fwd search index and in the other <em>k</em> columns the values of Cp
             associated with the <em>k</em> models displayed in the candlestick
             plot</p>
		</td>
	</tr>
	</table>

<a name="bq9x7hn"></a><a name="bq5gf2y"></a>
<h3>&nbsp;</h3>
<h3>Examples</h3>

<h3>Example 1</h3>
<p>The candlestick plot for the full ozone data restricting attention to the 
interval smallp=4:5 can be produced as follows :</p>

<pre class="programlisting">
X=load('ozone_330_obs.txt');
y=log(X(:,9));
Time1=[(1:165)';(165:-1:1)'];
X=[Time1 X(:,1:8)];
labels={'Time','1','2','3','4','5','6','7','8'};
outms=FSRms(y,X,'labels',labels,'smallpint',4:5);
cdsplot(outms,'cpbrush',1,'laboutl',1)
</pre>

<p>The plot which comes out is as follows. Once the candle for model Time,3,7 is 
brushed</p>

<p>
<img alt="" src="images_help/img3C.gif">&nbsp;</p>
<p>the plot which shows the trajectory of Cp for the this model is automatically shown (see Figure 
below)</p>
<p><img alt="" src="images_help/img33.gif"></p>
<h3>Example 2</h3>
<p>The candlestick plot for the credit cards 
dataset can be produced from the following code (note that given data the 
dataset is large, 1000 x 10, some minutes are necessary to produce the graph)</p>

<pre class="programlisting">
X=load('credit_card.txt');
y=X(:,end);
X=X(:,1:end-1);
n=length(y); 
fin_step=round([n*0.1 n*0.02]);
outms=FSRms(y,X,'fin_step',fin_step,'plots',1);
</pre>
<p>The resulting plot is displayed in the figure below</p>
<p>
 <img alt="" src="images_help/img60.gif"></p>
<p>
 Figure above indicates clearly that there is no satisfactory model with <tt>smallp</tt> = 4, although 1 2 5 is the best of a bad bunch.
</p>
<p>
 Clearly it is better to restrict our attention to the interval <tt>smallp</tt>=4:8 
 using the following code:</p>

<pre class="programlisting">
cdsplot(outms,'xlimx',[3.5 8.5],'ylimy',[0 35])
</pre>
<p>
 <img alt="" src="images_help/img6C1.gif">&nbsp;</p><p>
 We start by looking at models for <tt>smallp</tt> = 6. The value of <em>C<sub>p</sub></em>(<em>m</em>) for model 1 2 3 4 5
seems unaffected by exclusion of the last 20 observations. 
However, that for 1 2 4 5 6,
which was the indicated model at the end of the search, increases to lie mostly above
the bound when the observations are excluded. On the contrary, under the same conditions the values for 1 2 3 5 8 decrease, for it to become one of the two best models.
If we now turn to <tt>smallp</tt> = 7, we see that the union of these models, that is 1 2 3 4 5 8,
has a stable small value of <em>C<sub>p</sub></em>(<em>m</em>).
The conclusions for <tt>smallp</tt> = 5 are straightforward: 1 2 3 5 is the only model which
lies within the bounds for the central part of the search. This is a special case of
the two models for <tt>smallp</tt> = 6 suggested above. 
</p>
<p>In the following code we highlight in bold face models {'1,2,3,5,' '1,2,3,4,5,' '1,2,3,5,8,' '1,2,3,4,5,8,'}</p>

<pre class="programlisting">
selmod={'1,2,3,5,' '1,2,3,4,5,' '1,2,3,5,8,' '1,2,3,4,5,8,'};
cdsplot(outms,'xlimx',[3.5 8.5],'ylimy',[0 35],'labbold',selmod,'CandleWidth',0.03)
</pre>
<p>
<img alt="" src="images_help/img73.gif"></p>
<p>
&nbsp;</p>

<a name="bq24of9-11"></a>
<h2>See Also</h2>
<p><a href="fsrms.html"><tt>FSRms</tt></a>, <a href="fsrcp.html"><tt>FSRcp</tt></a>,
</p>

<p>
<p></p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr valign="top">
		<td align="left" width="20"><a href="cabc.html">
		<img align="bottom" alt="" border="0" src="images_help/b_prev.gif"></a>
		</td>
		<td align="left">cabc.html</td>
		<td>&nbsp;</td>
		<td align="right">chkinputm.html</td>
		<td align="right" width="20"><a href="chkinputm.html">
		<img align="bottom" alt="FSR" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<script type ="text/javascript" language="javaScript">
document.write(barra);
</script>
<!-- Last updated: Fri Jan 23 17:00:05 EST 2009-->




</body>

</html>
