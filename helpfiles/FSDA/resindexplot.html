<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<!--FScategory:Dynamic Statistical Visualization-->

<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>resindexplot :: Functions (Flexible Statistics Data Analysis Toolbox&trade;)
</title>
<link href="docstyle.css" rel="stylesheet" type="text/css">
<meta content="refpage" name="chunktype">
<script  type="text/javascript" language="javaScript" src="bottom.js"></script>

</head>


<body>

<a name="top_of_page"></a>
<p style="font-size: 1px;">&nbsp;</p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr>
		<td valign="baseline"><b>Flexible Statistics Data Analysis Toolbox&trade;</b></td>
		<td align="right" valign="baseline"><a href="resfwdplot.html">
		<img align="bottom" alt="resfwdplot" border="0" src="images_help/b_prev.gif"></a>&nbsp;&nbsp;
		<a href="restreigen.html">
		<img align="bottom" alt="resfwdplot" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<a name="bq24of9-1"></a><a class="indexterm" name="zmw57dd0e69698"></a>
<h1 class="reftitle">resindexplot</h1>
<!-- SYNCHTO: bq_w_hm.html -->
<p class="purpose">Plots the residuals against index number. </p>
<h2>Syntax </h2>
<p class="synopsis"><tt>resindexplot(residuals)<br>resindexplot(residuals,<i>param1</i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)<br>
</tt></p>

<h2>Description</h2>
<p><tt>resindexplot(residuals)</tt> plots the residuals against index number. The 
input argument of this function may be conveniently produced by function <tt>LXS</tt>,
<tt>Sreg</tt> or <tt>MMreg</tt>.</p>



<table border="1" cellpadding="5" cellspacing="0" class="note" summary="Note">
	<tr width="90%">
		<td>
		<p><b>Note</b>&nbsp;&nbsp; 
		It is worthwhile to remark the difference between function <tt>resfwdplot</tt> from function 
		<tt>resindexplot</tt>. The former shows a 'movie' 
		of the residuals, i.e. it enables to show how the residuals for each unit evolve 
		as the subset size increases. The latter shows the static plot of the residuals 
		against the index number or fitted value or against any other statistic.</p>
		<p><b>Remark</b>&nbsp;&nbsp; Only one <tt>resindexplot</tt> figure at a time can 
		be left open.</td>
	</tr>
</table>
<p></p>

<p><tt>resindexplot(residuals)</tt> needs as input a 
vector of residuals or a structure containing fields residuals, y and X. </p>



<p><tt>resindexplot(residuals,<i>param1</i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)</tt> 
specifies one or more of the name/value pairs described in the following table.</p>
<table border="2" cellpadding="4" cellspacing="0" class="body">
	<colgroup>
		<col width="21%"><col width="79%">
	</colgroup>
	<thead>
		<tr valign="top">
			<th bgcolor="#B2B2B2">Parameter</th>
			<th bgcolor="#B2B2B2">Value</th>
		</tr>
	</thead>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;x&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>The vector to be plotted on the x-axis. As default the sequence 
		<tt>1:length(residuals)</tt> will be used.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;h&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>the axis handle of a figure where to send the resindexplot.
                  This can be used to host the resindexplot in a subplot of a
                  complex figure formed by different panels (e.g. a panel
                  with residuals from a classical ols estimator and another
                  with residuals from a robust regression: see example
                  below).</p>
		</td>
	</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;labx&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>A label for the x-axis (default: <tt>&#39;Subset size m&#39;</tt>)</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;laby&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>A label for the y-axis (default: <tt>&#39;&#39;</tt>).</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;titl&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>A label containing the title of the plot. Default value is
		<tt>&#39;Index plot of residuals&#39;</tt></p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;numlab&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Number of points to be identified in plots.
		</p>
		<p>If <tt>numlab</tt> is equal a cell 
		containing scalar <tt>k</tt>, the units with the <tt>k</tt> largest residuals are labeled 
		in the plots. If <tt>numlab</tt> is a vector, the units inside the vector are 
		labeled in the plot. For no labeling leave it empty.</p>
		<p>The default value of <tt>numlab</tt> is {5} that is units 
		with the 5 largest residuals are labelled. </p>
		</td>
	</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;conflev&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Confidence interval for the horizontal bands. Remark: confidence interval 
		is based on the chi^2 distribution. 
		It can be a vector of different confidence level values,
        e.g. [0.95,0.99].</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;FontSize&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>Scalar which controls the font size of the labels of the axes. Default 
		value is 12.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;SizeAxesNum&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>Scalar which controls the size of the numbers of the axes. Default value 
		is 10.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;xlimx&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p>Vector with two elements which controls minimum and maximum value of 
		the x axis. Default is <tt>&#39; &#39;</tt>, automatic scale.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;ylimy&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p>Vector with two elements which controls minimum and maximum value of 
		the y axis. Default is <tt>&#39; &#39;</tt>, automatic scale.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;lwdenv&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>Scalar which controls the width of the lines associated with the envelopes. 
		Default is <tt>lwdenv=1</tt></p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;MarkerSize&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p>A scalar specifying the size of the marker in points.
                   The default value for MarkerSize is 6 points (1 point = 1/72 inch).</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;MarkerFaceColor&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>The fill color for markers that are closed shapes
                   (circle, square, diamond, pentagram, hexagram, and the
                   four triangles).</p>
		</td>
	</tr>
	
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;databrush&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Empty value scalar or structure. If databrush=&#39;&#39; (default) brushing 
		is not enabled else if it is a scalar it is possible to brush 
		the points with the mouse using all default options. The core of this option is <tt>selectdataFS</tt>, a function used by 
		all graphic tools of the FSDA toolbox. A separate common page details all
		options of structure
		<a href="databrushoption.html"><tt>databrush</tt></a>. </p>
		</td>
	</tr>

</table>
<p></p>

<a name="bq9x7hn"></a><a name="bq5gf2y"></a>
<h3>Examples</h3>
<h3>Example 1</h3>
<p>Plot of the robust residuals for the stack loss data. 
Note that with a mouse click on the legends text it is possible
to show/hide the corresponding confidence bands in the plot
(<tt>resindexplot</tt> makes use of <a href="clickablemultilegend.html"> <tt>ClickableMultiLegend</tt>)</a>. </p>

<PRE>
load('stack_loss.txt');

y=stack_loss(:,4);
X=stack_loss(:,1:3);

[out]=LXS(y,X,'nsamp',0,'rew',1,'lms',0);

resindexplot(out.residuals,'labx','Index number',...
			'laby','Robust LTS reweighted residuals',...
			'conflev',[0.2,0.5,0.99]);
</PRE>


<img alt="" height="420" src="plots/residualplot.jpg" width="561"><a name="bq24of9-11"></a>

<h3>Example 2</h3>
<p></p>
In this second example we introduce a set of contaminated data
as follows
<pre class="programlisting">
n=100;
p=10;
state=1;
randn('state', state);
X=randn(n,p);
y=randn(n,1);
% Level shift to the first 30 units
y(1:30)=y(1:30)+5;
</pre>
The application of the traditional robust methods (LMS and LTS) of outlier detection gives the following results.
<pre class="programlisting">
% Define number of subsamples
nsamp=10000;
% Define confidence level
conflev=[0.99 1-0.01/100];
% Leave blank the title of the plots
titl='';

% LMS with no rewighting
[outLMS]=LXS(y,X,&#39;nsamp&#39;,nsamp,&#39;conflev&#39;,conflev(1));
h1=subplot(2,2,1);
laby=&#39;Scaled LMS residuals&#39;;
resindexplot(outLMS.residuals,&#39;h&#39;,h1,&#39;title&#39;,titl,&#39;laby&#39;,laby,&#39;numlab&#39;,&#39;&#39;,&#39;conflev&#39;,conflev)

% LTS with no rewighting
h2=subplot(2,2,2);
[outLTS]=LXS(y,X,&#39;nsamp&#39;,nsamp,&#39;conflev&#39;,conflev(1),&#39;lms&#39;,0);
laby=&#39;Scaled LTS residuals&#39;;
resindexplot(outLTS.residuals,&#39;h&#39;,h2,&#39;title&#39;,titl,&#39;laby&#39;,laby,&#39;numlab&#39;,&#39;&#39;,&#39;conflev&#39;,conflev);

% LMS with reweighting
[outLMSr]=LXS(y,X,&#39;nsamp&#39;,nsamp,&#39;conflev&#39;,conflev(1),&#39;rew&#39;,1);
h3=subplot(2,2,3);
laby=&#39;Scaled reweighted LMS residuals&#39;;
resindexplot(outLMSr.residuals,&#39;h&#39;,h3,&#39;title&#39;,titl,&#39;laby&#39;,laby,&#39;numlab&#39;,&#39;&#39;,&#39;conflev&#39;,conflev)

% LTS with reweighting
[outLTSr]=LXS(y,X,&#39;nsamp&#39;,nsamp,&#39;conflev&#39;,conflev(1),&#39;rew&#39;,1,&#39;lms&#39;,0);
h4=subplot(2,2,4);
laby=&#39;Scaled reweighted LTS residuals&#39;;
resindexplot(outLTSr.residuals,&#39;h&#39;,h4,&#39;title&#39;,titl,&#39;laby&#39;,laby,&#39;numlab&#39;,&#39;&#39;,&#39;conflev&#39;,conflev);
</pre>
<p>Given that in this case the number of subsamples is extremely large we run 
the procedure 3 times. In the three figures which follow it is possible to 
notice that the proposed solution varies considerably according to the local 
minimum which is found. However, LMS if we consider a Bonferroni confidence 
level never detects outliers. On the other hand the number of units declared as 
outliers in the LTS context varies considerably.</p>

<img src="plots/residualplot1.gif" height="606" width="872"><p>&nbsp;</p>
&nbsp;<img src="plots/residualplot2.gif" height="598" width="873"><p>&nbsp;</p>
&nbsp;<img src="plots/residualplot3.gif">

<p></p><p>
You can compare the information which comes from the previous plots
with the output with that which comes out from monitoring
the minimum deletion residual 
<a href="mdrplot.html">mdrplot</a>.
</p>
<h3>Example 3</h3>
<p>In this third example we use the Hospital dataset. For a description 
and the analysis of these data using the minimum deletion residual, see page
<a href="mdrplot.html">mdrplot</a></p>.
<p>As before we use 1% individual and simultaneous confidence bands</p>

<pre class="programlisting">
load('hospital.txt');
y1=hospital(:,5);
X=hospital(:,1:4);
% Define nominal confidence level
conflev=[0.99 1-0.01/length(y1)];
% Define number of subsets
nsamp=10000;
% Define the main title of the plots
titl='';

% LMS with no rewighting
[outLMS]=LXS(y1,X,'nsamp',nsamp,'conflev',conflev(1));
h1=subplot(2,2,1);
laby='Scaled LMS residuals';
resindexplot(outLMS.residuals,'h',h1,'title',titl,'laby',laby,'numlab','','conflev',conflev,'xlimx',[0 110])

% LTS with no rewighting
h2=subplot(2,2,2);
[outLTS]=LXS(y1,X,'nsamp',nsamp,'conflev',conflev(1),'lms',0);
laby='Scaled LTS residuals';
resindexplot(outLTS.residuals,'h',h2,'title',titl,'laby',laby,'numlab','','conflev',conflev,'xlimx',[0 110]);

% LMS with reweighting
[outLMSr]=LXS(y1,X,'nsamp',nsamp,'conflev',conflev(1),'rew',1);
h3=subplot(2,2,3);
laby='Scaled reweighted LMS residuals';
resindexplot(outLMSr.residuals,'h',h3,'title',titl,'laby',laby,'numlab','','conflev',conflev,'xlimx',[0 110])

% LTS with reweighting
[outLTSr]=LXS(y1,X,'nsamp',nsamp,'conflev',conflev(1),'rew',1,'lms',0);
h4=subplot(2,2,4);
laby='Scaled reweighted LTS residuals';
resindexplot(outLTSr.residuals,'h',h4,'title',titl,'laby',laby,'numlab','','conflev',conflev,'xlimx',[0 110]);
</pre>
<p>
<img src="plots/residhospital.gif">
</p>
<h3>See Also</h3>
<p><a href="resfwdplot.html"><tt>resfwdplot</tt></a> </p>
<p>
</p>
<p></p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr valign="top">
		<td align="left" width="20"><a href="resfwdplot.html">
		<img align="bottom" alt="rescale" border="0" src="images_help/b_prev.gif"></a>
		</td>
		<td align="left">resfwdplot.html</td>
		<td>&nbsp;</td>
		<td align="right">restreigen.html</td>
		<td align="right" width="20"><a href="restreigen.html">
		<img align="bottom" alt="resfwdplot" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<script type ="text/javascript" language="javaScript">
document.write(barra);
</script>

</body>

</html>
