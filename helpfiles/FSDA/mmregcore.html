<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<!--FScategory:Robust Regression Analysis and transformations-->


<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>MMregcore :: Functions (Flexible Statistics Data Analysis Toolbox&trade;â„¢)</title>
<link href="docstyle.css" rel="stylesheet" type="text/css">
<meta content="refpage" name="chunktype">


<script  type="text/javascript" language="javaScript" src="bottom.js"></script>

</head>


<body>

<a name="top_of_page"></a>
<p style="font-size: 1px;">&nbsp;</p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr>
		<td valign="baseline"><b>Flexible Statistics Data Analysis Toolbox&trade;</b></td>
		<td align="right" valign="baseline"><a href="mmreg.html">
		<img align="bottom" alt="levfwdplot
" border="0" src="images_help/b_prev.gif"></a>&nbsp;&nbsp;
		<a href="mscale.html">
		<img align="bottom" alt="minplot" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<a name="bq24of9-1"></a><a class="indexterm" name="zmw57dd0e69698"></a>
<h1 class="reftitle">MMregcore</h1>
<p class="purpose">MM estimators in linear regression (using  
starting values provided by the user)</p>
<h2>Syntax </h2>
<p class="synopsis"><tt>[out] = MMregcore(y,X,b0,auxscale)<br>[out] = MMregcore(y,X,,b0,auxscale,<i><tt>param1</tt></i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)<br>
</tt></p>

<h2>Description</h2>
<p><tt>[out] = MMregcore(y,X,b0,auxscale)</tt> computes MM estimators in linear regression 
using starting values specified by the user. The default nominal efficiency which 
is used is 95%.</p>
<p><tt>y</tt> is a vector of length n containing the response values, <tt>
X</tt> is the <i>n</i>-by-<i>p</i>-1 matrix which contains (in the columns) the values 
of <i>p</i>-1 predictive terms, b0 is p x 1 vector containing initial estimate of beta (generally an S
              estimate with high breakdown point (eg .5), auxscale is a scalar containing 
the estimate of the scale (generally an S
              estimate with high breakdown point (eg .5) .</p>
<p><tt><a name="bq24of9-3"></a>[out] = MMregcore(y,X,b0,auxscale)</tt> returns the following information
</p>
<ul type="disc">
	<li><tt>out</tt> &minus; A structure of additional statistics with the following fields.
	<ul type="circle">
		
		<li>
		<p><tt>beta</tt> &minus; <i>p</i>-by-1 vector of beta MM coefficient estimates, including 
		the intercept when input options <tt>intercept</tt> is equal to 1 or it 
		is missing. <tt>out.beta=[intercept slopes]</tt>.</p>
		</li>
		<li>
		<p><tt>residuals</tt> &minus; <i>n</i>-by-1 vector containing the scaled residuals from 
		the MM loop.      out.residuals=(y-X*out.beta)/out.auxscale</p>
		</li>
		<li>
		<p><tt>weights</tt> &minus; <i>n</i>-by-1 Boolean vector containing weights for each observations. 
		The elements of this vector lie in the interval 0 or 1. Elements close 
		to 0 values are associated with the outliers. </p>
		</li>
		
		<li>
		<p><tt>Sbeta</tt> &minus; <i>p</i>-by-1 vector of beta S coefficient estimates, including 
		the intercept when input options <tt>intercept</tt> is equal to 1 or it 
		is missing. </p>
		</li>

		
		<li>
		<p><tt>outliers</tt> &minus; this output is present only if <tt>conflev</tt> has been specified. 
		It is a vector containing the list of the units declared as outliers using 
		confidence level specified in input scalar <tt>conflev</tt></p>
		</li>
		<li>
		<p><tt>conflev</tt> &minus; confidence level which is used to declare outliers. 
		Remark: scalar out.conflev will be used to draw the horizontal lines (confidence 
		bands) in the plots</p>
		</li>

		<li>
		<p><tt>class</tt> &minus; string containing <tt>&#39;MM&#39;</tt> </p>
		</li>
		<li>
			<p><tt>y</tt> &minus; Response vector y. The field is present if option yxsave is set to 1. </p>
		</li>
 
		<li>
			<p><tt>X</tt> &minus; Data matrix X. The field is present if option yxsave is set to 1. </p>
		</li>
	</ul>
	<ul>
		<table border="1" cellpadding="5" cellspacing="0" class="note" summary="Note">
			<tr width="90%">
				<td>
				<p><b>Note</b>&nbsp;&nbsp; MMregcore automatically includes a 
				constant term in all models. Do not enter a column of 1s directly 
				into <tt>X</tt>.</p>
				</td>
			</tr>
	</table>
	</ul>
	</li>
</ul>
<p></p>
<p><tt>[out] = MMregcore(y,X,<i><tt>param1</tt></i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)</tt> 
specifies one or more of the name/value pairs described in the following table.</p>
<table border="2" cellpadding="4" cellspacing="0" class="body">
	<colgroup>
		<col width="21%"><col width="79%">
	</colgroup>
	<thead>
		<tr valign="top">
			<th bgcolor="#B2B2B2">Parameter</th>
			<th bgcolor="#B2B2B2">Value</th>
		</tr>
	</thead>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;intercept&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>If 1, a model with constant term will be fitted (default) else no constant 
		term will be included.  </p>
		</td>
	</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;eff&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>scalar defining nominal efficiency (i.e. a number between<br>0.5 and 
		0.99). The default value is 0.95</p></td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;effshape&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		dummy scalar. If effshape=1 efficiency refers to shape efficiency
                else (default) efficiency refers to location.</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;refsteps&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>scalar defining maximum number of iterations in the MM
                loop. 
                Default value is 100</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;reftol&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>scalar controlling tolerance in the MM loop.
                Default value is 1e-7</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;conflev&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Scalar between 0 and 1 containing confidence level which is 
              used to declare units as outliers. 
              Usually <tt>conflev=[0.95, 0.975, 0.99]</tt> (individual alpha) 
              or <tt>[1-0.05/n, 1-0.025/n, 1-0.01/n]</tt> (simultaneous alpha).
              Default value is 0.975</p>
		</td>
	</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;plots&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>Scalar. If <tt>plots=1</tt> a plot with robust residuals is produced 
		else (default) no plot is produced.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;nocheck&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>Scalar. If <tt>nocheck=1</tt> no check is performed on matrix y and 
		matrix X. Notice that y and X are left unchanged. In other words the additional 
		column of ones for the intercept is not added. As default <tt>nocheck=0</tt>. The controls
              on <tt>h</tt>, <tt>alpha</tt> and <tt>nsamp</tt> still remain.</p>
		</td>
	</tr>
    <tr>
        <td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;yxsave&#39;</tt></td>
        <td bgcolor="#F2F2F2" style="height: 32px">
    <p>
       scalar that is set to 1 to request that the data <tt>y</tt> and <tt>X</tt>
       are saved into the output structure <tt>out</tt>.  
       Default is 0, i.e. no saving is done.
      </p>
    </td>
    </tr>

	</table>
<p></p>
<a name="bq9x7hn"></a><a name="bq5gf2y"></a>
<h3>Examples</h3>
<p>
In these examples we use the same data which have been used 
in the help of function <a href="fsr.html">FSR</a> and <a href="fsr.html">LXS</a> in order to compare the output of different procedures.
</p>


<pre class="programlisting">
state=543;
randn('state', state);
n=100;
X=randn(n,3);
bet=[3;4;5];
y=3*randn(n,1)+X*bet;
y(1:20)=y(1:20)+13;
</pre>


<p>For outlier detection we consider both the nominal individual 1% significance 
level and the simultaneous Bonferroni confidence level.&nbsp; </p>

<pre class="programlisting">
% Define nominal confidence level
conflev=[0.99,1-0.01/length(y)];
% Define number of subsets 
nsamp=3000;
% Define the main title of the plots
titl='';

% S  estimators 
[outS]=Sreg(y,X,'nsamp',nsamp,'conflev',conflev(1));
eff=0.95;
outMM=MMregcore(y,X,outS.beta,outS.scale,'eff',eff)

titl=['Nominal efficiency=' num2str(eff)];
laby='Scaled MM residuals&#39;; 
resindexplot(outMM.residuals,'title',titl,'laby',laby,'numlab','','conflev',conflev)
</pre>
<p><img alt="" src="images_help/img25.gif"></p>
<br>

<p>The purpose of the code below is to analyze how the residuals change 
if we use a different level of nominal efficiency.</p>
<pre class="programlisting">
eff=0.99;
outMM=MMregcore(y,X,outS.beta,outS.scale,'eff',eff)

laby='Scaled MM residuals'; 
h1=subplot(2,1,1);
titl=['Nominal efficiency=' num2str(eff)];
resindexplot(outMM.residuals,'h',h1,'title',titl,'laby',laby,'numlab','','conflev',conflev)


eff=0.8;
outMM=MMregcore(y,X,outS.beta,outS.scale,'eff',eff)
laby='Scaled MM residuals&#39;; 
h2=subplot(2,1,2);
titl=['Nominal efficiency=' num2str(eff)];
resindexplot(outMM.residuals,'h',h2,'title',titl,'laby',laby,'numlab','','conflev',conflev)
</pre>
<br>

<p><img alt="" src="images_help/img51.gif"></p>
<p>&nbsp;</p>
<h3>See Also</h3>

<p><a href="mmreg.html"><tt>MMreg</tt></a>, <a href="smult.html"><tt>Smult</tt></a>,
<a href="mmmult.html"><tt>MMmult</tt></a></p>
 
 
 
<p></p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr valign="top">
		<td align="left" width="20"><a href="mmreg.html">
		<img align="bottom" alt="levfwdplot
" border="0" src="images_help/b_prev.gif" style="height: 17px"></a>
		</td>
		<td align="left">mmreg.html</td>
		<td>&nbsp;</td>
		<td align="right">mscale.html</td>
		<td align="right" width="20"><a href="mscale.html">
		<img align="bottom" alt="malfwdplot" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<script type ="text/javascript" language="javaScript">
document.write(barra);
</script>
<!-- Last updated: Fri Jan 23 17:00:05 EST 2009-->

</body>

</html>
