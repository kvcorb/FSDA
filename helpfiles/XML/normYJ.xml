<?xml version="1.0" encoding="utf-8"?>
<HelpXML>
   <Title><!--This is simply the filename-->normYJ</Title>
   <Purpose><!--This is the second line of the .m file-->normYJ computes (normalized) Yeo-Johnson transformation</Purpose>
   <Description><!--Description section--></Description>
   <InpArgs><!--REQUIRED INPUT ARGUMENT SECTION-->
      <Item>
         <Name>Y</Name>
         <ShortDesc>Input data</ShortDesc>
         <TypeInd>Matrix</TypeInd>
         <LongDesc>n x v data matrix; n observations and v variables. Rows of&#xD;
               Y represent observations, and columns represent variables.&#xD;
               Missing values (NaN's) and infinite values (Inf's) are&#xD;
               allowed, since observations (rows) with missing or infinite&#xD;
               values will automatically be excluded from the&#xD;
               computations.&#xD;
                </LongDesc>
         <Example> </Example>
         <DataType>single|double</DataType>
         <ReqArg>1</ReqArg>
         <Struct> </Struct>
      </Item>
      <Item>
         <Name>ColtoTra</Name>
         <ShortDesc>Variable to transform</ShortDesc>
         <TypeInd>Vector</TypeInd>
         <LongDesc>k x 1 integer vector&#xD;
               specifying the variables which must be&#xD;
               transformed. If it is missing and length(la)=v all&#xD;
               variables are transformed&#xD;
                </LongDesc>
         <Example> </Example>
         <DataType>single|double</DataType>
         <ReqArg>1</ReqArg>
         <Struct> </Struct>
      </Item>
      <Item>
         <Name>la</Name>
         <ShortDesc>transformation parameters</ShortDesc>
         <TypeInd>Vector</TypeInd>
         <LongDesc>k x 1 vector containing set of transformation&#xD;
               parameters for the k ColtoTra.&#xD;
                </LongDesc>
         <Example> </Example>
         <DataType>single|double</DataType>
         <ReqArg>1</ReqArg>
         <Struct> </Struct>
      </Item>
      <Item>
         <Name>Jacobian</Name>
         <ShortDesc>Requested Jacobian of transformed values</ShortDesc>
         <TypeInd>true (default) or&#xD;
               false</TypeInd>
         <LongDesc>If true (default) the transformation is normalized&#xD;
               to have Jacobian equal to 1</LongDesc>
         <Example> </Example>
         <DataType> </DataType>
         <ReqArg>0</ReqArg>
         <Struct> </Struct>
      </Item>
   </InpArgs>
   <OptArgs><!--OPTIONAL (NAME/PAIRS) INPUT ARGUMENT SECTION--></OptArgs>
   <OutArgs><!--OUTPUT ARGUMENT SECTION-->
      <Item>
         <Name>Ytra</Name>
         <ShortDesc> Matrix</ShortDesc>
         <TypeInd>transformed data matrix.</TypeInd>
         <LongDesc> n x v data matrix containing&#xD;
               transformed observations&#xD;
             The Yeo-Johnson transformation is the Box-Cox transformation&#xD;
             of y+1 for nonnegative values, and of |y|+1 with parameter&#xD;
             2-lambda for y negative.</LongDesc>
      </Item>
   </OutArgs>
   <MoreAbout><!--MORE ABOUT SECTION--></MoreAbout>
   <Acknowledgements><!--ACKNOWLEDGEMENTS SECTION--></Acknowledgements>
   <References><!--REFERENCES SECTION-->
      <Item>Yeo, I.-K. and Johnson, R. (2000) A new family of power&#xD;
 transformations to improve normality or symmetry. Biometrika, 87,&#xD;
 954-959.</Item>
   </References>
   <SeeAlso><!--SEE ALSO SECTION-->
      <Item>normBoxCox</Item>
   </SeeAlso>
   <Ex><!--EXAMPLES SECTION-->
      <Item>
         <Title> </Title>
         <Desc> </Desc>
         <MATLABcode>
    y=(-3:3)';&#xD;
    lambda=0&#xD;
    y1=normYJ(y,1,lambda)&#xD;
    plot(y,y1)&#xD;
    xlabel('Original values')&#xD;
    ylabel('Transformed values')&#xD;
&#xD;</MATLABcode>
         <Exec>0</Exec>
      </Item>
      <Item>
         <Title> </Title>
         <Desc> </Desc>
         <MATLABcode>
    close all&#xD;
    y=(-2:0.1:2)';&#xD;
    n=length(y);&#xD;
    la=-1:1:3;&#xD;
    nla=length(la);&#xD;
    YtraYJ=zeros(n,nla);&#xD;
    YtraBC=nan(n,nla);&#xD;
    posy=y&amp;gt;0;&#xD;
    for j=1:nla&#xD;
      YtraYJ(:,j)=normYJ(y,1,la(j),false);&#xD;
&#xD;
      YtraBC(posy,j)=normBoxCox(y(posy),1,la(j),false);&#xD;
    end&#xD;
    subplot(1,2,1)&#xD;
    plot(y,YtraYJ)&#xD;
    for j=1:nla&#xD;
        text(y(1), YtraYJ(1,j),['\lambda=' num2str(la(j))])&#xD;
    end&#xD;
&#xD;
    xlabel('Original values')&#xD;
    ylabel('Transformed values')&#xD;
    title('Yeo-Johnson transformation')&#xD;
&#xD;
    subplot(1,2,2)&#xD;
    plot(y,YtraBC)&#xD;
    xlim([y(1) y(end)])&#xD;
    for j=1:nla&#xD;
        text(y(16), YtraBC(22,j),['\lambda=' num2str(la(j))])&#xD;
    end&#xD;
    xlabel('Original values')&#xD;
    ylabel('Transformed values')&#xD;
    title('Box-Cox transformation')&#xD;</MATLABcode>
         <Exec>0</Exec>
      </Item>
   </Ex>
   <ExtraEx><!--EXTRA EXAMPLES SECTION-->
      <Item>
         <Title>Mussels data.</Title>
         <Desc/>
         <MATLABcode>
    load('mussels.mat');&#xD;
    Y=mussels.data;&#xD;
    la=[0.5 0 0.5 0 0];&#xD;
    % Transform all columns of matrix Y according to the values of la&#xD;
    Y=normYJ(Y,[],la);&#xD;</MATLABcode>
         <Exec>0</Exec>
      </Item>
   </ExtraEx>
</HelpXML>