<html>
<head>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <title>tclust :: Functions (Flexible Statistics Data Analysis
  Toolbox™)</title>
  <link href="docstyle.css" rel="stylesheet" type="text/css">
  <meta content="refpage" name="chunktype">
  <meta content="function:tclust" name="refentity">
  <meta content="text/javascript" http-equiv="Content-Script-Type">
  <meta content="fcn" name="toctype">
  <script type="text/javascript" language="javaScript" src="bottom.js">
 </script>
  <style type="text/css">
 .auto-style1 {
        background-color: #FFFFFF;
}
 .zptmcm7m-{ font-weight: bold; font-style: italic;}
 .zptmcm7m-{ font-weight: bold; font-style: italic;}
 .zptmcm7m-{ font-weight: bold; font-style: italic;}
 .zptmcm7t-x-x-74{ font-weight: bold; font-style: italic;}
 .zptmcm7t-x-x-74{font-size:74%; font-weight: bold; font-style: italic;}
 .zptmcm7m-x-x-74{ font-weight: bold; font-style: italic;}
 .zptmcm7m-x-x-74{ font-weight: bold; font-style: italic;}
 .zptmcm7m-x-x-74{font-size:74%; font-weight: bold; font-style: italic;}
 .zptmcm7v-{ font-weight: bold; font-style: italic;}
 .zptmcm7t-{ font-weight: bold; font-style: italic;}
 .zptmcm7t-{ font-weight: bold; font-style: italic;}
 .zptmcm7y-{ font-weight: bold; font-style: italic;}
 .zptmcm7y-{ font-weight: bold; font-style: italic;}
td center { margin-top:0em; margin-bottom:0em; }
center { margin-top:1em; margin-bottom:1em; }
 .zptmcm7y-x-x-74{ font-weight: bold; font-style: italic;}
 .zptmcm7y-x-x-74{font-size:74%; font-weight: bold; font-style: italic;}
  .auto-style2 {
          text-indent: 0em;
  }
  </style>
</head>

<body>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<!--FScategory:Clustering-->
<a name="top_of_page"></a> 

<p style="font-size: 1px;"> </p>

<table border="0" cellpadding="0" cellspacing="0" class="nav"
summary="Navigation aid" width="100%">
  <tbody>
    <tr>
      <td valign="baseline"><b>Flexible Statistics Data Analysis
      Toolbox™</b></td>
      <td align="right" valign="baseline"><a href="tclustreg.html"><img
        align="bottom" alt="fanplot" border="0"
        src="images_help/b_prev.gif"></a>   <a href="triu2vec.html"><img
        align="bottom" alt="FSMeda" border="0"
      src="images_help/b_next.gif"></a></td>
    </tr>
  </tbody>
</table>

<h1 class="reftitle">tkmeans</h1>

<p class="purpose">tkmeans computes trimmed k-means </p>

<h2>Syntax </h2>

<p class="synopsis"><tt>[out] = tclust(Y,k,alpha)<br>
[out] = tclust(Y,k,alpha,param1,val1,param2,val2,...) </tt></p>
<a name="f4811966"></a> 

<h2>Description </h2>

<p> </p>

<p><tt>tkmeans</tt> partitions the points in the n-by-v data matrix Y into k
clusters. This partition minimizes the trimmed sum, over all clusters, of the
within-cluster sums of point-to-cluster-centroid distances. Rows of Y
correspond to points, columns correspond to variables. tkmeans returns inside
structure out an n-by-1 vector idx containing the cluster indices of each
point. By default, tkmeans uses (squared) Euclidean distances. </p>

<p>DETAILS. This iterative algorithm initializes k clusters randomly and
performs "concentration steps" in order to improve the current cluster
assignment. The number of maximum concentration steps to be performed is
controlled by input parameter <a href="#refsteps">refsteps</a>. For
approximately obtaining the global optimum, the system is initialized <a
href="#nsamp">nsamp</a> times and concentration steps are performed until
convergence or refsteps is reached. When processing more complex data sets
higher values of nsamp and refsteps have to be specified (obviously implying
extra computation time). However, if more then 10% of the iterations do not
converge, a warning message is issued, indicating that <a
href="#nsamp">nsamp</a> has to be increased. </p>

<p> </p>

<p><tt>tkmeans</tt> requires  the following input</p>

<table cellspacing="0" class="body" cellpadding="4" border="2">
  <colgroup><col width="29%">
    <col width="71%">
  </colgroup>
  <tbody>
    <tr valign="top">
      <td><p><tt>Y</tt></p>
      </td>
      <td><p><tt>Y</tt> matrix of size <i>n</i>-by-<i>v</i>. Rows of Y
        represent observations, and columns represent variables. Missing values
        (NaN's) and infinite values (Inf's) are allowed, since observations
        (rows) with missing or infinite values will automatically be excluded
        from the computations. </p>
      </td>
    </tr>
    <tr>
      <td><p><tt>k</tt></p>
      </td>
      <td><p>Scalar which specifies the number of groups </p>
      </td>
    </tr>
    <tr valign="top">
      <td style="height: 98px"><p><tt><a name="alpha_">alpha</a> </tt></p>
      </td>
      <td style="height: 98px"><p>Scalar (real) generally between 0 and 0.5 or
        an integer specifying the number of observations which have to be
        trimmed. If <tt>alpha</tt>=0 tclust reduces to traditional model based
        or mixture clustering (mclust): see Matlab function gmdistribution.
        More in detail, if 0&lt; <tt>alpha</tt> &lt;0.5 clustering is based on
        h=fix(n*(1-alpha)) observations. Else if alpha is an integer greater
        than 1 clustering is based on h=n-floor(alpha); </p>
      </td>
    </tr>
  </tbody>
</table>

<p class="auto-style2"><tt>[out] = tkmeans(Y, k, alpha)</tt> returns the
following information</p>
<ul type="disc">
  <li><tt>out</tt> − A structure of additional statistics with the following
    fields. 
    <ul type="circle">
      <li><p><tt>idx</tt> − <tt>n</tt>-by-<tt>1</tt> vector containing
        assignment of each unit to each of the k groups. Cluster names are
        integer numbers from 1 to k. 0 indicates trimmed observations. </p>
      </li>
      <li><p><tt>muopt</tt> − <tt>k</tt>-by-<tt>v</tt> matrix containing
        cluster centroid locations. These are robust estimates of final
        centroids of the groups. </p>
      </li>
      <li><p><tt>bs</tt> − <tt>k</tt>-by-1 vector containing the units
        forming initial subset associated with <tt>muopt</tt>. </p>
      </li>
      <li><tt>post</tt> − <tt>n</tt>-by-<tt>k</tt> matrixatrix containing
        squared Euclidean distances from each point to every centroid.</li>
      <li><tt>siz</tt> − <tt>k</tt>-by-3 matrix <br>
        1st col = sequence from 0 to k<br>
        2nd col = number of observations in each cluster<br>
        3rd col = percentage of observations in each cluster<br>
        Remark: 0 denotes unassigned units</li>
      <li><tt>weights</tt> −numerical vector of length k, containing the
        weights of each cluster. If input option weights=1 out.weights=(1/k,
        ...., 1/k) else if input option weights <> 1 out.weights=(n1/n, ...,
        nk/n)></li>
      <li><tt>h</tt> − scalar. Number of observations that have determined
        the centroids (number of untrimmed units).</li>
      <li><tt>obj</tt> − scalar. Value of the objective function which is
        minimized (value of the best returned solution).</li>
    </ul>
    <ul>
      <li><tt>Y</tt> − scalar. original data matrix Y. The field is present
        if option Ysave is set to 1. </li>
    </ul>
  </li>
</ul>

<p> </p>

<p><tt>[out] = tkmeans(Y,k,alpha,param1,val1,param2,val2,...) </tt>specifies
one or more of the name/value pairs described in the following table.</p>

<table border="2" cellpadding="4" cellspacing="0" class="body">
  <colgroup><col width="21%">
    <col width="79%">
  </colgroup>
  <thead>
    <tr valign="top">
      <th bgcolor="#B2B2B2">Parameter</th>
      <th bgcolor="#B2B2B2">Value</th>
    </tr>
  </thead>
  <tbody>
    <tr valign="top">
      <td bgcolor="#F2F2F2"><tt><a name="nsamp">'nsamp'</a></tt></td>
      <td bgcolor="#F2F2F2"><p>Number of subsamples which will be extracted to
        find the partition. If nsamp=0 all subsets will be extracted. They will
        be (n choose k). Remark: if the number of all possible subset is <300
        the default is to extract all subsets, otherwise just 300 </p></p>
      </td>
    </tr>
    <tr>
      <td bgcolor="#F2F2F2"><tt><a name="refsteps">'refsteps'</a></tt></td>
      <td bgcolor="#F2F2F2"><p>Scalar defining number of refining iterations in
        each subsample (default = 15).</p>
      </td>
    </tr>
    <tr>
      <td bgcolor="#F2F2F2"><tt>'reftol'</tt></td>
      <td bgcolor="#F2F2F2"><p>Scalar. Default value of tolerance for the
        refining steps. The default value is 1e-14;</p>
      </td>
    </tr>
    <tr>
      <td bgcolor="#F2F2F2"><tt><a name="equalweights">'weights'</a></tt></td>
      <td bgcolor="#F2F2F2"><p>a dummy scalar, specifying whether cluster
        weights (1) shall be considered in the concentration and assignment
        steps. Remark: if weights=1 in the assignment step to the squared
        Euclidean distance of unit i to group j log n_j is substracted. The
        default is no cluster weights</p>
      </td>
    </tr>
    <tr>
      <td bgcolor="#F2F2F2"><tt>'plots'</tt></td>
      <td bgcolor="#F2F2F2"><p>Scalar. If <tt>plots</tt> = 1, a plot with the
        classification is shown on the screen. </p>
      </td>
    </tr>
    <tr>
      <td bgcolor="#F2F2F2"><tt>'msg'</tt></td>
      <td bgcolor="#F2F2F2"><p>Scalar which controls whether to display or not
        messages on the screen.<br>
        If <tt>msg=1</tt> (default) messages are displayed on the screen about
        estimated time to compute the estimator or the number of subsets in
        which there was no convergence.<br>
        Else no message is displayed on the screen.</p>
      </td>
    </tr>
    <tr>
      <td bgcolor="#F2F2F2"><tt>'nocheck'</tt></td>
      <td bgcolor="#F2F2F2"><p>Scalar. If <tt>nocheck</tt> is equal to 1 no
        check is performed on<br>
        matrix Y.<br>
        As default <tt>nocheck</tt> =0.</p>
      </td>
    </tr>
    <tr>
      <td bgcolor="#F2F2F2"><tt>'Ysave'</tt></td>
      <td bgcolor="#F2F2F2"><p>Scalar that is set to 1 to request that the
        input matrix Y is saved into the output structure out. Default is 0,
        i.e. no saving is done. </p>
      </td>
    </tr>
  </tbody>
</table>

<p></p>

<p> </p>

<h2>References </h2>

<p><br>
Garcia-Escudero, L.A.; Gordaliza, A.; Matran, C. and Mayo-Iscar, A. (2008), "A
General Trimming Approach to Robust Cluster Analysis". Annals of Statistics,
Vol.36, 1324-1345. Technical Report available at
www.eio.uva.es/inves/grupos/representaciones/trTCLUST.pdf</p>

<h3>Examples</h3>

<h3>Example 1</h3>

<p class="auto-style1">tkmeans applied to geyser data with with option weights
=0</p>
<pre class="programlisting"> </pre>
<pre class="programlisting">    % Trimmed k-means using geyser data
    % 3 groups and trimming level of 3%
    Y=load('geyser2.txt');
    out=tkmeans(Y,3,0.03,'plots',1)
</pre>

<p><img alt="" src="images_help/img8.jpg"></p>

<p>Compare the above solution with the one obtained with option weights =1</p>
<pre class="programlisting">    % Trimmed k-means using geyser data
    % option weights =1
    Y=load('geyser2.txt');
    out=tkmeans(Y,3,0.03,'plots',1,'weights',1)</pre>

<p><img alt="" src="images_help/imgE1.jpg"></p>

<h3>See Also</h3>

<p><tt><a href="tclust.html">tclust</a></tt> </p>

<p></p>

<table border="0" cellpadding="0" cellspacing="0" class="nav"
summary="Navigation aid" width="100%">
  <tbody>
    <tr valign="top">
      <td align="left" width="20"><a href="tclustreg.html"><img align="bottom"
        alt="fanplot" border="0" src="images_help/b_prev.gif"></a> </td>
      <td align="left">tclustreg.html</td>
      <td> </td>
      <td align="right">triu2vec.html</td>
      <td align="right" width="20"><a href="triu2vec.html"><img align="bottom"
        alt="FSMeda" border="0" src="images_help/b_next.gif"></a></td>
    </tr>
  </tbody>
</table>
<script type="text/javascript" language="javaScript">
document.write(barra);</script>
<!-- Last updated: Fri Jan 23 17:00:05 EST 2009-->
</body>
</html>
