<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<!--FScategory:Robust Model Selection-->



<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>FSRaddt :: Functions (Flexible Statistics Data Analysis Toolbox&trade;)</title>
<link href="docstyle.css" rel="stylesheet" type="text/css">
<meta content="refpage" name="chunktype">


<script  type="text/javascript" language="javaScript" src="bottom.js"></script>

</head>


<body>

<a name="top_of_page"></a>
<p style="font-size: 1px;">&nbsp;</p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr>
		<td valign="baseline"><b>Flexible Statistics Data Analysis Toolbox&trade;</b></td>
		<td align="right" valign="baseline"><a href="fsr.html">
		<img align="bottom" alt="FSR" border="0" src="images_help/b_prev.gif"></a>&nbsp;&nbsp;
		<a href="fsrb.html">
		<img align="bottom" alt="FSRbsb" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<a name="FSRaddt"></a><a class="indexterm" name="FSRaddt"></a>
<h1 class="reftitle">FSRaddt</h1>
<p class="purpose">Robust Forward Variable Selection using Deletion (Added) t tests </p>
<h2>Syntax </h2>
<p class="synopsis"><tt>[out] = FSRaddt(y,X)<br>[out] = FSRaddt(y,X,<i><tt>param1</tt></i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)<br>
</tt></p>
<a name="bq24of9-2"></a>
<h2>Description</h2>
<p><tt>[out] = FSRaddt(y,X)</tt> produces the forward deletion t-statistics for each explanatory variable. Since the search orders the observations by the magnitude of their residuals from the fitted subsets, the value of s<sup>2</sup> increases during the search, although not necessarily monotonically. As a consequence, even in the absence of outliers and model inadequacies, the values of the t-statistics for the parameters in the model decrease during the search and are hard to interpret. Atkinson and Riani (2002) in order to overcome this problem use the method of added variables to provide plots of 
<em>t</em>-tests which are orthogonal to the search. 
</p>
<p><tt>y</tt> is a vector of length <em>n</em> containing the response values, while <tt>X</tt> is the <i>n</i>-by-<i>p-1</i> matrix  
which contains (in the columns) the values of <i>p-1</i> predictive terms</p>
<p><tt><a name="bq24of9-3"></a>[out] = FSRaddt(y,X)</tt> returns the following information
</p>
<ul type="disc">
	<li><tt>out</tt> &minus; A structure of additional statistics with the following fields.
	<ul type="circle">
		<li>
		<p><tt>Tdel</tt> &minus; <tt>(n-init+1)</tt>-by-<tt>(p+1)</tt> matrix containing the monitoring of
              deletion t stat in each step of the forward search<br>
              1st col = fwd search index (from init to n)<br>
              2nd col = deletion <em>t</em> stat for first explanatory variable<br>
              3rd col = deletion <em>t</em> stat for second explanatory variable<br>
              ...<br>
              (p+1)th col = deletion t stat for pth explanatory variable<br> </p>
		</li>
		<li>
		<p><tt>S2del</tt> &minus; <tt>(n-init+1)</tt>-by-<tt>(p+1)</tt> matrix containing the monitoring of
              deletion t stat in each step of the forward search
              1st col = fwd search index (from init to n)<br>

              2nd col = deletion <em>t</em> stat for first explanatory variable<br>

              3rd col = deletion <em>t</em> stat for second explanatory variable<br>

              ...<br>

              (p+1)th col = deletion <em>t</em> stat for pth explanatory variable<br>
</p>
		</li>
		<li>
		
		       <tt>Una</tt> &minus;    cell of size <em>p</em>.
		       <br>    <tt>out.Una{i} (i=1, ..., p)</tt> is a (n-init) x 11 matrix which
              contains the unit(s) included in the subset at each step in
              the search which excludes the ith explanatory variable
              <br>REMARK: in every step the new subset is compared with the
              old subset. Un contains the unit(s) present in the new
              subset but not in the old one <tt>Un(1,:)</tt> for example contains
              the unit included in step init+1 ... <tt>Un(end,2)</tt> contains the
              units included in the final step of the search

		</li>
	</ul>
	<p></p>
	
	</li>
</ul>
<ul>
		<table border="1" cellpadding="5" cellspacing="0" class="note" summary="Note">
			<tr width="90%">
				<td>
				<p><b>Note</b>&nbsp;&nbsp; <tt>FSRaddt</tt> automatically includes a 
				constant term in all models. Do not enter a column of 1s directly 
				into <tt>X</tt>. <br>Sometimes the word &#39;deletion t statistics&#39; is 
				used while other times the word &#39;added t statistics&#39;. Both ways of saying are true. 
				The vales which are produced
				are 'deletion estimates', because each variable is deleted in turn during each separate search, 
				but at the same time they are 'added estimates' because the test is an added t test for the presence of the variable
				which was excluded during the search.  
				 </p>
				</td>
			</tr>
		</table>
	</ul>

<p></p>
<p><tt>[out] = FSRaddt(y,X,<i><tt>param1</tt></i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)</tt> 
specifies one or more of the name/value pairs described in the following table.</p>
<table border="2" cellpadding="4" cellspacing="0" class="body">
	<colgroup>
		<col width="21%"><col width="79%">
	</colgroup>
	<thead>
		<tr valign="top">
			<th bgcolor="#B2B2B2">Parameter</th>
			<th bgcolor="#B2B2B2">Value</th>
		</tr>
	</thead>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;intercept&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>If 1, a model with constant term will be fitted (default) else no constant 
		term will be included.  </p>
		</td>
	</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;h&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p>The number of observations that determine the least trimmed squares 
		estimator. <tt>h</tt> generally is an integer greater or equal than <tt>[(n+size(X,2)+1)/2]</tt> 
		but smaller then n.</p>
		</td>
	</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;nsamp&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Number of subsamples which will be extracted to find the robust estimator. 
		If <tt>nsamp=0</tt> all subsets will be extracted. They will be <tt>(n choose p)</tt>. 
		Remark: if the number of all possible subset is smaller than 1000 the default 
		is to extract all subsets otherwise just 1000.</p>
		</td>
	</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;lms&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Scalar. If <tt>lms=1</tt> (default) Least Median of Squares is computed, 
		else Least trimmed squares is computed.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;init&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Scalar which specifies the initial subset size to start monitoring exceedances, 
		if init is not specified it will be set equal to   		
		<br><tt>p+1</tt>, if the sample size is smaller than 40; <br><tt>min(3*p+1,floor(0.5*(n+p+1)))</tt>, otherwise.</td>
			</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;rew&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Scalar. If <tt>rew=1</tt> the reweighted version of LTS (LMS)
              and the output quantities refer to the reweighted version
              else no reweighting is performed (default).</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;plots&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Scalar. If <tt>plots=1</tt> a plot with robust residuals is produced 
		else (default) no plot is produced.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;nameX&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Cell array of strings of length p containing the labels of the 
		variables of the regression dataset. If it is empty (default) the 
		sequence X1, ..., Xp will be created automatically</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;lwdenv&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>Scalar which controls the line with of the horizontal lines 
		associated with the envelopes. Default is lwdenv=1.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;quant&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Confidence quantiles for the envelopes of deletion t stat. Default is 
		[0.005 0.995] (i.e. a 99% pointwise confidence interval)</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;xlimx&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		Vector with two elements controlling minimum and maximum on the x 
		axis. Default value is &#39;&#39; (automatic scale)</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;ylimy&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Vector with two elements controlling minimum and maximum on the y 
		axis. Default value is &#39;&#39; (automatic scale)</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;lwdt&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Line width for deletion t stat (default is 2)</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;titl&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		a label for the title (default: &#39;&#39;) 
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;labx&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		a label for the x-axis (default: &#39;Subset size m&#39;).</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;laby&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		a label for the y-axis (default: &#39;Deletion test statistics&#39;).</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;FontSize&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		Scalar which controls the font size of the labels of the axes. Default 
		value is 12.</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;SizeAxesNum&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		Scalar which controls the size of the numbers of the axes. Default value 
		is 10.</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;nocheck&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Scalar. If nocheck is equal to 1 no check is performed on matrix y 
		and matrix X. Notice that y and X are left unchanged. In other words the 
		additional column of ones for the intercept is not added. As default 
		nocheck=0.</p>
		</td>
	</tr>
	</table>
<p></p>
<a name="bq9x7hn"></a><a name="bq5gf2y"></a>
<h3>Examples</h3>
In this example we perform a variable selection on the 'famous' stack loss data using different transformation scales for the response. 

<pre class="programlisting">
load('stack_loss');
y=stack_loss.data(:,4);
X=stack_loss.data(:,1:3);
</pre>

We start with a <a href="fanplot.html">fan plot </a>based on first-order model and the five most common values of 
&lambda; (Figure below).  
<pre class="programlisting">
[out]=FSRfan(y,X,'plots',1);
</pre>


The fan plot shows that the square root transformation, &lambda;= 0.5,
is supported by all the data, with the absolute value
of the statistic always less than 1.5.
The evidence for all other
transformations depends on which observations have been deleted: the
log transformation is rejected when some of the suspected outliers
are introduced into the data although it is acceptable for all
the data: &lambda;= 1 is rejected
as soon as any of the suspected outliers are present.


<p>
<img src="plots/fsradd4.gif">
</p>
<p>Given that the transformation for the response which is chosen depends on the number 
of units declared as outliers we perform a variable selection using the original scale, the square root
and the log transformation.
</p>
<p>Robust variable selection using original untransformed values of the response</p>
<pre class="programlisting">
% Monitoring of deletion t stat in the original scale
[out]=FSRaddt(y,X,'plots',1,'quant',[0.025 0.975]);
</pre>
 <img border="0" src="plots/fsradd3.gif">
 <p></p>
<p>&gt;Robust variable selection using square root values</p>
<pre class="programlisting">
% Monitoring of deletion t stat using transformed response based on the square root
[out]=FSRaddt(y.^0.5,X,'plots',1,'quant',[0.025 0.975]);
</pre>
<img src="plots/fsradd2.gif">
<p><p>Robust variable selection using  log transformed values of the response</p>
<pre class="programlisting">
% Monitoring of deletion t stat using log transformed values
[out]=FSRaddt(log(y),X,'plots',1,'quant',[0.025 0.975]);
</pre>
</p>
<p><img src="plots/fsradd5.gif"></p>
<p>
<b>Conclusion: the forward analysis based on the deletion t statistics clearly reveals that variable X3, independently from the transformation 
which is chosen and the number of outliers which are declared, is NOT significant.
</b> 
</p>

<h3>See Also</h3>

<p><a href="addt.html"><tt>addt</tt></a>, <a href="fsrms.html"><tt>FSRms</tt></a></p>
<p></p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr valign="top">
		<td align="left" width="20"><a href="fsr.html">
		<img align="bottom" alt="FSR" border="0" src="images_help/b_prev.gif"></a>
		</td>
		<td align="left">fsr.html</td>
		<td>&nbsp;</td>
		<td align="right">fsrb.html</td>
		<td align="right" width="20"><a href="fsrb.html">
		<img align="bottom" alt="FSRbsb" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<script type ="text/javascript" language="javaScript">
document.write(barra);
</script>
<!-- Last updated: Fri Jan 23 17:00:05 EST 2009-->

</body>

</html>
