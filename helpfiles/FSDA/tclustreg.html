
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title></title><meta name="generator" content="MATLAB 9.7"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-11-03"><meta name="DC.source" content=".m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1></h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Ex1</a></li><li><a href="#2">ExExtra4</a></li></ul></div><h2>Ex1<a name="1"></a></h2><p>The dataset presents two parallel components without contamination.</p><pre class="codeinput">X  = load(<span class="string">'X.txt'</span>);
y1 = X(:,end);
X1 = X(:,1:end-1);
k = 2 ;
restrfact = 5; alpha1 = 0.05 ; alpha2 = 0.01;
out = tclustreg(y1,X1,k,restrfact,alpha1,alpha2);
restrfact = 2; alpha1 = 0.05 ; alpha2 = 0.01;
out = tclustreg(y1,X1,k,restrfact,alpha1,alpha2,<span class="string">'mixt'</span>,2);
<span class="comment">% Comparison with robust linear grouping</span>
out = rlga(X,k,alpha2);
</pre><pre class="codeoutput">ClaLik with untrimmed units selected using crisp criterion
</pre><pre class="codeoutput error">Error:File: D:\MATLAB\FSDA\multivariate\mcd.m Line: 766 Column: 13
Identifier 'meanvct' is not a function or a shared variable. To share 'meanvct' with nested function, initialize it in the current scope. For more information, see Sharing Variables Between Parent and Nested Functions.

Error in tclustreg (line 1650)
                                [~,REW]      = mcd(Xjnointercept,'msg',0,'betathresh',1);

Error in tclustregtmp (line 9)
out = tclustreg(y1,X1,k,restrfact,alpha1,alpha2);
</pre><h2>ExExtra4<a name="2"></a></h2><pre class="codeinput">close <span class="string">all</span>
<span class="comment">% Generate two groups and a set of concentrated outliers</span>
rng(100)
p=1;
n1=90;
x1=(randn(n1,p)+2)*2.1-1;
y1=-1.2*x1*1+randn(n1,1)*0.6+2.1;
n2=90;
x2=(randn(n1,p)+4)*1.5-4;
y2=5+x2*0.7+randn(n2,p)*0.6;
n3=20;
x3=randn(n3,p)*0.1+12-4;
y3=randn(n3,p)*0.1+16-2;
<span class="comment">%x3=0;</span>
<span class="comment">%y3=0;</span>
X=[x1;x2;x3];
y=[y1;y2;y3];
n=n1+n2+n3;
group=[ones(n1,1); 2*ones(n2,1); 3*ones(n3,1)];
yXplot(y,X,group);
legend(<span class="string">'Location'</span>,<span class="string">'best'</span>)
<span class="comment">% gscatter(X,y,group)</span>
<span class="comment">% Run the 3 models and compare the results</span>
k=2;
<span class="comment">% Specify restriction factor for variance of residuals</span>
restrfact=5;
<span class="comment">% 10 per cent first level trimming.</span>
alphaLik=0.1;
<span class="comment">% number of subsamples to extract</span>
nsamp=1000;
addnoisevariable = false;
<span class="keyword">if</span> addnoisevariable ==true
X=[X randn(n,1)];
<span class="keyword">end</span>
<span class="comment">% In this case we use CWM model</span>
alphaXcwm=1;
[outCWM]=tclustreg(y,X,k,restrfact,alphaLik,alphaXcwm,<span class="keyword">...</span>
<span class="string">'mixt'</span>,0,<span class="string">'plots'</span>,1,<span class="string">'msg'</span>,0,<span class="string">'nsamp'</span>,nsamp);
title(<span class="string">'CWM model'</span>)
<span class="comment">% In this case we use an adaptive second level of trimming.</span>
alphaXada=0.95;
[outADA]=tclustreg(y,X,k,restrfact,alphaLik,alphaXada,<span class="keyword">...</span>
<span class="string">'mixt'</span>,0,<span class="string">'plots'</span>,1,<span class="string">'msg'</span>,0,<span class="string">'nsamp'</span>,nsamp);
title(<span class="string">'Adaptive second level trimming'</span>)
<span class="comment">% In this case we use a fixed level of trimming</span>
alphaXfixed=0.02;
[out2LT]=tclustreg(y,X,k,restrfact,alphaLik,alphaXfixed,<span class="keyword">...</span>
<span class="string">'mixt'</span>,0,<span class="string">'plots'</span>,1,<span class="string">'msg'</span>,0,<span class="string">'nsamp'</span>,nsamp);
title(<span class="string">'Fixed second level trimming'</span>)
disp(<span class="string">'CWM model and adaptive second level trimming'</span>)
disp(<span class="string">'can recover the real structure of the data'</span>)
</pre><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2019b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Ex1% The dataset presents two parallel components without contamination.
X  = load('X.txt');
y1 = X(:,end);
X1 = X(:,1:end-1);
k = 2 ;
restrfact = 5; alpha1 = 0.05 ; alpha2 = 0.01;
out = tclustreg(y1,X1,k,restrfact,alpha1,alpha2);
restrfact = 2; alpha1 = 0.05 ; alpha2 = 0.01;
out = tclustreg(y1,X1,k,restrfact,alpha1,alpha2,'mixt',2);
% Comparison with robust linear grouping
out = rlga(X,k,alpha2);%% ExExtra4close all
% Generate two groups and a set of concentrated outliers
rng(100)
p=1;
n1=90;
x1=(randn(n1,p)+2)*2.1-1;
y1=-1.2*x1*1+randn(n1,1)*0.6+2.1;
n2=90;
x2=(randn(n1,p)+4)*1.5-4;
y2=5+x2*0.7+randn(n2,p)*0.6;
n3=20;
x3=randn(n3,p)*0.1+12-4;
y3=randn(n3,p)*0.1+16-2;
%x3=0;
%y3=0;
X=[x1;x2;x3];
y=[y1;y2;y3];
n=n1+n2+n3;
group=[ones(n1,1); 2*ones(n2,1); 3*ones(n3,1)];
yXplot(y,X,group);
legend('Location','best')
% gscatter(X,y,group)
% Run the 3 models and compare the results
k=2;
% Specify restriction factor for variance of residuals
restrfact=5;
% 10 per cent first level trimming.
alphaLik=0.1;
% number of subsamples to extract
nsamp=1000;
addnoisevariable = false;
if addnoisevariable ==true
X=[X randn(n,1)];
end
% In this case we use CWM model
alphaXcwm=1;
[outCWM]=tclustreg(y,X,k,restrfact,alphaLik,alphaXcwm,...
'mixt',0,'plots',1,'msg',0,'nsamp',nsamp);
title('CWM model')
% In this case we use an adaptive second level of trimming.
alphaXada=0.95;
[outADA]=tclustreg(y,X,k,restrfact,alphaLik,alphaXada,...
'mixt',0,'plots',1,'msg',0,'nsamp',nsamp);
title('Adaptive second level trimming')
% In this case we use a fixed level of trimming
alphaXfixed=0.02;
[out2LT]=tclustreg(y,X,k,restrfact,alphaLik,alphaXfixed,...
'mixt',0,'plots',1,'msg',0,'nsamp',nsamp);
title('Fixed second level trimming')
disp('CWM model and adaptive second level trimming')
disp('can recover the real structure of the data')
##### SOURCE END #####
--></body></html>