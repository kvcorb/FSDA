<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<!--FScategory:Robust multivariate analysis and transformations-->

<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>FSMtra :: Functions (Flexible Statistics Data Analysis Toolbox&trade;)</title>
<link href="docstyle.css" rel="stylesheet" type="text/css">
<meta content="refpage" name="chunktype">

<script  type="text/javascript" language="javaScript" src="bottom.js"></script>

</head>


<body>

<a name="top_of_page"></a>
<p style="font-size: 1px;">&nbsp;</p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr>
		<td valign="baseline"><b>Flexible Statistics Data Analysis Toolbox&trade;</b></td>
		<td align="right" valign="baseline"><a href="fsmmmdeasy.html">
		<img align="bottom" alt="fsmmmd" border="0" src="images_help/b_prev.gif"></a>&nbsp;&nbsp;
		<a href="fsr.html">
		<img align="bottom" alt="olsline" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<a class="indexterm" name="zmw57dd0e69698"></a>
<h1 class="reftitle">FSMtra</h1>
<p class="purpose">Maximum likelihood estimates of (Box Cox)
transformation parameters. </p>
<h2>Syntax </h2>
<p class="synopsis"><tt>out=FSMtra(Y)<br>out=FSMtra(Y,<i><tt>param1</tt></i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)<br>
</tt></p>
<a name="minplot-2"></a>
<h2>Description</h2>
<p><tt>FSMtra(Y)</tt> computes mle of transformation parameters monitored along the search. </p>
<p><tt>Y</tt> is a matrix of size <i>n</i>-by-<i>v</i> containing (in the columns) 
the variables of the dataset</p>
<p><tt>[out] = FSMtra(Y)</tt> returns the following information

</p>
<ul type="disc">
	<li><tt>out</tt> &minus; A structure of additional statistics with the following fields.
	
	<ul type="circle">
		<li>
		<p><tt>MLEtra</tt> &minus; <tt>n-init+1</tt>-by-(<tt>v</tt>+1) matrix which contains the monitoring of
              MLE of transformation parameters <br>
              1st col = fwd search index (from init to n) <br>
              2nd col = MLE of variable 1 <br>
              3rd col = MLE of variable 2 <br>
              ... <br>
              (v+1)th col = MLE of variable v <br>  </p>
		</li>
		<li>
		<p><tt>LIKrat</tt> −  <tt>n-init+1</tt>-by-2 matrix which contains the 
		monitoring of the likelihood ratio for testing H0:\lambda=la0 <br>
              1st col = fwd search index (from init to n) <br>
              2nd col = value of the likelihood ratio <br>
 		</li>
		<li>
		<p><tt>Exflag</tt> &minus; <tt>(n-init+1)</tt>-by-2 matrix which contains the monitoring of
              the integer identifying the reason why the maximization
              algorithm terminated. See help page 
              <a href="matlab:web(['jar:file:///',matlabroot,'/help/toolbox/optim/help.jar!/ug/fminunc.html'],'-helpbrowser')">
<tt>fminunc</tt></a> of the
              optimization toolbox 
or 
<a href="matlab:web(['jar:file:///',matlabroot,'/help/techdoc/help.jar!/ref/fminsearch.html'],'-helpbrowser')">
<tt>fminsearch</tt></a>
                for the list of values of exitflag
              and the corresponding reasons the algorithm terminated.
              <br>
              1st col = fwd search index (from init to n) <br>
              2nd col = the value that describes the exit condition <br>

              </p>
		</li>
		<li>
		<p><tt>Un</tt> &minus; <tt>(n-init)</tt>-by-11 matrix which contains the unit(s) included 
		in the subset at each step of the fwd search. <br>REMARK: in every step 
		the new subset is compared with the old subset. Un contains the unit(s) 
		present in the new subset but not in the old one.<br>Un(1,2) for example 
		contains the unit included in step init+1.<br>Un(end,2) contains the units 
		included in the final step of the search.</p>
		</li>
	</ul>
	<ul>
		
		<a name="zmw57dd0e69798"></a>
		
	</ul>
	</li>
</ul>
<p><tt>[out] = FSMtra(<i>Y,param1</i></tt><tt>,</tt><tt><i>val1</i><tt>,</tt><i>param2</i><tt>,</tt><i>val2</i><tt>,...)</tt></tt> 
specifies one or more of the name/value pairs described in the following table.</p>
<table border="2" cellpadding="4" cellspacing="0" class="body">
	<colgroup>
		<col width="21%"><col width="79%">
	</colgroup>
	<thead>
		<tr valign="top">
			<th bgcolor="#B2B2B2">Parameter</th>
			<th bgcolor="#B2B2B2">Value</th>
		</tr>
	</thead>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;init&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>scalar which specifies the point where to start monitoring
              required diagnostics. Note that if init is not specified it will
              be set equal to floor(n*0.6).</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;bsb&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>vector containing the units forming initial subset. The
              default value of bsb is '' that is the initial subset is
              found through the intersection of robust bivariate ellipses
              This option is useful if a forced start is required</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;rf&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Confidence level for bivariate ellipses 
		(default is 0.95). This option is useful only if crit=&#39;biv&#39;.</td>
			</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;ColToTra&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>k x 1 integer vector specifying the variables which must be
              transformed.</td>
			</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;la0&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>k x 1 vector containing set of transformation
              parameters for the k ColtoTra. The ordering of Mahalanobis
              distances at each step of the forward search uses variables
              transformed with la0. la0 empty is equivalent to its
              default value la0=ones(length(ColToTra),1).</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;onelambda&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>scalar. If onelambda=1, a common value lambda is estimated
              for all variables specified in ColToTra</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;optmin&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>
		structure containing the options dealing with the
              maximization algorithm. Use optimset to set these options.
              Notice that the maximization algorithm which is used is
              fminunc is the optimization toolbox is present else is
              fminsearch. 
</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;speed&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>scalar. If speed=1 (default) the initial value at step m of
              the maximization procedure (fminunc or fminsearch) is the
              final value at step m-1 else it is la0.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;colnames&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>cell array of strings of length v containing the names of
              the variables of the dataset. If colnames is empty then the
              sequence 1:v is created to label the variables.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;prolik&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>
		scalar or structure specifying whether it is necessary to
              monitor the profile log likelihood of the transformation
              parameters at selected steps of the search.<br>
              If prolik is a scalar, the plot of the profile loglikelihoods
              is produced at step m=n with all default parameters <br>
              Structure prolik may contain the following fields: <br>

                  <tt>steps</tt> = vector containing the steps of the fwd search
                  for which profile logliks have to be plotted. The
                  default value of steps is n<br>

                  <tt>clev</tt> = scalar between 0 and 1 determining confidence
                  level for each element of lambda based on the
                  asymptotic chi1^2 of twice the loglikelihood ratio. The
                  default confidence level is 0.95.<br>

                  <tt>xlim</tt> = minimum and maximum on the x axis.<br>

                  <tt>LineWidth</tt> = line width of the vertical lines defining
                  confidence levels of the transformation parameters</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;plotsmle&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>
		scalar or structure specifying whether it is necessary to
              plot the maximum likelihood estimates of the transformation
              parameters. 
              Remark: three horizontal lines associated respectively with
              values -1, 0 and 1 are added to the plot <br>
              Structure pltsmle may contain the following fields: <br>
              
   <tt>xlim</tt> = minimum and maximum on the x axis<br>


                  <tt>ylim</tt> = minimum and maximum on the y axis<br>

                  <tt>LineWidth</tt> = Line width of the trajectories of mle of
                  transformation parameters.<br>

                  <tt>LineStyle</tt> = cell containing Line styles of the
                  trajectories of mle of transformation paramters<br>
                  
                        <tt>LineWidthEnv</tt> = Line width of the horizontal lines<br>
            
                           <tt>Tag</tt> = tag of the plot (default is pl_mle)<br>
      
                       <tt>FontSize</tt> = font size of the text labels which identify
                  the trajectories<br>
             
                  </p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;plotslrt&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>
		scalar or structure specifying whether it is necessary to
              plot the likelihood ratio test<br>
              Structure plotsmle may contain the following fields: <br>
              
   <tt>xlim</tt> = minimum and maximum on the x axis<br>


                  <tt>ylim</tt> = minimum and maximum on the y axis<br>

                  <tt>LineWidth</tt> = Line width of the trajectory of lrt of
                  transformation parameters<br>

                  <tt>conflev</tt> = vector which defines the confidence levels of
                  the horizontal line for the likelihood ratio test
                  (default is conflev=[0.95 0.99])<br>
                  
                        <tt>LineWidthEnv</tt> = Line width of the horizontal lines<br>
            
            <tt>Tag</tt> = tag of the plot (default is pl_lrt)<br>
            
             
                  </p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;msg&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p> scalar which controls whether to display or not messages
              about great interchange on the screen. <br>
If <tt>msg</tt>=1 (default) messages are displayed on the screen
              else no message is displayed on the screen<br></p>
		</td>
	</tr>
</table>
<p></p>

<a name="bq9x7hn"></a><a name="bq5gf2y"></a>

<h3>Examples</h3>

<h3>See Also</h3>

<p><a href="resindexplot.html"><tt>resindexplot</tt></a>, <a href="resfwdplot.html"><tt>resfwdplot</tt></a>, <a href="fanplot.html"><tt>fanplot</tt></a>
</p>

<p></p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr valign="top">
		<td align="left" width="20"><a href="fsmmmdeasy.html">
		<img align="bottom" alt="FSMmmd" border="0" src="images_help/b_prev.gif"></a>
		</td>
		<td align="left">fsmmmdeasy.html</td>
		<td>&nbsp;</td>
		<td align="right">fsr.html</td>
		<td align="right" width="20"><a href="fsr.html">
		<img align="bottom" alt="olsline" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<script type ="text/javascript" language="javaScript">
document.write(barra);
</script>
<!-- Last updated: Fri Jan 23 17:00:05 EST 2009-->

</body>

</html>
