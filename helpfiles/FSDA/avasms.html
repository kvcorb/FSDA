<!DOCTYPE HTML> <html itemscope="" xmlns="http://www.w3.org/1999/xhtml"><head><title>avasms</title><meta content="refpage" name="chunktype"><meta content="function:avasms" itemprop="refentity" name="refentity"><meta content="text/javascript" http-equiv="Content-Script-Type"><meta content="fcn" itemprop="pagetype" name="toctype"><meta content="ref/function" itemprop="infotype" name="infotype" /><meta content="avasms computes avas using a series of alternative options." itemprop="description" name="description" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /><script type="text/x-mathjax-config">MathJax.Hub.Config({extensions: ["tex2jax.js"],jax: ["input/TeX","output/HTML-CSS"],menuSettings: {zoom: "Double-Click", zscale: "300"},tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},MathMenu: {showRenderer: false},"HTML-CSS": {availableFonts: ["TeX"],preferredFont: "TeX",imageFont: null}});</script><script type="text/javascript" src="includesFS/Mathjax/MathJax.js"></script><script src="includesFS/matlab-highlighter.min.js"></script><link href="includesFS/matlab-highlighter.css" rel="stylesheet" type="text/css"><script type="text/javascript" src="includesFS/jquery-latest.js"></script><script>$(document).ready(function(){      $("#divtop").load("includesFS/top.html");      $("#divbottom").load("includesFS/bottom.html");});</script><link href="../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)"></link><link href="../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)"></link><link href="../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)"></link><link href="../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)"></link><link href="../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)"></link><link href="../includes/product/css/site6_offcanvas.css" rel="stylesheet" type="text/css"></link><script src="../includes/shared/scripts/l10n.js" type="text/javascript"></script><script src="../includes/product/scripts/docscripts.js"></script><script src="../includes/shared/scripts/docscripts_rn.js"></script><script src="../includes/shared/scripts/mw.imageanimation.js" type="text/javascript"></script><script src="../includes/shared/scripts/jquery.highlight.js"></script><script src="../includes/product/scripts/bootstrap.min.js" type="text/javascript"></script><script src="../includes/product/scripts/global.js"></script><script src="includesFS/bottom.js" type="text/javascript"></script><script src="../includes/product/scripts/underscore-min.js"></script><script src="../includes/shared/scripts/f1help.js" type="text/javascript"></script><script src="../includes/product/scripts/suggest.js" type="text/javascript"></script><script src="../includes/shared/scripts/helpservices.js" type="text/javascript"></script><script src="../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script><!-- the following line should be kept this way only --><link href="includesFS/doc_center.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css"><link href="../includes/product/css/doc_center_print.css" media="print" rel="stylesheet" type="text/css"></head><body  onload="highlightMATLABCode();" id="responsive_offcanvas">  <div id="doc_header_spacer" class="header"></div><div class="sticky_header_container includes_subnav"><div class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-xs-12 col-sm-6 col-sm-push-6 col-md-5 col-md-push-7" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2017a" data-language="en" action="../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="sr-only">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"><div class="input-group-btn"><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search pull-right icon_32 visible-xs" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="col-sm-6 col-sm-pull-6 col-md-7 col-md-pull-5" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../documentation-center.html">Documentation</a></h1></div></div></div><div class="visible-xs" id="search_actuator"><button class="btn icon-search btn_search pull-right icon_16" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div><!--END.CLASS row--> </div><!--END.CLASS container-fluid--> </div><!--END.CLASS section_header level_3--><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_actuator" data-toggle="offcanvas" data-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="sr-only">Toggle navigation</span><span class="icon-menu icon_24"></span></button><span class="offcanvas_actuator_label"></span><span class="offcanvas_actuator_close"></span> </div><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-md-12 hidden-xs hidden-sm"></div></div></div></div></div></div></div><!--END.CLASS sticky_header_container--><div class="row-offcanvas row-offcanvas-left"><div id="sidebar" class="sidebar-offcanvas" role="navigation"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" xmlns:atict="http://www.arbortext.com/namespace/atict"><li itemprop="breadcrumb" itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb"> <a href="../documentation-center.html" itemprop="url"> <span itemprop="title">All Products</span></a></li></ul><ul class="nav_disambiguation" xmlns:atict="http://www.arbortext.com/namespace/atict"><li class="product"><a href="index.html">Flexible Statistics and Data Analysis (FSDA)</a><div class="dropdown"> <span id="dropdownMenu1" class="icon-arrow-down icon_16" data-toggle="dropdown"> </span><ul aria-labelledby="dropdownMenu1" class="dropdown-menu dropdown-menu-right" role="menu"><li role="presentation"> <a href="examples.html" role="menuitem" tabindex="-1">Examples</a></li><li role="presentation"> <a href="function-alpha.html" role="menuitem" tabindex="-1"> Functions and Other Reference</a></li><li role="presentation"> <a href="release_notes.html?s_cid=doc_flyout" role="menuitem" tabindex="-1"> Release Notes</a></li><li role="presentation"> <a href="tutorials.html" role="menuitem" tabindex="-1"> Tutorials</a></li></ul></div></li></ul><ul xmlns:atict="http://www.arbortext.com/namespace/atict" class="nav_disambiguation"> <li><a href="index.html">Flexible Statistics and Data Analysis Toolbox</a> </li> <li><a href="function-cate.html" itemprop="url">Functions</a></li></ul><!-- --><ul class="nav_scrollspy nav" xmlns:atict="http://www.arbortext.com/namespace/atict">  <li class="nav_scrollspy_function"> <a href="#responsive_offcanvas">avasms</a></li> <li id="SSPY810-refentry" class="nav_scrollspy_title">On this page</li><li><a class="intrnllnk" href="#syntax">Syntax</a></li><li><a class="intrnllnk" href="#Description">Description</a></li><li><a class="intrnllnk" href="#Examples">Examples</a><ul><li><a class="intrnllnk" href="#Example_1">Example 2 in RAC (2022).</a></li><li><a class="intrnllnk" href="#Example_2">Wang and Murphy data.</a></li><li><a class="intrnllnk" href="#Example_3">Example of the use of avasms using the Fish data.</a></li></ul></li><li><a class="intrnllnk" href="#ExtraExamples">Extra Examples</a><ul><li><a class="intrnllnk" href="#ExtraExample_1">Example of use of option critBestSol with marketing data.</a></li></ul></li><li><a class="intrnllnk" href="#Inputs">Input Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_y">y</a></li><li><a class="intrnllnk" href="#input_argument_X">X</a></li></ul></li><li><a class="intrnllnk" href="#NameValuePairs">Name-Value Pair Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_namevalue_critBestSol">critBestSol</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_delrsq">delrsq</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_l">l</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_maxit">maxit</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_nterm">nterm</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_solOrdering">solOrdering</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_w">w</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_plots">plots</a></li></ul></li><li><a class="intrnllnk" href="#OutputArgs">Output Arguments</a><ul><li><a class="intrnllnk" href="#output_argument_BestSol">BestSol</a></li><li><a class="intrnllnk" href="#output_argument_corMatrix">corMatrix</a></li></ul></li><li><a class="intrnllnk" href="#MoreAbout">More About</a></li><li><a class="intrnllnk" href="#References">References</a></li><li><a class="intrnllnk" href="#SeeAlso">See Also</a></li></ul></nav><script src="../includes/product/scripts/offcanvas.js"></script></div><div id="divtop"></div><div class="site_container site_toc_closed"><div class="page_container"><div class="content_frame"><div id="content_container" class="content_container"><section id="doc_center_content"><div class="function_ref"><div itemprop="content"><h1 itemprop="title">avasms</h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">avasms computes avas using a series of alternative options</p><div class="switch"><a id="expandAllPage" href="javascript:void(0);">expand all in page</a></div></div></div></div><div class="ref_sect"><h2 id="syntax">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><ul><li><code class="synopsis">BestSol=avasms(y,X)</code><span class="syntax_example"><a class="intrnllnk" href="avasms.html#Example_1">example</a></span></li><li><code class="synopsis">BestSol=avasms(y,X,Name,Value)</code><span class="syntax_example"><a class="intrnllnk" href="avasms.html#Example_2">example</a></span></li><li><code class="synopsis">[BestSol,corMatrix]=avasms(___)</code><span class="syntax_example"><a class="intrnllnk" href="avasms.html#Example_3">example</a></span></li></ul></div></div></div>	<div class="ref_sect" itemprop="content">							<h2 id="Description">Description</h2>							<div class="descriptions">								<div class="description_module"><p><p>This function applies avas with a series of options and produces the
   augmented star plot.</p> <p>

 Below we list the five options giving an informative text description
 followed by the optional input arguments. We also give in parenthesis, the
 abbreviations used in the augmented star plot, where these are different.</p> <p>

 - Robustness (rob).</p> <p>
 - Remove effect of order of explanatory variables by regression (scail).</p> <p>
 - Trapezoidal or rectangular rule for numerical integration in function
   ctsub (trapezoid).</p> <p>
 - Ordering inclusion of the variables in the backfitting algorithm using
   $R^2$ values (orderR2).</p> <p>
 - Initial robust transformation of the response (tyinitial).</p> <p>

 We reduce the number of analyses for investigation by removing all those
 for which the residuals fail the Durbin-Watson and Jarque-Bera tests, at
 the 10 per cent level (two-sided for Durbin-Watson). Unlike the
 Durbin-Watson test, the Jarque-Bera test uses a combination of estimated
 skewness and kurtosis to test for distributional shape of the residuals.</p> <p>
 Note that this threshold of 10 per cent can be changed using optional
 input argument critBestSol.</p> <p>

 We order the solutions by the Durbin-Watson significance level multiplied
 by the value of $R^2$ and by the number of units not declared as
 outliers. The rays in individual plots are of equal length for those
 features used in an analysis. All rays are in identical places in each
 plot. Information in the plot is augmented by making the length of the
 rays for each analysis reflect the properties of the analysis; they are
 proportional to $p_{DW}$, the significance level of the Durbin-Watson
 test. Note that the ordering in which the solutions are displayed in the
 plot can be changed using optional input argument SolutionOrdering.</p> <p>

 The five options start on the right and wind counterclockwise in steps of
 72 degrees around the circle. The ordering in which the five options are
 displayed in the plot depends on the frequency of presence among the set
 of the admissible solutions. For example, if robustness is the one who
 has the highest frequency, its spoke is shown on the right (plotted to
 the East). The second most present option is shown on the top right...</p><p>
 and the least present option is shown on the bottom right.</p></p><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="avasms.html#Example_1">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_BestSol"><code>BestSol</code></a>=avasms(<a class="intrnllnk" href="#inputarg_y"><code>y</code></a>,<a class="intrnllnk" href="#inputarg_X"><code>X</code></a>)</code></span>Example 2 in RAC (2022).</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="avasms.html#Example_2">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_BestSol"><code>BestSol</code></a>=avasms(<a class="intrnllnk" href="#inputarg_y"><code>y</code></a>,<a class="intrnllnk" href="#inputarg_X"><code>X</code></a>,<a class="intrnllnk" href="#namevaluepairarguments"><code>Name, Value</code></a>)</code></span>Wang and Murphy data.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="avasms.html#Example_3">	example</a></p>	<p><span itemprop="syntax"><code>[<a class="intrnllnk" href="#outputarg_BestSol"><code>BestSol</code></a>,<a class="intrnllnk" href="#outputarg_corMatrix"><code>corMatrix</code></a>]=avasms(___)</code></span>Example of the use of avasms using the Fish data.</p></div>								</div>							</div>							<div class="clear">							</div>						</div><div class="ref_sect" itemprop="content"><div class="examples"><h2 id="Examples">Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="example_1" class="example_module expandableContent"><div id="Example_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Example 2 in RAC (2022).</li></span></a></span></h3><div class="collapse"><p>
     There are four explanatory variables and 151 observations with $x_1 $
     equally spaced from 0:0.1:15. The linear model is:
     
     \[
     z = \text{sin}(x) + \sum_{j=2}^4 (j-1)x_j + 0.5\mathcal{U}(-0.5,0.5), 
     \]
      where $x_{ij} (j=2, \ldots, 4),$ are independently $\mathcal{N}(0,1).$
      Eight outliers of value one replace the values of $z$ at $x = 8.9, 9.9,
      10.4, 10.5  ... 10.9$. The response $y = \exp z$. There are thus four
      explanatory variables, only one of which requires transformation, as
      does the response to log$y$.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">rng(100)
x1 = (0:0.1:15)';
n=length(x1);
X3=randn(n,3);
Xb=X3*(1:3)';
z = sin(x1) + 0.5*(rand(size(x1))-0.5)+Xb;
z([90,100,105:110]) = 1;
X=[x1 X3];
y=exp(z);
% Automatic model selection
[BestSol,corMatrix]=avasms(y,X);</pre></div></div><pre class="codeoutput">No model found with pvalDW&gt;0.1 and pvalJB&gt;0.1
Setting pvalDW=0.05 and pvalJB=0.05
</pre><a href='http://rosa.unipr.it/fsda/avasms.html#Example_1'><img vspace="5" hspace="5" src="images\avasms_01.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website). Graphical output could not be included in the installation file because toolboxes cannot be greater than 20MB. To load locally the image files, download zip file http://rosa.unipr.it/fsda/images.zip and unzip it to <tt>(docroot)/FSDA/images</tt> or simply run routine <tt>downloadGraphicalOutput.m</tt>"> <img vspace="5" hspace="5" src="images\avasms_02.png" alt=""> </a></p></div></div><div id="example_2" class="example_module expandableContent"><div id="Example_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Wang and Murphy data.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">rng('default')
seed=100;
negstate=-30;
n=200;
X1 = mtR(n,0,seed)*2-1;
X2 = mtR(n,0,negstate)*2-1;
X3 = mtR(n,0,negstate)*2-1;
X4 = mtR(n,0,negstate)*2-1;
res=mtR(n,1,negstate);
% Generate y
y = log(4 + sin(3*X1) + abs(X2) + X3.^2 + X4 + .1*res );
X = [X1 X2 X3 X4];
y([121 80 34 188 137 110 79 86 1])=1.9+randn(9,1)*0.01;
[BestSol,corMatrix]=avasms(y,X);</pre></div></div><a href='http://rosa.unipr.it/fsda/avasms.html#Example_2'><img vspace="5" hspace="5" src="images\avasms_03.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website). Graphical output could not be included in the installation file because toolboxes cannot be greater than 20MB. To load locally the image files, download zip file http://rosa.unipr.it/fsda/images.zip and unzip it to <tt>(docroot)/FSDA/images</tt> or simply run routine <tt>downloadGraphicalOutput.m</tt>"> <img vspace="5" hspace="5" src="images\avasms_04.png" alt=""> </a></p></div></div><div id="example_3" class="example_module expandableContent"><div id="Example_3"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Example of the use of avasms using the Fish data.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">load("fish.mat");
Y=fish;
% pike is removed. We use just the first 3 explanatory variables.
sel=categorical(Y{:,1})~='Pike';
y=Y{sel,2};
X=Y{sel,3:5};
[BestSol,corMatrix]=avasms(y,X,'l',3*ones(size(X,2),1));</pre></div></div><a href='http://rosa.unipr.it/fsda/avasms.html#Example_3'><img vspace="5" hspace="5" src="images\avasms_05.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website). Graphical output could not be included in the installation file because toolboxes cannot be greater than 20MB. To load locally the image files, download zip file http://rosa.unipr.it/fsda/images.zip and unzip it to <tt>(docroot)/FSDA/images</tt> or simply run routine <tt>downloadGraphicalOutput.m</tt>"> <img vspace="5" hspace="5" src="images\avasms_06.png" alt=""> <img vspace="5" hspace="5" src="images\avasms_07.png" alt=""> </a></p></div></div></div><p> </p><div class="examples"><h2 id="ExtraExamples" class="bottom_ruled">Related Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="Extraexample_1" class="example_module expandableContent"><div id="ExtraExample_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Example of use of option critBestSol with marketing data.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">load("Marketing_Data.mat")
Y=Marketing_Data;
y=Y{:,4};
X=Y{:,1:3};
% In this case the admissible solutions are defined as those which have a
% p-value of DW test and a p-value of JB test greater than 0.001
critBestSol=0.001;
% Note that if a different threshold for the two p-values is needed we have
% to define critBestSol as a struct as follows
%  critBestSol=struct;
%  critBestSol.pvalDW=0.0001;
%  critBestSol.pvalJB=0.001;
% In this example it makes sense to force a monotonic transformation for the
% 3 explanatory variables
out=avasms(y,X,'l',ones(3,1),'critBestSol',critBestSol);</pre></div></div></p></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="Inputs">Input Arguments</h2><div class="expandableContent"><div class="arguments"><div class="input_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"> <div id="inputarg_y" class="clearfix"> </div> <h3 id="input_argument_y" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>y</code> &#8212; Response variable. </span>  </a><span class="example_desc">Vector.</span></span></h3> <div class="collapse"> <p><p>Response variable, specified as
               a vector of length n, where n is the number of
               observations. Each entry in y is the response for the
               corresponding row of X.</p> <p>
               Missing values (NaN's) and infinite values (Inf's) are
               allowed, since observations (rows) with missing or infinite
               values will automatically be excluded from the
               computations.</p></p> <p class="datatypelist"><strong> Data Types: </strong><code>single| double</code></p> </div> </div><div class="expandableContent"> <div id="inputarg_X" class="clearfix"> </div> <h3 id="input_argument_X" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>X</code> &#8212; Predictor variables. </span>  </a><span class="example_desc">Matrix.</span></span></h3> <div class="collapse"> <p><p>Matrix of explanatory
               variables (also called 'regressors') of dimension n x (p-1)
               where p denotes the number of explanatory variables
               including the intercept.</p> <p>
               Rows of X represent observations, and columns represent
               variables. By default, there is a constant term in the
               model, unless you explicitly remove it using input option
               intercept, so do not include a column of 1s in X. Missing
               values (NaN's) and infinite values (Inf's) are allowed,
               since observations (rows) with missing or infinite values
               will automatically be excluded from the computations.</p></p> <p class="datatypelist"><strong> Data Types: </strong><code>single| double</code></p> </div> </div><div id="namevaluepairarguments" class="clearfix"></div><h3 id="NameValuePairs" class="bottom_ruled">Name-Value Pair Arguments</h3><div class="namevaluecontainer"><p>Specify optional comma-separated pairs of <code>Name,Value</code> arguments. <code>Name</code> is the argument name and <code>Value</code> is the corresponding value. <code>Name</code> must appear  inside single quotes (<code>' '</code>).  You can specify several name and value pair arguments in any order as <code>  Name1,Value1,...,NameN,ValueN</code>.</p>  <span class="example_desc"><strong>Example:</strong><code><code> 'critBestSol',0.001
</code>,<code> 'delrsq',0.001
</code>,<code> 'l',[3 3 1]
</code>,<code> 'maxit',30
</code>,<code> 'nterm',5
</code>,<code> solOrdering,["R2" "pvalJB"]
</code>,<code> 'w',1:n
</code>,<code> 'plots',true
</code></code></span></div><div class="expandableContent"><div id="inputarg_critBestSol" class="clearfix"></div><h3 id="input_argument_namevalue_critBestSol" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>critBestSol</code> &#8212;criterion to define the admissible solutions to retain.</span></a><span class="example_desc">scalar | struct.</span></span></h3><div class="collapse">	<p><p>The default value of critBestSol is
                0.10, 
                that is solutions are retained if the associated residuals pass
                the Durbin-Watson and Jarque-Bera tests, at the 10 per
                cent level. For example if critBestSol is 0.01, solutions
                are retained if the associated residuals pass the
                Durbin-Watson and Jarque-Bera tests, at the 1 per cent
                level. If critBestSol is a scalar the p-value threshold is
                the same both for Durbin-Watson and Jarque-Bera tests. On
                the other hand, if critBestSol is a struct it is possible
                to use a different p-value threshold for each test. If
                critBestSol is a struct it may contain the following
                fields:</p> <p>
                critBestSol.pvalDW=threshold for the p-value of Durbin
                Watson test (if this field is not present default is
                critBestSol.pvalDW=0.10).</p> <p>
                critBestSol.pvalJB=threshold for the p-value of Jarque-Bera
                test (if this field is not present default is
                critBestSol.pvalJB=0.10).</p><p>
           </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'critBestSol',0.001
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double or struct.</code></p></div></div><div class="expandableContent"><div id="inputarg_delrsq" class="clearfix"></div><h3 id="input_argument_namevalue_delrsq" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>delrsq</code> &#8212;termination threshold.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>Iteration (in the outer loop)
            stops when rsq changes less than delrsq in nterm. The default
            value of delrsq is 0.01.</p> <p>
           </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'delrsq',0.001
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_l" class="clearfix"></div><h3 id="input_argument_namevalue_l" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>l</code> &#8212;type of transformation.</span></a><span class="example_desc">vector.</span></span></h3><div class="collapse">	<p><p>Vector of length p which
           specifies the type of transformation for the explanatory
           variables.</p> <p>
           l(j)=1 =&gt; j-th variable assumes orderable values and any
                   transformation (also non monotone) is allowed.</p> <p>
           l(j)=2 =&gt; j-th variable assumes circular (periodic) values
                 in the range (0.0,1.0) with period 1.0.</p> <p>
           l(j)=3 =&gt; j-th variable transformation is to be monotone.</p> <p>
           l(j)=4 =&gt; j-th variable transformation is to be linear.</p> <p>
           l(j)=5 =&gt; j-th variable assumes categorical (unorderable) values.</p> <p>
           j =1, 2,..., p.</p> <p>
           The default value of l is a vector of ones of length p,
           that is the procedure assumes that all the explanatory
           variables have orderable values (and therefore can be
           transformed non monotonically).</p> <p>
           Note that in avas procedure the response is always transformed
           (in a monothonic way).</p><p>
           </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'l',[3 3 1]
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_maxit" class="clearfix"></div><h3 id="input_argument_namevalue_maxit" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>maxit</code> &#8212;maximum number of iterations for the outer loop.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>The
            default maximum number of iterations before exiting the outer
            loop is 20.</p> <p>
           </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'maxit',30
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_nterm" class="clearfix"></div><h3 id="input_argument_namevalue_nterm" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>nterm</code> &#8212;minimum number of consecutive iterations below the threshold
           to terminate the outer loop.</span></a><span class="example_desc">positive scalar.</span></span></h3><div class="collapse">	<p><p>This value
           specifies how many consecutive iterations below the threshold
           it is necessary to have to declare convergence in the outer
           loop. The default value of nterm is 3.</p> <p>
           </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'nterm',5
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_solOrdering" class="clearfix"></div><h3 id="input_argument_namevalue_solOrdering" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>solOrdering</code> &#8212;criterion to order the solutions in the augmented
               star plot.</span></a><span class="example_desc">cell array of characters | array of strings.</span></span></h3><div class="collapse">	<p><p>The
               elements of the cell are the names of columns 6-9 of the table
               in output argument BestSol. More precisely, these names are
               "R2" "pvalDW" "pvalJB" "nused". For example, if
               solOrdering=["R2" "pvalDW"] or solOrdering={'R2' 'pvalDW'},
               the ordering of the solutions is based on the product
               between the values of R2 and that of the p-value of DW
               test. If this optional input argument is not specified or
               it is empty, the default is to use solOrdering=["R2"
               "pvalDW" "nused"], that is the product of the p-value of
               Durbin Watson test, the value of R2 and the number of units
               which have not been declared as outliers.</p> <p>
           </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> solOrdering,["R2" "pvalJB"]
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>Cell array of characters or array of strings</code></p></div></div><div class="expandableContent"><div id="inputarg_w" class="clearfix"></div><h3 id="input_argument_namevalue_w" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>w</code> &#8212;weights for the observations.</span></a><span class="example_desc">vector.</span></span></h3><div class="collapse">	<p><p>Row or column vector of
           length n containing the weights associated to each
           observations. If w is not specified we assume $w=1$ for $i=1,
           2, \ldots, n$.</p> <p>
           </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'w',1:n
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_plots" class="clearfix"></div><h3 id="input_argument_namevalue_plots" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>plots</code> &#8212;plots on the screen.</span></a><span class="example_desc">boolean.</span></span></h3><div class="collapse">	<p><p>If plots is true it is possible
           to visualize on the screen the augmented star plot and the
           heatmap associated to the correlation among the admissible
           solutions. The default value of plots is false, that is no plot
           is shown on the screen.</p> <p> 
           </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'plots',true
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>Logical</code></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="OutputArgs" >Output Arguments</h2><div class="expandableContent"><div class="arguments"><div class="output_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"><div id="outputarg_BestSol" class="clearfix"></div><h3 id="output_argument_BestSol" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>BestSol</code> &#8212;Best solutions.</span></a><span class="example_desc">table</span></span></h3><div class="collapse"><p><p>
                 A table containing the details of the admissible
                 solutions which have been found. We define a solution as
                 admissible if the residuals pass the Durbin-Watson and
                 Jarque-Bera tests, at the 10 per cent level.</p> <p>
                 If no solution is found, than a 5 per cent threshold for both
                 tests is used.</p> <p>
                 Note that in input option critBestSol it is possible to
                 set up different thresholds to define the admissible
                 solutions.</p> <p>
                 The rows of BestSol are ordered in a non increasing way
                 using the p-value of the Durbin Watson test (rescaled by
                 the value of $R^22$ and the number of units not declared as
                 outliers).</p> <p>
                 Colums 1-5 contain boolean information about the usage of
                 options: orderR2, scail, trapezoid, rob,
                 tyinitial. These 5 columns are ordered in non decreasing
                 way depending on the frequency in which a particular
                 option has been used in the set of admissiable solutions.</p> <p>
                 For example, if option orderR2 is the only one
                 which is always used in the set of admissible solutions,
                 then column 1 is associated to orderR2.</p> <p>
                 6th column contains the value of R2 (column name R2).</p> <p>
                 7th column contains the p-value of Durbin Watson
                 test (column name pvalDW).</p> <p>
                 8th column contains the p-value of Jarque Bera test
                 (column name pvalJB).</p> <p>
                 9th column contains the number of units which have not
                 been declared as outliers (column name nused).</p> <p>
                 10th column is a cell which contains the residuals for
                 the associated solution.</p> <p>
                 11th column contains the struct out which is the
                 output of the call to avas.</p><p>
                 12th column contains the numbers obtained by the product
                 of p-value of Durbin Watson test, the values of $R^2$ and
                 the number of units which have not been declared as
                 outliers. The values of this column depend on the
                 optional input argument solOrdering.</p></p></div></div><div class="expandableContent"><div id="outputarg_corMatrix" class="clearfix"></div><h3 id="output_argument_corMatrix" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>corMatrix</code> &#8212;Correlation matrix.</span></a><span class="example_desc"><code> Correlation </code>matrix among the
                 residuals associated to the admissible solutions which
                 have been found</span></span></h3><div class="collapse"><p> The size of CorMatrix is
                 size(BestSol,1)-times-size(BestSol,1).</p></div></div></div></div></div></div><div class="moreabout ref_sect"><h2 id="MoreAbout">More About</h2><div class="expandableContent"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent" itemprop="content"><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span>Additional Details</span></a></span></h3><div class="expand"><p><p>
 Routine avas, (additivity and variance stabilization) provides
 non-parametric alternatives to the widely used Box-Cox parametric
 transformation of the response and the Box-Tidwell family of power
 transformations of explanatory variables. In routine avas it is possible:</p> <p>
<hr>[<b>1</b>] To use option rob in order to replace standard OLS regression with
 robust regression in all steps of the iterative procedure. More precisely
 using robust regression we identify a subset $S_m$ of clean observations
 to use in the backfitting algorithm to calculate the transformations
 $f(X)$ at each iteration, the $n-m$ outliers being ignored. We also use
 the subset in function ctsub in the calculation of the numerical variance
 stabilising transformation. Since different response transformations can
 indicate different observations as outliers, the identification of
 outliers occurs repeatedly during our robust algorithm, once per
 iteration.</p> <p>
<hr>[<b>2</b>] To use option scail in order to linearly transform the explanatory
 variables in order to let each column of matrix X have the same weight
 when predicting g(y).</p> <p>
<hr>[<b>3</b>] To use option orderR2 to completely eliminate dependence on
 the order of the variables. That is, in each iteration of the backfitting
 algorithm we impose an ordering which is based on the variable which
 produces the highest increment of $R^2$.</p> <p>
<hr>[<b>4</b>] To use option tyinitial which calculates a robust parametric
 transformation of the response before starting the main backfitting loop.</p> <p>
<hr>[<b>5</b>] To use option trapeziod in order to specify how to compute the
 integral to obtain transformed values for the units which fall outside
 the range of integration determined by the units not declared as
 outliers.</p> <p>

 The purpose of this routine is to apply avas with and without the five
 options listed above. There are therefore 32 combinations of options that
 could be chosen. It is not obvious that all will be necessary when
 analysing all sets of data. This routine returns the list of options
 which produced the best fit and provides the necessary ingredients for a
 graphical method, the augmented star plot, to indicate which options are
 important in a particular data analysis.</p><p>

</p><hr></p></div></div></div></div><div class="ref_sect" itemprop="content"><div class="bibliography"><h2 id="References">References</h2> <div><p>Riani M., Atkinson A.C. and Corbellini A. (2022), Robust Transformations
 for Multiple Regression via Additivity and Variance Stabilization,
 submitted.</p></div><div><p>Tibshirani R. (1987), Estimating optimal transformations for regression,
 "Journal of the American Statistical Association", Vol. 83, 394-405.</p></div><div><p>Wang D.  and Murphy M. (2005), Identifying nonlinear relationships
 regression using the ACE algorithm, "Journal of Applied Statistics",
 Vol. 32, pp. 243-258.</p></div></div></div><div class="ref_sect"><h2 id="SeeAlso">See Also</h2><p><span itemprop="seealso"><a href="avas.html" itemprop="url"><span itemprop="name"><code>avas</code></span></a></span> | <span itemprop="seealso"><a href="ace.html" itemprop="url"><span itemprop="name"><code>ace</code></span></a></span> | <span itemprop="seealso"><a href="aceplot.html" itemprop="url"><span itemprop="name"><code>aceplot</code></span></a></span> | <span itemprop="seealso"><a href="smothr.html" itemprop="url"><span itemprop="name"><code>smothr</code></span></a></span> | <span itemprop="seealso"><a href="supsmu.html" itemprop="url"><span itemprop="name"><code>supsmu</code></span></a></span> | <span itemprop="seealso"><a href="ctsub.html" itemprop="url"><span itemprop="name"><code>ctsub</code></span></a></span></div><i>This page has been automatically generated by our routine <a href="publishFS.html">publishFS</a></i></div></section></div></div></div></div><div id="divbottom"></div></body></html>