<html>
<head>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <title>GetOmegaMap :: Functions (Flexible Statistics Data Analysis
  Toolbox™)</title>
  <link href="docstyle.css" rel="stylesheet" type="text/css">
  <meta content="refpage" name="chunktype">
  <meta content="function:FSM" name="refentity">
  <meta content="text/javascript" http-equiv="Content-Script-Type">
  <meta content="fcn" name="toctype">
  <script type="text/javascript" language="javaScript" src="bottom.js">
 </script>
  <style type="text/css">
  .auto-style1 {
          margin-bottom: 0px;
  }
  </style>
</head>

<body>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<!--FScategory:Clustering-->
<a name="top_of_page"></a> 

<p style="font-size: 1px;"> </p>

<table border="0" cellpadding="0" cellspacing="0" class="nav"
summary="Navigation aid" width="100%">
  <tbody>
    <tr>
      <td valign="baseline"><b>Flexible Statistics Data Analysis
      Toolbox™</b></td>
      <td align="right" valign="baseline"><a href="fsrms.html"><img
        align="bottom" alt="fanplot" border="0"
        src="images_help/b_prev.gif"></a>   <a href="ginputfs.html"><img
        align="bottom" alt="FSMeda" border="0"
      src="images_help/b_next.gif"></a></td>
    </tr>
  </tbody>
</table>


<h1 class="reftitle">GetOmegaMap</h1>

<p class="purpose">Calculates the map of misclassificaton between groups </p>

<h2>Syntax </h2>

<p class="synopsis"><tt>[OmegaMap, BarOmega, MaxOmega, rcMax] = GetOmegaMap(c,
v, k, li, di, const1, fix, tol, lim, asympt)<br>
[OmegaMap, BarOmega, MaxOmega, rcMax] = GetOmegaMap(c, v, k, li, di, const1,
fix, tol, lim, asympt, toll)<br>
</tt></p>
<a name="f4811966"></a> 

<h2>Description </h2>

<p>Background: Given two generic clusters i and j with  i ≠  j =1, ..., k,
indexed by φ(x; μ<sub>i</sub>,Σ<sub>i</sub>) and φ(x;
μ<sub>j</sub>,Σ<sub>j</sub>) with probabilities of occurrence π<sub>i</sub>
and π<sub>j</sub> , the misclassification probability with respect to cluster
i, (that is conditionally on x belonging to cluster i,  which is called
w<sub>j|i</sub>) is defined as Pr[π<sub>i</sub>  φ(x;
μ<sub>i</sub>,Σ<sub>i</sub>) &lt; π<sub>j</sub>  φ(x;
μ<sub>j</sub>,Σ<sub>j</sub>)]. The matrix containing the misclassification
probabilities w<sub>j|i</sub> is called <a href="#OmegaMap">OmegaMap</a>. The
probability of overlapping, defined as a sum of two misclassification
probabilities, measures the degree of interaction between components and can be
readily employed to control the clustering complexity of datasets simulated
from mixtures. These datasets can then be used for systematic performance
investigation of clustering and finite mixture modeling algorithms. </p>
<p>More
specifically, the probability of overlapping between groups i and j (called
p<sub>ij</sub>) is given by p<sub>ij </sub>=p<sub>ji </sub>= w<sub>j|i</sub> +
w<sub>i|j</sub> = OmegaMap(i,j)+OmegaMap(j,i),  i,j=1,2, ..., k. The diagonal
elements of OmegaMap are (by definition) set equal to 1. The average overlap
(which in the code below  is called <a href="#BarOmega">BarOmega</a>) is
defined as the sum of the off diagonal elements of OmegaMap (Σ<sub>i &gt;
j=1,2, ..., k</sub> p<sub>ij </sub>) divided by k(k-1)/2. The maximum overlap
(which in the code below is called <a href="#MaxOmega">MaxOmega</a>) is defined
as max(w<sub>j|i</sub> + w<sub>i|j</sub> ) = max p<sub>ij </sub> i ≠ j=1,2,
..., k. The standard deviation of overlap (which in the code is called <a
href="#StdOmega">StdOmega</a>) is the standard deviation of the k(k-1)/2
elements  p<sub>ij</sub>. </p>
<p>The probability of misclassification w<sub>j|i</sub>
(w<sub>i|j</sub>) is nothing but the cdf of a linear combination of non central
Χ<sup>2</sup> distributions with 1 degree of freedom + a linear combination of
N(0,1) evaluated in a point c. The coefficients of the linear combinations of
non central Χ<sup>2</sup> and N(0,1) depend on the eigenvalues and
eigenvectors of matrix Σ<sub>j|i</sub> = Σ<sup>0.5</sup><sub>i</sub>
Σ<sup>-1</sup><sub>j </sub>Σ<sup>0.5</sup><sub>i</sub>. Point c depends on
the same eigenvalues and eigenvectors of matrix Σ<sub>j|i</sub>, the mixing
proportions  π<sub>i</sub> and π<sub>j </sub>and the determinants
|Σ<sub>i</sub>| and |Σ<sub>j</sub>|. This probability is computed using
routine <a href="ncx2mixtcdf.html">ncx2mixtcdf</a>.</p>

<p>GetOmegaMap admits the following inputs</p>

<p> </p>

<table cellspacing="0" class="body" cellpadding="4" border="2">
  <colgroup><col width="29%">
    <col width="71%">
  </colgroup>
  <tbody>
    <tr valign="top">
      <td><p class="auto-style1"><tt>c</tt></p>
      </td>
      <td>scalar, inflation parameter for covariance matrices. In the case of
        heterogeneous clusters, scalar c is used to correct li(i,j) and
        const1(i,j). <br>
        More precisely when hom=0: <br>
        if fix(i)=0 di(i,j,:)=di(i,j,:)/c<sup>0.5</sup> (because di(i,j,:)=Γ
        (c Σ<sub>i</sub>)<sup>-0.5</sup>(μ<sub>i</sub>-μ<sub>j</sub>) where
        Γ is the matrix of eigenvectors of  Σ<sub>j|i</sub> =
        Σ<sup>0.5</sup><sub>i</sub> Σ<sup>-1</sup><sub>j
        </sub>Σ<sup>0.5</sup><sub>i</sub>.) <br>
        if fix(i)=0 and fix(j)=1 li(i,j,:)=c li(i,j,:), <br>
        const1(i,j)=const1(i,j)+v log(c) (because the eigenvalues of matrix
        Σ<sub>j|i</sub> = (c<sup>0.5</sup> Σ<sub>i</sub><sup>0.5</sup>)
        Σ<sub>j</sub><sup>-1</sup> (c<sup>0.5</sup>
        Σ<sub>i</sub><sup>0.5</sup>) are multiplied by c. Similarly log
        |cΣ<sub>i</sub>|= c*log(v) + log |Σ<sub>i</sub>| <br>
        if fix(i)=0 and fix(j)=0 li and const1 are not changed because
        Σ<sub>j|i</sub>=(c<sup>0.5</sup> Σ<sub>i</sub><sup>0.5</sup>) (c
        Σ<sub>j</sub>) <sup>-1</sup> (c<sup>0.5</sup>
        Σ<sub>i</sub><sup>0.5</sup>) const1(i,j)=log((Pi(j)/Pi(i))^2 * c
        detS(i)/(c detS(j))) remain unaltered. Following the symbolism at the
        beginning of Section 'Description', the last term can be reformulated
        as follows: const1(i,j)=log((π<sub>j</sub>/π<sub>i</sub>)<sup>2</sup>
        * c |Σ<sub>i</sub>|/|(c Σ<sub>j</sub>)|).</td>
    </tr>
    <tr valign="top">
      <td><p><tt>v</tt></p>
      </td>
      <td><p>scalar, dimensionality (number of variables)</p>
      </td>
    </tr>
    <tr>
      <td><p><tt>k</tt></p>
      </td>
      <td><p>scalar, number of components (groups)</p>
      </td>
    </tr>
  </tbody>
</table>

<p>li, di and const1 are the parameters needed for computing overlap</p>

<table cellspacing="0" class="body" cellpadding="4" border="2">
  <colgroup><col width="29%">
    <col width="71%">
  </colgroup>
  <tbody>
    <tr>
      <td><p><tt>li</tt></p>
      </td>
      <td><p>3D array of size k-by-k-by-v. li(i,j,:) is the vector which
        contains the eigenvalues of matrix Σ<sub>j|i</sub> =
        Σ<sup>0.5</sup><sub>i</sub> Σ<sup>-1</sup><sub>j
        </sub>Σ<sup>0.5</sup><sub>i</sub> . Remark: li(i,j,:)-1 are the
        coefficients of the linear combinations of non central chi^2
        distribution which is used to compute the probability of overlapping.
        The non centrality parameter of the non central chi^2 distribution
        associated with li(i,j,l)-1 is (li(i,j,l)
        di(i,j,l)/(li(i,j,l)-1))<sup>2</sup></p>
      </td>
    </tr>
    <tr>
      <td><p><tt>di</tt></p>
      </td>
      <td><p>3D array of size k-by-k-by-v di(i,j,l)=γ<sub>l</sub> '
        Σ<sub>i</sub><sup>-0.5</sup>(μ<sub>i</sub>-μ<sub>j</sub>) l=1, 2,
        ...,v, where γ<sub>l</sub> is the l-th eigenvector coming from the
        spectral decomposition of matrix Σ<sub>j|i</sub>. Vector di(i,j,:)
        contains the coefficients of N(0,1) (called W<sub>l</sub> in equation
        2.2 of Maitra and Melnikov (2010), JCGS)</p>
      </td>
    </tr>
    <tr valign="top">
      <td><p><tt>const1</tt></p>
      </td>
      <td><p>k-by-k matrix whise element i,j with i=1,..., k and j=1, ..., k is
        equal to log((Pi(j)/Pi(i))^2 * detS(i)/detS(j)) where detS(i) and
        detS(j) are, respectively, the determinants of the covariance matrices
        of groups i and j. See equation (2.2) of Maitra and Melnikov (2010),
        JCGS Note that const1(j,i)=-const1(i,j). The elements on the diagonal
        of matrix const1 are set to 0 (in other words they are not
        computed).</p>
      </td>
    </tr>
  </tbody>
</table>

<p>Vector fix specifies which are the groups whose covariance matrix has to be
multiplied by c.</p>

<table cellspacing="0" class="body" cellpadding="4" border="2">
  <colgroup><col width="29%">
    <col width="71%">
  </colgroup>
  <tbody>
    <tr>
      <td style="width: 349px"><p><tt>fix</tt></p>
      </td>
      <td><p>vector of length k containing zeros or ones.<br>
        if fix(j) =1 cluster j does not participate to inflation or deflation.
        If fix=zeros(k,1) all clusters participate in inflation/deflation. <br>
        REMARK: this parameter is used just if heterogeneous clusters are
        used.</p>
      </td>
    </tr>
  </tbody>
</table>

<p>Parameters tol and lim will be used by function <a
href="ncx2mixtcdf.html">ncx2mixtcdf</a> which computes the cdf of a linear
combination of non central chi2 r.v.. This is the probability of
misclassification</p>

<table cellspacing="0" class="body" cellpadding="4" border="2">
  <colgroup><col width="29%">
    <col width="71%">
  </colgroup>
  <tbody>
    <tr>
      <td style="width: 339px"><p><tt>tol</tt></p>
      </td>
      <td><p>scalar. Error bound for overlap computation default is 1e-06</p>
      </td>
    </tr>
    <tr>
      <td style="width: 339px"><p><tt>lim</tt></p>
      </td>
      <td><p>maximum number of integration terms default is 1e06.</p>
      </td>
    </tr>
  </tbody>
</table>

<p>asympt is a flag for regular or asymptotic overlap</p>

<table cellspacing="0" class="body" cellpadding="4" border="2">
  <colgroup><col width="29%">
    <col width="71%">
  </colgroup>
  <tbody>
    <tr>
      <td style="width: 349px"><p><tt>asympt</tt></p>
      </td>
      <td><p>If asympt ==1 formula of asymptotic overlap is used (see p. 359,
        paragraph starting with step 3 of Maitra and Melnikov, 2010, JCGS). <br>
        More precisely,  if  clusters i and j have different covariance
        matrices  the misclassification probability w<sub>j|i</sub> (that is
        with respect to the centroid and covariance matrix of group i) is given
        by Σ<sub>l=1</sub><sup>v</sup> (λ<sub>l</sub>-1)
        Χ<sup>2</sup><sub>1</sub> ≤  log π<sub>j</sub><sup>2</sup>
        |Σ<sub>j</sub>| / π<sub>i</sub><sup>2</sup> |Σ<sub>i</sub>| where
        Χ<sup>2</sup><sub>1 </sub> are central Χ<sup>2 </sup>with one degree
        of freedom and λ<sub>l</sub> are the eigenvalues of matrix
        Σ<sub>j|i</sub>. The sum is in correspondence of the eigenvalues which
        are not equal 1.</p>

        <p>If, on the other hand, clusters i and j have the same covariance
        matrix </p>
	  <p>w<sub>j|i</sub>=  &Phi;(-0.5&nbsp; (Σ<sub>l=1</sub><sup>v</sup> &delta;<sub>l</sub>)<sup>0.5</sup> +log π<sub>j</sub> / π<sub>i </sub>&nbsp;/ 
	  (Σ<sub>l=1</sub><sup>v</sup> &delta;<sub>l</sub>)<sup>0.5</sup> )where </p>
	  <p>&nbsp;&delta;<sub>l</sub>=di(i,j,l)=γ<sub>l</sub> '
        Σ<sub>i</sub><sup>-0.5</sup>(μ<sub>i</sub>-μ<sub>j</sub>),&nbsp;&nbsp; 
	  l=1, 2, ..., v.</p>

        <p>Note that parameter asympt is set to 1 in the preliminary phase just
        to check whether the requested average or  maximum or standard
        deviation of overlap can be reached.</p>
      </td>
    </tr>
  </tbody>
</table>

<p>Background: the probability of overlapping is the result of two sums. The
first is a sum in correspondence of the eigenvalues of matrix  Σ<sub>j|i
</sub>not equal 1. The second is a sum in correspondence of the eigenvalues of
matrix  Σ<sub>j|i </sub> equal 1. Similarly, what is on the right hand side
of the probability of overlapping has two sums (for eigenvalues equal or
different from 1). Optional parameter toll specifies when we must consider an
eigenvalue equal to 1.</p>

<table cellspacing="0" class="body" cellpadding="4" border="2">
  <colgroup><col width="29%">
    <col width="71%">
  </colgroup>
  <tbody>
    <tr>
      <td style="width: 349px"><p><tt>toll</tt></p>
      </td>
      <td><p>scalar, tolerance use to declare the eigenvalues of matrix
        Σ<sub>j|i </sub> equal to 1. The default value is 1e-06</p>
      </td>
    </tr>
  </tbody>
</table>

<p><tt>[OmegaMap, BarOmega, MaxOmega, rcMax] = GetOmegaMap(c, v, k, li, di,
const1, fix, tol, lim, asympt)</tt> returns the following information </p>
<ul type="disc">
  <li><tt><a name="OmegaMap">OmegaMap</a></tt> matrix of misclassification
    probabilities (k-by-k); <br>
    OmegaMap(i,j) = w<sub>j|i</sub> is the probability that X coming from the
    i-th component (group) is classified to the j-th component. </li>
  <li><tt><a name="BarOmega">BarOmega</a></tt> − scalar. Value of average
    overlap. BarOmega is computed as <br>
    (sum(sum(OmegaMap))-k)/(0.5*k(k-1)) </li>
  <li><tt><a name="MaxOmega">MaxOmega</a></tt> − scalar. Value of maximum
    overlap.  MaxOmega is the  maximum of OmegaMap(i,j)+OmegaMap(j,i). In
    other words
    MaxOmega=OmegaMap(rcMax(1),rcMax(2))+OmegaMap(rcMax(2),rcMax(1)).</li>
  <li><p><tt>rcMax</tt> − vector of length 2. It containes the row and column
    numbers associated with the pair of components producing maximum overlap
    'MaxOmega'.</p>
  </li>
</ul>

<h2>Examples</h2>

<p></p>

<h3>Example 1</h3>

<p>Example with 4 groups of which groups 2 and 3 are very well separated.</p>

<p>  </p>
<pre class="programlisting">k=4; % Number of groups
p=5; % Number of dimensions
Pi=[0.1 0.2 0.4 0.3]; % mixing proportions
% Mu matrix of means of size k-by-p; (each row is a distinct centroid)
Mu=randn(k,p);
% Groups 2 and 3 is far from the other groups
Mu(2:3,:)=Mu(2:3,:)+10;
% S= 3D array of dimension p-by-p-by-k containing covariance matrices of the groups
S=zeros(p,p,k);
for j=1:k
  S(:,:,j)=cov(randn(p+10,p));
end
[li, di, const1]=ComputePars(p, k, Pi, Mu, S);
asympt = 0;
c = 1;
fixcl=zeros(k,1);
tol=1e-8;
lim=1e+07;
[OmegaMap, BarOmega, MaxOmega, rcMax] = GetOmegaMap(c, p, k, li, di, const1, fixcl, tol, lim, asympt);
disp('Omegamap= k-by-k matrix which contains misclassification probabilities')
disp(OmegaMap);
disp('Average overlap')
disp(BarOmega)
disp('Maximum overlap')
disp(MaxOmega)
disp('Groups with maximum overlap')
disp(rcMax) 

Output:
&gt;&gt; disp('Omegamap= k-by-k matrix which contains misclassification probabilities')
Omegamap= k-by-k matrix which contains misclassification probabilities
&gt;&gt; disp(OmegaMap);
    1.0000         0         0    0.0442
         0    1.0000    0.2738         0
         0    0.0889    1.0000         0
    0.0267         0         0    1.0000
&gt;&gt; disp('Average overlap')
Average overlap
&gt;&gt; disp(BarOmega)
    0.0723
&gt;&gt; disp('Maximum overlap')
Maximum overlap
&gt;&gt; disp(MaxOmega)
    0.3627
&gt;&gt; disp(rcMax)
     2
     3
</pre>

<p> </p>





<h3>See Also</h3>
<tt><a href="mixsim.html">MixSim</tt></a>,
<a href="simdataset.html">simdataset</tt></a> 


<p></p>

<table border="0" cellpadding="0" cellspacing="0" class="nav"
summary="Navigation aid" width="100%">
  <tbody>
    <tr valign="top">
      <td align="left" width="20"><a href="fsrms.html"><img align="bottom"
        alt="fanplot" border="0" src="images_help/b_prev.gif"></a> </td>
      <td align="left">fsrms.html</td>
      <td> </td>
      <td align="right">ginputfs.html</td>
      <td align="right" width="20"><a href="ginputfs.html"><img align="bottom"
        alt="FSMeda" border="0" src="images_help/b_next.gif"></a></td>
    </tr>
  </tbody>
</table>
<script type="text/javascript" language="javaScript">
document.write(barra);</script>
<!-- Last updated: Fri Jan 23 17:00:05 EST 2009-->
</body>
</html>
