<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<!--FScategory:Robust Regression Analysis and transformations-->

<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>LXS :: Functions (Flexible Statistics Data Analysis Toolbox&trade;â„¢)</title>
<link href="docstyle.css" rel="stylesheet" type="text/css">
<meta content="refpage" name="chunktype">


<script  type="text/javascript" language="javaScript" src="bottom.js"></script>

</head>


<body>

<a name="top_of_page"></a>
<p style="font-size: 1px;">&nbsp;</p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr>
		<td valign="baseline"><b>Flexible Statistics Data Analysis Toolbox&trade;</b></td>
		<td align="right" valign="baseline"><a href="logmvnpdffs.html">
		<img align="bottom" alt="levfwdplot
" border="0" src="images_help/b_prev.gif"></a>&nbsp;&nbsp;
		<a href="mahalfs.html">
		<img align="bottom" alt="minplot" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<a name="bq24of9-1"></a><a class="indexterm" name="zmw57dd0e69698"></a>
<h1 class="reftitle">LXS</h1>
<p class="purpose">Least Median of squares and Least trimmed squares (reweighted)
</p>
<h2>Syntax </h2>
<p class="synopsis">
<tt>
[out] = LXS(y,X)<br>[out] = LXS(y,X,<i><tt>param1</tt></i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)<br>
[out,<i><tt>varargout</tt></i>] = LXS(y,X,...);
</tt>
</p>
<a name="bq24of9-2"></a>
<h2>Description</h2>
<p><tt>[out] = LXS(y,X)</tt> computes the least trimmed squares or least median of squares. 
These are robust estimators which 
have the highest possible break-down point (0.5). In order to reach consistency 
at the normal model the asymptotic consistency factor has been applied. Given that 
these estimators are known to be highly inefficient in order to improve on the 
crude solution it is possible to apply a weighted lest squares based on the 
identification of the outliers given weight 1 (0) to the units whose residual is 
below a certain threshold. The resulting estimators are known in the robust 
statistical literature as &#39;reweighted LMS&#39; or &#39;reweighted LTS&#39;. </p>

<p><tt>y</tt> is a vector of length n containing the response values, while <tt>
X</tt> is the <i>n</i>-by-<i>p</i>-1 matrix which contains (in the columns) the values 
of <i>p</i>-1 predictive terms.

<tt>y</tt> and <tt>X</tt> are optionally returned by the function 
as part of the output structure  <i><tt>out</tt></i> 
if options <i><tt>yxsave</tt></i> is set to 1.
</p>

<p>
If an optional output variable is specified for <tt>varargout</tt>, the matrix of 
the indices of the samples extracted for computing the estimator is returned in that variable.
</p>


<p><tt><a name="bq24of9-3"></a>[out] = LXS(y,X)</tt> returns the following information
</p>
<ul type="disc">
	<li><tt>out</tt> &minus; A structure of additional statistics with the following fields.
	<ul type="circle">
		<li>
		<p><tt>rew</tt> &minus; Scalar if out.rew=1 all subsequent output refers to reweighted 
		else no reweighting is done. </p>
		</li>
		<li>
		<p><tt>beta</tt> &minus; <i>p</i>-by-1 vector of beta LTS (LMS) coefficient estimates, including 
		the intercept when input options <tt>intercept</tt> is equal to 1 or it 
		is missing. <tt>out.beta=[intercept slopes]</tt>.</p>
		</li>
		<li>
		<p><tt>bs</tt> &minus; <i>p</i>-by-1 vector containing the units forming subset associated 
		with beta LMS (beta LTS)</p>
		</li>
		<li>
		<p><tt>residuals</tt> &minus; <i>n</i>-by-1 vector containing the standardized residuals from 
		the robust regression</p>
		</li>
		<li>
		<p><tt>Scale</tt> &minus; Scale estimate of the residuals</p>
		</li>
		<li>
		<p><tt>weights</tt> &minus; <i>n</i>-by-1 Boolean vector containing weights for each observations. 
		                      These weights identify the h observations which are
                      used to compute the final LTS (LMS) estimate.
                      sum(out.weights)=h if there is not a perfect fit
                      otherwise sum(out.weights) can be greater than h
		</p>
		</li>
		<li>
		<p><tt>h</tt> &minus; The number of observations that have determined the LTS 
		(LMS) estimator, i.e. the value of h.</p>
		</li>
		<li>
		<p><tt>outliers</tt> &minus; this output is present only if <tt>conflev</tt> has been specified. 
		It is a vector containing the list of the units declared as outliers using 
		confidence level specified in input scalar <tt>conflev</tt></p>
		</li>
		<li>
		<p><tt>conflev</tt> &minus; confidence level which is used to declare outliers. 
		Remark: scalar out.conflev will be used to draw the horizontal lines (confidence 
		bands) in the plots</p>
		</li>
		<li>
				<p><tt>singsub</tt> &minus;  Number of subsets without full rank. Notice that if
                      this number is greater than 0.1*(number of
                      subsamples) a warning is produced on the screen </p>
		</li>

<li>
<p><tt>y</tt> &minus; Response vector y. The field is present if option yxsave is set to 1. </p>
</li>
 
<li>
<p><tt>X</tt> &minus; Data matrix X. The field is present if option yxsave is set to 1. </p>
</li>



		<li>
		<p><tt>class</tt> &minus; string containing <tt>&#39;LTS&#39;</tt> (or <tt>&#39;LMS&#39;</tt>)</p>
		</li>
	</ul>
	<ul>
		<table border="1" cellpadding="5" cellspacing="0" class="note" summary="Note">
			<tr width="90%">
				<td>
				<p><b>Note</b>&nbsp;&nbsp; LXS automatically includes a 
				constant term in all models. Do not enter a column of 1s directly 
				into <tt>X</tt>.</p>
				</td>
			</tr>
		</table>
	</ul>
	</li>
</ul>
<p></p>
<p><tt>[out] = LXS(y,X,<i><tt>param1</tt></i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)</tt> 
specifies one or more of the name/value pairs described in the following table.</p>
<table border="2" cellpadding="4" cellspacing="0" class="body">
	<colgroup>
		<col width="21%"><col width="79%">
	</colgroup>
	<thead>
		<tr valign="top">
			<th bgcolor="#B2B2B2">Parameter</th>
			<th bgcolor="#B2B2B2">Value</th>
		</tr>
	</thead>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;intercept&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>If 1, a model with constant term will be fitted (default) else no constant 
		term will be included.  </p>
		</td>
	</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;h&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p>The number of observations that have determined the least trimmed squares 
		estimator. <tt>h</tt> is generally an integer greater or equal than <tt>[(n+p+1)/2]</tt> 
		but smaller then <tt>n</tt></p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;alpha&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p> Measures the fraction of outliers the algorithm should
              resist. Any value between 0 and 0.5. Notice that alpha=0
              corresponds to OLS estimation.
              Please specify <em>h </em>or alpha not both.</p>
		</td>
	</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;nsamp&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Number of subsamples which will be extracted to find the robust estimator. 
		If nsamp=0 all subsets will be extracted. They will be <tt>(n choose p)</tt>. 
		Remark: if the number of all possible subset is smaller than 1000 the default 
		is to extract all subsets, otherwise just 1000 if fastLTS is used (<tt>lms</tt>=2) 
		or 3000 for standard LTS or LMS.</p>
		</td>
	</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;lms&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Scalar or structure. 
		
		              If <tt>lms</tt> is a scalar = 1 (default) Least Median of Squares is
                      computed,<br>
              else if <tt>lms</tt> is a scalar = 2 fast lts with the all default options is used <br>

              else if <tt>lms</tt> is a scalar different from 1 and 2 standard lts
                      is used (without concentration steps) <br>

              If <tt>lms</tt> is a struct fast lts (with concentration steps) is used. In this case the user
              can control the following options<br>

                 <tt>lms.refsteps</tt> : scalar defining number of refining iterations in each
                              subsample (default = 3).
                             refsteps = 0 means "raw-subsampling" without iterations.<br>
                  <tt>lms.reftol</tt>  : scalar. Default value of tolerance for the refining steps
                              The default value is 1e-6; <br>
                  <tt>lms.bestr</tt>  : scalar defining number of "best betas" to remember from the
                              subsamples. These will be later iterated until convergence
                              (default=5) <br>
            <tt>lms.refstepsbestr</tt>: scalar defining number of refining iterations for each
                              best subset (default = 50). <br>
             <tt>lms.reftolbestr</tt> : scalar. Default value of tolerance for the refining steps
                              for each of the best subsets
                              The default value is 1e-8; <br>

		
		
		
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;rew&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Scalar. If <tt>rew=1</tt> the reweighted version of LTS (LMS)
              and the output quantities refer to the reweighted version
              else no reweighting is performed (default).</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;conflev&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Scalar between 0 and 1 containing confidence level which is 
              used to declare units as outliers. 
              Usually <tt>conflev=[0.95, 0.975, 0.99]</tt> (individual alpha) 
              or <tt>[1-0.05/n, 1-0.025/n, 1-0.01/n]</tt> (simultaneous alpha).
              Default value is 0.975</p>
		</td>
	</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;plots&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Scalar. If <tt>plots=1</tt> a plot with robust residuals is produced 
		else (default) no plot is produced.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;nocheck&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>Scalar. If <tt>nocheck=1</tt> no check is performed on matrix y and 
		matrix X. Notice that y and X are left unchanged. In other words the additional 
		column of ones for the intercept is not added. As default <tt>nocheck=0</tt>. The controls
              on <tt>h</tt>, <tt>alpha</tt> and <tt>nsamp</tt> still remain.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;msg&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>Scalar which controls whether to display or not messages
              on the screen If <tt>msg=1</tt> (default) messages are displyed
              on the screen about estimated time to compute the estimator
              else no message is displayed on the screen. </p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;nomes&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>Scalar. If <tt>nomes</tt> is equal to 1 no message about estimated time to compute
		LMS is displayed, else if nomes is equal to 0 (default), a message about estimated
		time is displayed.</p>
		</td>
	</tr>
    <tr>
        <td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;yxsave&#39;</tt></td>
        <td bgcolor="#F2F2F2" style="height: 32px">
    <p>
       scalar that is set to 1 to request that the data <tt>y</tt> and <tt>X</tt>
       are saved into the output structure <tt>out</tt>.  
       Default is 0, i.e. no saving is done.
      </p>
    </td>
    </tr>

	</table>
<p></p>
<a name="bq9x7hn"></a><a name="bq5gf2y"></a>
<h3>Examples</h3>
<p>
In these examples we use the same data which have been used 
in the help of function <a href="fsr.html">fsr</a> in order to compare the output of different procedures.
</p>


<pre class="programlisting">
state=100;
randn('state', state);
n=100;
X=randn(n,3);
bet=[3;4;5];
y=3*randn(n,1)+X*bet;
y(1:20)=y(1:20)+13;
</pre>


<p>For outlier detection we consider both the nominal individual 1% significance 
level and the simultaneous Bonferroni confidence level.&nbsp; </p>

<pre class="programlisting">
% Define nominal confidence level
conflev=[0.99,1-0.01/length(y)];
% Define number of subsets 
nsamp=3000;
% Define the main title of the plots
titl='';

% LMS with no rewighting
[outLMS]=LXS(y,X,'nsamp',nsamp,'conflev',conflev(1));
h=subplot(2,2,1)
laby='Scaled LMS residuals'; 
resindexplot(outLMS.residuals,'h',h,'title',titl,'laby',laby,'numlab','','conflev',conflev)

% LTS with no rewighting
h=subplot(2,2,2);
[outLTS]=LXS(y,X,'nsamp',nsamp,'conflev',conflev(1),'lms',0);
laby='Scaled LTS residuals'; 
resindexplot(outLTS.residuals,'h',h,'title',titl,'laby',laby,'numlab','','conflev',conflev);

% LMS with reweighting
[outLMSr]=LXS(y,X,'nsamp',nsamp,'conflev',conflev(1),'rew',1);
h=subplot(2,2,3);
laby='Scaled reweighted LMS residuals'; 
resindexplot(outLMSr.residuals,'h',h,'title',titl,'laby',laby,'numlab','','conflev',conflev)

% LTS with reweighting
[outLTSr]=LXS(y,X,'nsamp',nsamp,'conflev',conflev(1),'rew',1,'lms',0);
h=subplot(2,2,4);
laby='Scaled reweighted LTS residuals'; 
resindexplot(outLTSr.residuals,'h',h,'title',titl,'laby',laby,'numlab','','conflev',conflev);
</pre>
<p>
In this example only the reweighted LTS seems to 
detect half of the outlier with a Bonferroni significance level.&nbsp;
<img alt="" src="plots/lxs1.gif">
</p>
<p>In this second example we simply change the seed to 543 (<tt>state=543</tt>). Using a Bonferroni size of 1%, 
no unit is declared as outlier.&nbsp; </p>
<img alt="" src="plots/lxs2.gif"><br><br>

Playing with the seeds you will see that the situation in which the application of 
traditional robust estimators does not seem able to reveal the outliers is not so uncommon. 
For example, similar results are obtained using seeds, 70,796, 210, 238, 320, 543.  

You can compare the output with that which comes out from procedure 
<a href="fsr.html">FSR</a> or from the <a href="resfwdplot.html">monitoring residuals plot</a>.


<h3>See Also</h3>

<p><a href="fsr.html"><tt>FSR</tt></a>, <a href="resindexplot.html"><tt>resindexplot</tt></a>,
 <a href="resfwdplot.html"><tt>resfwdplot</tt></a></p>
<p></p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr valign="top">
		<td align="left" width="20"><a href="logmvnpdffs.html">
		<img align="bottom" alt="levfwdplot
" border="0" src="images_help/b_prev.gif" style="height: 17px"></a>
		</td>
		<td align="left">logmvnpdffs.html</td>
		<td>&nbsp;</td>
		<td align="right">mahalfs.html</td>
		<td align="right" width="20"><a href="mahalfs.html">
		<img align="bottom" alt="malfwdplot" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<script type ="text/javascript" language="javaScript">
document.write(barra);
</script>
<!-- Last updated: Fri Jan 23 17:00:05 EST 2009-->

</body>

</html>
