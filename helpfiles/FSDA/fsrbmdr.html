<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<!--FScategory:Robust Regression Analysis and transformations-->

<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>FSRBmdr :: Functions (Flexible Statistics Data Analysis Toolbox&trade;)
</title>
<link href="docstyle.css" rel="stylesheet" type="text/css">
<meta content="refpage" name="chunktype">
<script language="javaScript" src="bottom.js" type="text/javascript"></script>
</head>

<body>

<a name="top_of_page"></a>
<p style="font-size: 1px;">&nbsp;</p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr>
		<td valign="baseline"><b>Flexible Statistics Data Analysis Toolbox&trade;</b></td>
		<td align="right" valign="baseline"><a href="fsrbeda.html">
		<img align="bottom" alt="FSRfan" border="0" src="images_help/b_prev.gif"></a>&nbsp;&nbsp;
		<a href="fsrbonfbound.html">
		<img align="bottom" alt="" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<a name="bq24of9-1"></a><a class="indexterm" name="zmw57dd0e69698"></a>
<h1 class="reftitle">FSRBmdr</h1>
<p class="purpose">Bayesian minimum deletion residual </p>
<h2>Syntax </h2>
<p class="synopsis"><tt>[mdrB,Un,BB,BBayes,S2Bayes] = FSRBmdr(y, X, beta0, R, tau0, 
n0)<br>[mdrB,Un,BB,BBayes,S2Bayes] = FSRBmdr(y, X, beta0, R, tau0, n0,<i>param1</i>,
<i><tt>val1</tt></i>, <i><tt>param2</tt></i>, <i><tt>val2</tt></i>,...)<br></tt>
</p>
<a name="bq24of9-2"></a>
<h2>Description</h2>
<p><tt>[mdrB,Un,BB,BBayes,S2Bayes] = FSRBmdr(y, X, beta0, R, tau0, n0)</tt> </p>
<p>stores 
the values of the Bayesian minimum deletion residual and other basic regression 
quantities in each step of the forward search. This function is called from 
<a href="fsrb.html">FSRB</a> 
in order to compute and store the information which is required to run the automatic 
outlier detection procedure. </p>

<table border="2" cellpadding="4" cellspacing="0" class="body">
	<colgroup>
		<col width="21%"><col width="79%">
	</colgroup>
	<thead>
		<tr>
			<th bgcolor="#B2B2B2">Parameter</th>
			<th bgcolor="#B2B2B2">Value</th>
		</tr>
	</thead>
	<tr>
		<td bgcolor="#F2F2F2"><tt>'y'</tt></td>
		<td bgcolor="#F2F2F2">
		A vector with <tt>n</tt> elements that contains the response variables. 
Missing values (NaN's) and infinite values (Inf's) are allowed, since observations 
(rows) with missing or infinite values will automatically be excluded from the computations.</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>'X'</tt></td>
		<td bgcolor="#F2F2F2">
		Data matrix of explanatory variables (also called 'regressors') of 
dimension (n x p-1). Rows of <tt>X</tt> represent observations, and columns represent variables. 
Missing values (NaN's) and infinite values (Inf's) are allowed, since observations 
(rows) with missing or infinite values will automatically be excluded from the computations.</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"></td>
		<td bgcolor="#F2F2F2">PRIOR INFORMATION:
		<br>&beta; is assumed to have a normal distribution with mean &beta; and (conditional 
on &tau;) covariance (1/&tau;<sub>0</sub>) (X<sub>0</sub>'X<sub>0</sub>)<sup>-1</sup> &beta;~N(&beta;<sub>0</sub>, 
(1/&tau;<sub>0</sub>) (X<sub>0</sub>'X<sub>0</sub>)<sup>-1</sup>) <br>The prior distribution of &tau;<sub>0</sub> is a &gamma; distribution with parameters a and b, 
that is p(&tau;<sub>0</sub>) &#8733;  &tau;<sup>a<sub>0</sub>-1</sup> Exp(-b<sub>0</sub>, &tau;) and  E(&tau;<sub>0</sub>)= a<sub>0</sub>/b<sub>0</sub></td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>'beta0'</tt>
		<td bgcolor="#F2F2F2">
		p-times-1 vector containing prior mean of &beta;</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>'R'</tt></td>
		<td bgcolor="#F2F2F2">
		p-x-p positive definite matrix which can be interepreted as X<sub>0</sub>'X<sub>0</sub> 
where X<sub>0 </sub>is a n<sub>0</sub> x p matrix coming from previous experiments (assuming that the 
intercept is included in the model) <br></td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>'tau0'</tt></td>
		<td bgcolor="#F2F2F2">
		scalar. Prior estimate of τ=1/ σ<sup>2</sup> =a<sub>0</sub>/b<sub>0</sub></td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>'n0'</tt></td>
		<td bgcolor="#F2F2F2">
		scalar. Sometimes it helps to think of the prior information as coming 
		from n<sub>0</sub> previous experiments. Therefore we assume 
that matrix X<sub>0 </sub>(which defines R), was made up of n<sub>0 </sub> observations.</td>
	</tr>	
</table>

<p>Remark:      The user should only give the input arguments that have to
               change their default value.
               The name of the input arguments needs to be followed by
               their value. The order of the input arguments is of no
               importance.

               Missing values (NaN's) and infinite values (Inf's) are
               allowed, since observations (rows) with missing or infinite
               values will automatically be excluded from the
               computations. y can be both a row of column vector.

</p>
<p><tt><a name="bq24of9-3"></a>[mdrB,Un,BB,BBayes,S2Bayes] = FSRBmdr(y, X, beta0, 
R, tau0, n0)</tt> 
returns the following information </p>
<ul type="disc">
	<li>
	<p><tt>mdrB</tt>: n x 2 matrix which contains the monitoring of minimum deletion 
	residual at each step of the forward search.<br>1st col = fwd search index (from 
	0 to n-1).<br>2nd col = minimum deletion residual.<br></p>
	</li>
	<li>
	<p><tt>Un</tt>: (n-init) x 11 matrix which contains the unit(s) included in 
	the subset at each step of the search.<br>REMARK: in every step the new subset 
	is compared with the old subset. Un contains the unit(s) present in the new 
	subset but not in the old one.<br>Un(1,2) for example contains the unit included 
	in step init+1.<br>Un(end,2) contains the units included in the final step of 
	the search.<br></p>
	</li>
	<li>
	<p><tt>BB</tt>: n x (n-init+1) matrix which the units belonging to the subset 
	at each step of the forward search.<br>1st col = index forming subset in the 
	initial step<br>...<br>last column = units forming subset in the final step 
	(i.e. all units).<br></p>
	</li>
	<li>
	<p><tt>BBayes</tt>: (n-init+1) x (p+1) matrix containing the monitoring of estimated 
	beta coefficients in each step of the forward search.<br></p>
	</li>
	<li>
	<p><tt>S2Bayes</tt>: (n-init+1) x 3 matrix containing the monitoring of S2 (2nd 
	column)and R2 (third column) in each step of the forward search. </p>
	</li>
</ul>
<ul>
	<a name="zmw57dd0e69798"></a>
	<table border="1" cellpadding="5" cellspacing="0" class="note" summary="Note">
		<tr width="90%">
			<td>
			<p><b>Note</b>&nbsp;&nbsp; <tt>FSRBmdr</tt> is nothing but a simplified 
			version of function <tt>FSRBeda</tt> but without plotting features. </p>
			</td>
		</tr>
	</table>
</ul>
<p></p>
<p><tt>[mdr,Un,BB,Bols,S2] = FSRBmdr(y,X,bsb,<i><tt>param1</tt></i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)</tt> 
specifies one or more of the name/value pairs described in the following table.</p>
<table border="2" cellpadding="4" cellspacing="0" class="body">
	<colgroup>
		<col width="21%"><col width="79%">
	</colgroup>
	<thead>
		<tr>
			<th bgcolor="#B2B2B2">Parameter</th>
			<th bgcolor="#B2B2B2">Value</th>
		</tr>
	</thead>
	<tr>
		<td bgcolor="#F2F2F2"><tt>'bsb'</tt></td>
		<td bgcolor="#F2F2F2">
		m x 1 vector containing the units forming initial subset. The default 
		value of bsb is '' (empty value), that is we initialize the search just 
		using prior information.</td>
	</tr>
	
	<tr>
		<td bgcolor="#F2F2F2"><tt>'init'</tt></td>
		<td bgcolor="#F2F2F2">
		<p>scalar, which specifies the point where to initialize the search and 
		start monitoring required diagnostics. Notice that if bsb is supplied init&gt;=length(bsb). 
		if init is not specified it will be set equal to <tt>p+1</tt>, if the 
		sample size is smaller than 40; <tt>min(3*p+1,floor(0.5*(n+p+1)))</tt>, 
		otherwise.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>'intercept'</tt></td>
		<td bgcolor="#F2F2F2">
		<p>If 1, a model with constant term will be fitted (default) else no constant 
		term will be included.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>'plots'</tt></td>
		<td bgcolor="#F2F2F2">
		<p>If equal to one a plot of minimum deletion residual appears on the screen 
		with 1%, 50% and 99% confidence bands else (default) no plot is shown. Remark: 
		the plot which is produced is very simple. In order to control a series 
		of options in this plot and in order to connect it dynamically to the other 
		forward plots it is necessary to use function <a href="mdrplot.html">mdrplot</a>.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>'nocheck'</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Scalar. If <tt>nocheck</tt> is equal to 1 no check is performed on matrix 
		y and matrix X. Notice that y and X are left unchanged. In other words the 
		additional column of ones for the intercept is not added. As default <tt>
		nocheck=0</tt>.</p>
		</td>
	</tr>
	
	<tr>
		<td bgcolor="#F2F2F2"><tt>'msg'</tt></td>
		<td bgcolor="#F2F2F2">
		<p>scalar which controls whether to display or not messages
               about great interchange on the screen
               If <tt>msg==1</tt> (default) messages are displyed on the screen
               else no message is displayed on the screen 
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>'bsbsteps'</tt></td>
		<td bgcolor="#F2F2F2">
		<p>vector which specifies for which steps of the fwd search it
               is necessary to save the units forming subset. If <tt>bsbsteps==0</tt>
               we store the units forming subset in all steps. The
               default is store the units forming subset in all steps if
               n<=5000, else to store the units forming subset at steps
               init and steps which are multiple of 100. For example, if
               n=753 and init=6, units forming subset are stored for
               m=init, 100, 200, 300, 400, 500 and 600.</p>
		</td>
	</tr>
</table>
<p>&nbsp;References:<br>Atkinson A.C. Corbellini A, and Riani M. (2015), Robust 
Bayesian Regression, submitted.<br><br>Copyright 2008-2014.<br>Written by 
FSDA team</p>
<a name="bq9x7hn"></a><a name="bq5gf2y"></a>
<h3>Examples</h3>
In this example we show the monitoring of Bayesian minimum deletion residual, using Houses Price dataset&nbsp;
<pre class="programlisting">
% Example of Houses Price
% load dataset
load hprice.txt;

% setup parameters
n=size(hprice,1);
y=hprice(:,1);
X=hprice(:,2:5);
n0=5;

% set \beta components
beta0=0*ones(5,1);
beta0(2,1)=10;
beta0(3,1)=5000;
beta0(4,1)=10000;
beta0(5,1)=10000;

% \tau
s02=1/4.0e-8;
tau0=1/s02;

% R prior settings
R=2.4*eye(5);
R(2,2)=6e-7;
R(3,3)=.15;
R(4,4)=.6;
R(5,5)=.6;
R=inv(R);

% define a Bayes structure with previous data
bayes=struct;
bayes.R=R;
bayes.n0=n0;
bayes.beta0=beta0;
bayes.tau0=tau0;

% The trajectory of Bayesian mdr shows that the curve starts exceeding
% the upper 99% threshold from steps m=480
mdrB=FSRBmdr(y,X,beta0, R, tau0, n0,'plots',1);
</pre>
<img src="plots/fsrbmdr01.jpg">

<p>In this second example we increase n<sub>0</sub> from 5 to 250 and start monitoring the 
Bayesian minimum deletion residual starting from step 300</p>
<pre class="programlisting">
% We change n0 from 5 to 250
n0=250
% FSRmdr monitoring from step 300.
mdrB=FSRBmdr(y,X,beta0, R, tau0, n0,'init',300,'plots',1);
</pre>
<img src="plots/fsrbmdr02.jpg">
<p></p>
<h3>See Also</h3>
<p><a href="fsr.html"><tt>FSRB</tt></a>, <a href="fsreda.html"><tt>FSRBeda</tt></a></p>
<p></p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr>
		<td align="left" width="20"><a href="fsrbeda.html">
		<img align="bottom" alt="FSRfan" border="0" src="images_help/b_prev.gif"></a>
		</td>
		<td align="left">fsrbeda.html</td>
		<td>&nbsp;</td>
		<td align="right">fsrbonfbound.html</td>
		<td align="right" width="20"><a href="fsrbonfbound.html">
		<img align="bottom" alt="levfwdplot
" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<script language="javaScript" type="text/javascript">
document.write(barra);
</script>
<!-- Last updated: Fri Jan 23 17:00:05 EST 2009-->

</body>

</html>
