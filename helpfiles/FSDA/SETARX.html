<!DOCTYPE HTML> <html itemscope="" xmlns="http://www.w3.org/1999/xhtml"><head><title>SETARX</title><meta content="refpage" name="chunktype"><meta content="function:SETARX" itemprop="refentity" name="refentity"><meta content="text/javascript" http-equiv="Content-Script-Type"><meta content="fcn" itemprop="pagetype" name="toctype"><meta content="ref/function" itemprop="infotype" name="infotype" /><meta content="SETARX implements Threshold autoregressive models with two regimes." itemprop="description" name="description" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /><script type="text/x-mathjax-config">MathJax.Hub.Config({extensions: ["tex2jax.js"],jax: ["input/TeX","output/HTML-CSS"],menuSettings: {zoom: "Double-Click", zscale: "300"},tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},MathMenu: {showRenderer: false},"HTML-CSS": {availableFonts: ["TeX"],preferredFont: "TeX",imageFont: null}});</script><script type="text/javascript" src="includesFS/Mathjax/MathJax.js"></script><script src="includesFS/matlab-highlighter.min.js"></script><link href="includesFS/matlab-highlighter.css" rel="stylesheet" type="text/css"><script type="text/javascript" src="includesFS/jquery-latest.js"></script><script>$(document).ready(function(){      $("#divtop").load("includesFS/top.html");      $("#divbottom").load("includesFS/bottom.html");});</script><link href="../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)"></link><link href="../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)"></link><link href="../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)"></link><link href="../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)"></link><link href="../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)"></link><link href="../includes/product/css/site6_offcanvas.css" rel="stylesheet" type="text/css"></link><script src="../includes/shared/scripts/l10n.js" type="text/javascript"></script><script src="../includes/product/scripts/docscripts.js"></script><script src="../includes/shared/scripts/docscripts_rn.js"></script><script src="../includes/shared/scripts/mw.imageanimation.js" type="text/javascript"></script><script src="../includes/shared/scripts/jquery.highlight.js"></script><script src="../includes/product/scripts/bootstrap.min.js" type="text/javascript"></script><script src="../includes/product/scripts/global.js"></script><script src="includesFS/bottom.js" type="text/javascript"></script><script src="../includes/product/scripts/underscore-min.js"></script><script src="../includes/shared/scripts/f1help.js" type="text/javascript"></script><script src="../includes/product/scripts/suggest.js" type="text/javascript"></script><script src="../includes/shared/scripts/helpservices.js" type="text/javascript"></script><script src="../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script><!-- the following line should be kept this way only --><link href="includesFS/doc_center.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css"><link href="../includes/product/css/doc_center_print.css" media="print" rel="stylesheet" type="text/css"></head><body  onload="highlightMATLABCode();" id="responsive_offcanvas">  <div id="doc_header_spacer" class="header"></div><div class="sticky_header_container includes_subnav"><div class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-xs-12 col-sm-6 col-sm-push-6 col-md-5 col-md-push-7" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2017a" data-language="en" action="../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="sr-only">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"><div class="input-group-btn"><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search pull-right icon_32 visible-xs" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="col-sm-6 col-sm-pull-6 col-md-7 col-md-pull-5" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../documentation-center.html">Documentation</a></h1></div></div></div><div class="visible-xs" id="search_actuator"><button class="btn icon-search btn_search pull-right icon_16" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div><!--END.CLASS row--> </div><!--END.CLASS container-fluid--> </div><!--END.CLASS section_header level_3--><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_actuator" data-toggle="offcanvas" data-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="sr-only">Toggle navigation</span><span class="icon-menu icon_24"></span></button><span class="offcanvas_actuator_label"></span><span class="offcanvas_actuator_close"></span> </div><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-md-12 hidden-xs hidden-sm"></div></div></div></div></div></div></div><!--END.CLASS sticky_header_container--><div class="row-offcanvas row-offcanvas-left"><div id="sidebar" class="sidebar-offcanvas" role="navigation"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" xmlns:atict="http://www.arbortext.com/namespace/atict"><li itemprop="breadcrumb" itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb"> <a href="../documentation-center.html" itemprop="url"> <span itemprop="title">All Products</span></a></li></ul><ul class="nav_disambiguation" xmlns:atict="http://www.arbortext.com/namespace/atict"><li class="product"><a href="index.html">Flexible Statistics and Data Analysis (FSDA)</a><div class="dropdown"> <span id="dropdownMenu1" class="icon-arrow-down icon_16" data-toggle="dropdown"> </span><ul aria-labelledby="dropdownMenu1" class="dropdown-menu dropdown-menu-right" role="menu"><li role="presentation"> <a href="examples.html" role="menuitem" tabindex="-1">Examples</a></li><li role="presentation"> <a href="function-alpha.html" role="menuitem" tabindex="-1"> Functions and Other Reference</a></li><li role="presentation"> <a href="release_notes.html?s_cid=doc_flyout" role="menuitem" tabindex="-1"> Release Notes</a></li><li role="presentation"> <a href="tutorials.html" role="menuitem" tabindex="-1"> Tutorials</a></li></ul></div></li></ul><ul xmlns:atict="http://www.arbortext.com/namespace/atict" class="nav_disambiguation"> <li><a href="index.html">Flexible Statistics and Data Analysis Toolbox</a> </li> <li><a href="function-cate.html" itemprop="url">Functions</a></li></ul><!-- --><ul class="nav_scrollspy nav" xmlns:atict="http://www.arbortext.com/namespace/atict">  <li class="nav_scrollspy_function"> <a href="#responsive_offcanvas">SETARX</a></li> <li id="SSPY810-refentry" class="nav_scrollspy_title">On this page</li><li><a class="intrnllnk" href="#syntax">Syntax</a></li><li><a class="intrnllnk" href="#Description">Description</a></li><li><a class="intrnllnk" href="#Examples">Examples</a><ul><li><a class="intrnllnk" href="#Example_1">Example 1: Estimation from simulated data.</a></li><li><a class="intrnllnk" href="#Example_2">Example 2: Estimation from simulated data of example 1 with an extra constant column as regressor.</a></li><li><a class="intrnllnk" href="#Example_3">Example 3: variant from example 1.</a></li><li><a class="intrnllnk" href="#Example_4"></a></li></ul></li><li><a class="intrnllnk" href="#Inputs">Input Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_y">y</a></li><li><a class="intrnllnk" href="#input_argument_p">p</a></li><li><a class="intrnllnk" href="#input_argument_d">d</a></li></ul></li><li><a class="intrnllnk" href="#NameValuePairs">Name-Value Pair Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_namevalue_trim">trim</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_intercept">intercept</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_X">X</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_Z">Z</a></li></ul></li><li><a class="intrnllnk" href="#OutputArgs">Output Arguments</a><ul><li><a class="intrnllnk" href="#output_argument_out">out</a></li><li><a class="intrnllnk" href="#output_argument_reg">reg</a></li><li><a class="intrnllnk" href="#output_argument_input">input</a></li></ul></li><li><a class="intrnllnk" href="#References">References</a></li><li><a class="intrnllnk" href="#SeeAlso">See Also</a></li></ul></nav><script src="../includes/product/scripts/offcanvas.js"></script></div><div id="divtop"></div><div class="site_container site_toc_closed"><div class="page_container"><div class="content_frame"><div id="content_container" class="content_container"><section id="doc_center_content"><div class="function_ref"><div itemprop="content"><h1 itemprop="title">SETARX</h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">SETARX implements Threshold autoregressive models with two regimes</p><div class="switch"><a id="expandAllPage" href="javascript:void(0);">expand all in page</a></div></div></div></div><div class="ref_sect"><h2 id="syntax">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><ul><li><code class="synopsis">out=SETARX(y, p, d)</code><span class="syntax_example"><a class="intrnllnk" href="SETARX.html#Example_1">example</a></span></li><li><code class="synopsis">out=SETARX(y, p, d,Name,Value)</code><span class="syntax_example"><a class="intrnllnk" href="SETARX.html#Example_2">example</a></span></li><li><code class="synopsis">[out, reg]=SETARX(___)</code><span class="syntax_example"><a class="intrnllnk" href="SETARX.html#Example_3">example</a></span></li><li><code class="synopsis">[out, reg, input]=SETARX(___)</code><span class="syntax_example"><a class="intrnllnk" href="SETARX.html#Example_4">example</a></span></li></ul></div></div></div>	<div class="ref_sect" itemprop="content">							<h2 id="Description">Description</h2>							<div class="descriptions">								<div class="description_module"><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="SETARX.html#Example_1">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_out"><code>out</code></a>=SETARX(<a class="intrnllnk" href="#inputarg_y"><code>y</code></a>,<a class="intrnllnk" href="#inputarg_p"><code>p</code></a>,<a class="intrnllnk" href="#inputarg_d"><code> d</code></a>)</code></span>Example 1: Estimation from simulated data.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="SETARX.html#Example_2">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_out"><code>out</code></a>=SETARX(<a class="intrnllnk" href="#inputarg_y"><code>y</code></a>,<a class="intrnllnk" href="#inputarg_p"><code>p</code></a>,<a class="intrnllnk" href="#inputarg_d"><code>d</code></a>,<a class="intrnllnk" href="#namevaluepairarguments"><code>Name, Value</code></a>)</code></span>Example 2: Estimation from simulated data of example 1 with an extra constant column as regressor.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="SETARX.html#Example_3">	example</a></p>	<p><span itemprop="syntax"><code>[<a class="intrnllnk" href="#outputarg_out"><code>out</code></a>,<a class="intrnllnk" href="#outputarg_reg"><code> reg</code></a>]=SETARX(___)</code></span>Example 3: variant from example 1.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="SETARX.html#Example_4">	example</a></p>	<p><span itemprop="syntax"><code>[<a class="intrnllnk" href="#outputarg_out"><code>out</code></a>,<a class="intrnllnk" href="#outputarg_reg"><code> reg</code></a>,<a class="intrnllnk" href="#outputarg_input"><code> input</code></a>]=SETARX(___)</code></span></p></div>								</div>							</div>							<div class="clear">							</div>						</div><div class="ref_sect" itemprop="content"><div class="examples"><h2 id="Examples">Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="example_1" class="example_module expandableContent"><div id="Example_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Example 1: Estimation from simulated data.</li></span></a></span></h3><div class="collapse"><p>
      $\beta_1=(0.7, -0.5, -0.6, 0.3, 0.3)^{\prime}$ and ...<div class="programlisting"><div class="codeinput"><pre class="matlab-code">%  $\beta_2=(-0.1, -0.5, 0.6, 0.4, 0)^{\prime}$.
% SETAR with all the default options.
% Use simulated data.
rng('default')
rng(10)
n = 50;
y = randn(n,1);
X1 = randn(n,2);
for i = 3:n
y(i) = (y(i-2) &lt; 0.5)*(0.3+0.7*y(i-1)-0.5*y(i-2)-0.6*X1(i,1)+0.3*X1(i,2))+...
(y(i-2) &gt;= 0.5)*(-0.1*y(i-1)-0.5*y(i-2)+0.6*X1(i,1)+0.4*X1(i,2));
end
p = 2;
d = 2;
[out] = SETARX(y, p ,d, 'X',X1);</pre></div></div></p></div></div><div id="example_2" class="example_module expandableContent"><div id="Example_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>Example 2: Estimation from simulated data of example 1 with an extra constant column as regressor.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">n = 50;
y = randn(n,1);
X1 = randn(n,2);
X2 = [repmat(0.3,n,1) X1];
p = 2;
d = 2;
[out2] = SETARX(y, p ,d, 'X',X2);</pre></div></div></p></div></div><div id="example_3" class="example_module expandableContent"><div id="Example_3"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>Example 3: variant from example 1.</li></span></a></span></h3><div class="collapse"><p>
     Estimation from simulated data of example 1 with an extra column as regressor, half zeros
     and half ones. This will produce a warning (column of zeros removed) during the loop for the 
     estimation of the threshold value. Check out3.setarx.rmv_col_loop.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">n = 50;
y = randn(n,1);
X1 = randn(n,2);
p = 2;
d = 2;
X3 = [[repmat(0,25,1);repmat(1,25,1)] X1];
[out3] = SETARX(y, p ,d, 'X',X3);</pre></div></div></p></div></div><div id="example_4" class="example_module expandableContent"><div id="Example_4"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li></li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code"></pre></div></div></p></div></div></div><p> </p></div></div></div><div class="ref_sect" itemprop="content"><h2 id="Inputs">Input Arguments</h2><div class="expandableContent"><div class="arguments"><div class="input_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"> <div id="inputarg_y" class="clearfix"> </div> <h3 id="input_argument_y" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>y</code> &#8212; Response variable. </span>  </a><span class="example_desc">Vector.</span></span></h3> <div class="collapse"> <p><p>Response variable, specified as
               a vector of length n, where n is the number of
               observations.</p> <p>
               Missing values (NaN's) and infinite values (Inf's) are
               allowed, since observations (rows) with missing or infinite
               values will automatically be excluded from the
               computations. Data type - double.</p></p> <p class="datatypelist"><strong> Data Types: </strong><code>single| double</code></p> </div> </div><div class="expandableContent"> <div id="inputarg_p" class="clearfix"> </div> <h3 id="input_argument_p" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>p</code> &#8212; autoregressive order of y in regimes. </span>  </a><span class="example_desc">Scalar.</span></span></h3> <div class="collapse"> <p><p>If
               p = 0, the AR part is not present in the regimes, so an
               error is given in the case 'X' and 'Z' are empty and
               'intercept' is false.</p> <p>
               Data type - non negative integer.</p></p> <p class="datatypelist"><strong> Data Types: </strong><code>single| double</code></p> </div> </div><div class="expandableContent"> <div id="inputarg_d" class="clearfix"> </div> <h3 id="input_argument_d" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>d</code> &#8212; lag of the threshold variable $y_{(t-d)}$. </span>  </a><span class="example_desc">Scalar.</span></span></h3> <div class="collapse"> <p>Data
               Data type - positive integer.</p> <p class="datatypelist"><strong> Data Types: </strong><code>single| double</code></p> </div> </div><div id="namevaluepairarguments" class="clearfix"></div><h3 id="NameValuePairs" class="bottom_ruled">Name-Value Pair Arguments</h3><div class="namevaluecontainer"><p>Specify optional comma-separated pairs of <code>Name,Value</code> arguments. <code>Name</code> is the argument name and <code>Value</code> is the corresponding value. <code>Name</code> must appear  inside single quotes (<code>' '</code>).  You can specify several name and value pair arguments in any order as <code>  Name1,Value1,...,NameN,ValueN</code>.</p>  <span class="example_desc"><strong>Example:</strong><code><code></code>,<code></code>,<code></code>,<code></code></code></span></div><div class="expandableContent"><div id="inputarg_trim" class="clearfix"></div><h3 id="input_argument_namevalue_trim" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>trim</code> &#8212;Minimum fraction of observations contained in each regime.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>The trimming parameter should be set between 0.05
               and 0.45. The fraction of observations to trim from tails
               of the threshold variable, in order to ensure a sufficient
               number of observations around the true threshold parameter
               so that it can be identified (usually set between 0.10 and
               0.15). Default is 0.15. If the number of observation to be
               trimmed is less that the total number of regressors, an
               error is given.</p> <p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code></code></p>	<p class="datatypelist"><strong>Data Types: </strong><code></code></p></div></div><div class="expandableContent"><div id="inputarg_intercept" class="clearfix"></div><h3 id="input_argument_namevalue_intercept" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>intercept</code> &#8212;Indicator for constant term.</span></a><span class="example_desc">true (default) | false.</span></span></h3><div class="collapse">	<p><p>Indicator for the constant term (intercept) in the fit,
               specified as the comma-separated pair consisting of
               'Intercept' and either true to include or false to remove
               the constant term from the model.</p> <p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code></code></p>	<p class="datatypelist"><strong>Data Types: </strong><code></code></p></div></div><div class="expandableContent"><div id="inputarg_X" class="clearfix"></div><h3 id="input_argument_namevalue_X" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>X</code> &#8212;Data matrix of explanatory variables.</span></a><span class="example_desc">matrix of exogenous               regressors of dimension n x k1, where k1 denotes the number               of regressors excluding the intercept.</span></span></h3><div class="collapse">	<p><p>Rows of X represent
               observations, and columns represent variables. Each entry
               in y is the response for the corresponding row of X. By
               default, there is a constant term in the model, unless you
               explicitly remove it using input option intercept, so do
               not include a column of 1s in X. Missing values (NaN's) and
               infinite values (Inf's) are allowed, since observations
               (rows) with missing or infinite values will automatically
               be excluded from the computations.</p> <p> 
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code></code></p>	<p class="datatypelist"><strong>Data Types: </strong><code></code></p></div></div><div class="expandableContent"><div id="inputarg_Z" class="clearfix"></div><h3 id="input_argument_namevalue_Z" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>Z</code> &#8212;Deterministic variables (including dummies).</span></a><span class="example_desc">matrix of               deterministic regressors of dimension n x k2, where k2               denotes the number of regressors excluding the intercept.</span></span></h3><div class="collapse">	<p>Rows of Z represent observations, and columns represent
               variables. Each entry in y is the response for the
               corresponding row of Z. By default, there is a constant term in the
               model, unless you explicitly remove it using input option
               intercept, so do not include a column of 1s in Z. Missing
               values (NaN's) and infinite values (Inf's) are allowed,
               since observations (rows) with missing or infinite values
               will automatically be excluded from the computations. Data
               </p>	<p class="description_valueexample">       <strong>Example: </strong><code></code></p>	<p class="datatypelist"><strong>Data Types: </strong><code></code></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="OutputArgs" >Output Arguments</h2><div class="expandableContent"><div class="arguments"><div class="output_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"><div id="outputarg_out" class="clearfix"></div><h3 id="output_argument_out" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>out</code> &#8212; description</span></a><span class="example_desc">Structure</span></span></h3><div class="collapse"><p><p>A structure with the results of the SETARX model estimation
               containing the following fields:</p> <p>
</p><table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>regime1</code></td><td><p><p>A sub-substructure containing the results of the OLS estimation of the linear
                              regression model applyied to the data in
                              regime 1. The estimation is performed with
                              the function estregimeTAR.</p> <p>
                              Additional details are  in the description
                              of the outputs in the output structure reg.</p></p></td></tr><tr valign="top"><td><code>regime2</code></td><td><p>A sub-substructure containing the results of the
                             OLS estimation of the linear
                              regression model applyied to the data in
                              regime 2. The estimation is performed with
                              the function estregimeTAR (see sections
                              'Outputs' and 'More about' of estregimeTAR).</p></td></tr><tr valign="top"><td><code>rmv_col_loop</code></td><td><p>Warnings collected for regimes 1 and 2 in the loop for the search of the
                      optimal threshold value. Matrix of strings of
                      dimension n x 2. Warnings show the indices of
                      columns removed from the matrix of regressors before
                      the model estimation. Columns containing only zeros
                      are removed. Then, to avoid multicollinearity, in
                      the case of presence of multiple non-zero constant
                      columns, the code leave only the first constant
                      column.</p></td></tr><tr valign="top"><td><code>thrhat</code></td><td><p>Estimated threshold value. Scalar. It is the threshold value that minimizes
                              the joint RSS.</p></td></tr><tr valign="top"><td><code>thrvar_ord</code></td><td><p>Index series after reorder of threshold variable yd. Vector.</p></td></tr><tr valign="top"><td><code>sigmaj_2</code></td><td><p>Estimated residual variance of SETARX model. Scalar.</p></td></tr><tr valign="top"><td><code>RSSj</code></td><td><p>Joint Residual Sum of Squared of SETARX model. Scalar.</p></td></tr><tr valign="top"><td><code>yjhat</code></td><td><p>Fitted values of SETARX model. Vector.</p></td></tr><tr valign="top"><td><code>resj</code></td><td><p>Residuals of the SETARX model. Vector.</p></td></tr><tr valign="top"><td><code>yjhat_full</code></td><td><p>Fitted values of SETARX model with observations
                       (rows) with missing or infinite
                         values reinserted as NaNs. This is to obtain the
                         same length of the initial
                        input vector y defined by the user.</p></td></tr><tr valign="top"><td><code>resj_full</code></td><td><p>Residuals of the SETARX model with observations
                       (rows) with missing or infinite
                       values reinserted as NaNs. This is to obtain the
                       same length of the initial input vector ydefined by
                       the user.</p></td></tr></table></p></div></div><div class="expandableContent"><div id="outputarg_reg" class="clearfix"></div><h3 id="output_argument_reg" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>reg</code> &#8212; description</span></a><span class="example_desc">Structure</span></span></h3><div class="collapse"><p><p>A structure with the results of the OLS estimation of
               the linear regression model (benchmark), contanining the following fields.</p> <p>
 </p><table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>beta</code></td><td><p><p>Estimated parameters of the regression model. Vector.</p> <p>
                     See out.covar.</p></p></td></tr><tr valign="top"><td><code>se</code></td><td><p>Estimated heteroskedasticity-consistent (HC) standard
                    errors. Vector.</p></td></tr><tr valign="top"><td><code>covar</code></td><td><p>Estimated variance-covariance matrix. Matrix. It is
                     the heteroskedasticity-consistent (HC) covariance
                      matrix. See section 'More about'.</p></td></tr><tr valign="top"><td><code>sigma_2</code></td><td><p>Estimated residual variance. Scalar.</p></td></tr><tr valign="top"><td><code>yhat</code></td><td><p>Fitted values. Vector.</p></td></tr><tr valign="top"><td><code>res</code></td><td><p>Residuals of the regression model. Vector.</p></td></tr><tr valign="top"><td><code>RSS</code></td><td><p>Residual Sum of Squared. Scalar.</p></td></tr><tr valign="top"><td><code>TSS</code></td><td><p>Total Sum of Squared. Scalar.</p></td></tr><tr valign="top"><td><code>R_2</code></td><td><p>R^2. Scalar.</p></td></tr><tr valign="top"><td><code>n</code></td><td><p><p>Number of observations entering in the estimation.</p> <p>
                    Scalar.</p></p></td></tr><tr valign="top"><td><code>k</code></td><td><p>Number of regressors in the model left after
                    the checks. It is the number of
                    betas to be estimated by OLS. The betas
                    corresponding to the removed columns of X will be
                    set to 0 (see section 'More about' of
                    estregimeTAR). Scalar.</p></td></tr><tr valign="top"><td><code>rmv_col</code></td><td><p><p>Indices of columns removed from X before the model
                       estimation. Scalar or vector.</p> <p>
                         Columns containing only zeros are removed. Then,
                         to avoid multicollinearity, in the case of
                         presence of multiple non-zero constant columns,
                         the code leave only the first constant column
                         (see section 'More about' of estregimeTAR).</p></p></td></tr><tr valign="top"><td><code>rk_warning</code></td><td><p>Warning for skipped estimation. String. If the matrix
                       X is singular after the
                         adjustments, the OLS estimation is skipped, the
                         parameters are set to NaN and a warning is
                         produced.</p></td></tr><tr valign="top"><td><code>yhat_full</code></td><td><p><p>Fitted values of the estimated linear regression
                       model with observations (rows) with
                         missing or infinite values reinserted as NaNs.</p> <p>
                         This is to obtain the same length of the initial
                         input vector y defined by the user.</p></p></td></tr><tr valign="top"><td><code>res_full</code></td><td><p><p>Residuals of the estimated linear regression model
                       with observations (rows) with
                         missing or infinite values reinserted as NaNs.</p> <p>
                         This is to obtain the same length of the initial
                         input vector y defined by the user.</p></p></td></tr></table></p></div></div><div class="expandableContent"><div id="outputarg_input" class="clearfix"></div><h3 id="output_argument_input" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>input</code> &#8212; description</span></a><span class="example_desc">Structure</span></span></h3><div class="collapse"><p><p>A structure containing the following fields.</p> <p>
 </p><table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>y</code></td><td><p>Response without missing and infs. Vector. The new
               response variable, with observations (rows) with missing or infinite values
                excluded.</p></td></tr><tr valign="top"><td><code>X</code></td><td><p><p>Predictor variables without infs and missings. Matrix.</p> <p>
                   The new matrix of explanatory variables, with missing
                   or infinite values excluded, to be used for the model
                   estimation. It is the matrix [L X Z intercept] where L
                   is the lagged matrix n x p of y (if p &gt; 0), X is the
                   matrix of exogenous regressors defined by the user, Z
                   is the matrix of deterministic regressors and the last
                   column is the intercept (if any).</p></p></td></tr><tr valign="top"><td><code>yd</code></td><td><p>Threshold variable without missing and infs. Vector. The
                   new threshold variable,
                  with observations (rows) with missing or infinite
                  values excluded.</p></td></tr><tr valign="top"><td><code>rmv_obs</code></td><td><p>Indices of removed observations/rows (because of
                   missings or infs). Scalar vector.</p></td></tr><tr valign="top"><td><code>y_full</code></td><td><p>Response y after adjustements by chkinputTAR BUT with
                   observations (rows) with missing or infinite values
                   included.</p></td></tr><tr valign="top"><td><code>X_full</code></td><td><p>Matrix X after adjustements by chkinputTAR BUT with
                 observations (rows) with missing or infinite values included.</p></td></tr><tr valign="top"><td><code>yd_full</code></td><td><p><p>Threshold variable after adjustements by chkinputTAR BUT
                 with observations (rows) with
                 missing or infinite values included.</p> <p>

  More about (fix this section):</p> <p>

 Given a time series $y_t$, a two-regime Self-Exciting Threshold
 Auto Regressive model SETARX($p$,$d$) with exogenous regressors is specified as
 \begin{equation}\label{eqn:setar}
 y_t=
 \begin{cases}
 {\bf x}_{t} {\boldsymbol{\beta}}_1 + {\bf z}_{t} {\boldsymbol{\lambda}}_1 + \varepsilon_{1t}, \hspace{0.5cm} \textrm{if} \hspace{0.5cm} y_{t-d}\leq \gamma \\
     {\bf x}_{t} {\boldsymbol{\beta}}_2 + {\bf z}_{t} {\boldsymbol{\lambda}}_2 + \varepsilon_{2t}, \hspace{0.5cm} \textrm{if} \hspace{0.5cm} y_{t-d}&gt; \gamma
         \end{cases}
     \end{equation}
 for $t=\max(p,d),...,N$, where $y_{t-d}$ is the threshold variable
         with $d\geq 1$ and $\gamma$ is the threshold value. The relation
     between $y_{t-d}$ and $\gamma$ states if $y_t$ is observed in regime
     1 or 2. ${\boldsymbol{\beta}}_j$ is the vector of auto-regressive parameters
     for regime $j=1,2$ and ${\bf x}_{t}$ is the $t$-th row of the
         $(N\times p)$ matrix ${\bf X}$ comprising $p$ lagged variables of
         $y_t$. ${\boldsymbol{\lambda}}_j$ is the vector of parameters corresponding
         to exogenous regressors and/or dummies contained in the $(N \times
         r)$ matrix ${\bf Z}$ whose $t$-th row is ${\bf z}_t$. Errors
         $\varepsilon_{1t}$ and $\varepsilon_{2t}$ are assumed to be independent and to follow
         distributions $\mathrm{iid}(0,\sigma_{\varepsilon,1})$ and
         $\mathrm{iid}(0,\sigma_{\varepsilon,2})$ respectively.</p> <p>

         \subsection{Estimation of SETAR models}
         \label{sec:2.1}

         In general the value of the threshold $\gamma$ is unknown, so that
         the parameters to estimate become ${\boldsymbol{\theta}}_1=({\boldsymbol{\beta}}^{\prime}_1, {\bf\lambda}^{\prime}_1)^{\prime}$, ${\boldsymbol{\theta}}_2=({\boldsymbol{\beta}}^{\prime}_2,{\bf\lambda}^{\prime}_2)^{\prime}
         $, $\gamma$, $\sigma_{\varepsilon,1}$ and $\sigma_{\varepsilon,2}$.</p> <p>

         Parameters can be estimated by sequential conditional least squares. For a fixed threshold $\gamma$ the observations may be divided into two samples $\{y_t |y_{t-d}\leq \gamma\}$ and $\{y_t |y_{t-d}&gt; \gamma\}$: the data can be denoted respectively as $\mathbf{y}_j=(y_{ji_1},y_{ji_2},...,y_{ji_{N_j}})^{\prime}$ in regimes $j=1,2$, with $N_1$ and $N_2$ the regimes sample sizes and $N_1+N_2=N-\max(p,d)$.</p> <p>

     Parameters ${\boldsymbol{\theta}}_1$ and ${\boldsymbol{\theta}}_2$ can be estimated by OLS as
     \begin{equation}\label{eqn:par}
     \hat{\boldsymbol{\theta}}_j=\left({\mathbf{X}^*_j}^{\prime}\mathbf{X}^*_j\right)^{-1}{\mathbf{X}^*_j}^{\prime}\mathbf{y}_j\,
     \end{equation}
       for $j=1,2$ where $\mathbf{X}^*_j=(\mathbf{X}_j,\mathbf{Z}_j)=(({\bf x}_{ji_1}^{\prime},...,{\bf x}_{ji_{N_j}}^{\prime})^{\prime},({\bf z}_{ji_1}^{\prime},...,{\bf z}_{ji_{N_j}}^{\prime})^{\prime})$ is the $(N_j \times (p+r))$ matrix of regressors for each regime. The variance estimates can be calculated as
         $\hat{\sigma}_{\varepsilon,j}={\bf r}_j^{\prime}{\bf r}_j /(N_j - (p+r))$, with ${\bf r}_j={\bf y}_j-\mathbf{X}^*_j\hat{\boldsymbol{\theta}}_j$.</p><p>

     The least square estimate of $\gamma$ is obtained by minimizing the joint residual sum of
     squares
     \begin{equation}\label{eqn:gamma}
     \gamma=\arg\min_{\gamma\in\Gamma}\sum_{j=1}^2 {\bf r}_j^{\prime}{\bf r}_j
     \end{equation}
 over a set $\Gamma$ of allowable threshold values so that each
 regime contains at least a given fraction $\varphi$ (ranging from
 0.05 to 0.3) of all observations</p></p></td></tr></table></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><div class="bibliography"><h2 id="References">References</h2> <div><p>Franses and van Dijk (2000), "Nonlinear Time Series Models in Empirical Finance",
    Cambridge: Cambridge University Press.</p></div><div><p><p>Grossi, L. and Nan, F. (2019), Robust forecasting of electricity prices:</p> <p>
    simulations, models and the impact of renewable sources, "Technological
    Forecasting & Social Change", Vol. 141, pp. 305-318.</p><p>
    <a href="https://doi.org/10.1016/j.techfore.2019.01.006">https://doi.org/10.1016/j.techfore.2019.01.006</a></p></p></div></div></div><div class="ref_sect"><h2 id="SeeAlso">See Also</h2><p><span itemprop="seealso"><a href="LTSts.html" itemprop="url"><span itemprop="name"><code>LTSts</code></span></a></span></div><i>This page has been automatically generated by our routine <a href="publishFS.html">publishFS</a></i></div></section></div></div></div></div><div id="divbottom"></div></body></html>