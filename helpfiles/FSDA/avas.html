<!DOCTYPE HTML> <html itemscope="" xmlns="http://www.w3.org/1999/xhtml"><head><title>avas</title><meta content="refpage" name="chunktype"><meta content="function:avas" itemprop="refentity" name="refentity"><meta content="text/javascript" http-equiv="Content-Script-Type"><meta content="fcn" itemprop="pagetype" name="toctype"><meta content="ref/function" itemprop="infotype" name="infotype" /><meta content="avas computes additivity and variance stabilization for regression." itemprop="description" name="description" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /><script type="text/x-mathjax-config">MathJax.Hub.Config({extensions: ["tex2jax.js"],jax: ["input/TeX","output/HTML-CSS"],menuSettings: {zoom: "Double-Click", zscale: "300"},tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},MathMenu: {showRenderer: false},"HTML-CSS": {availableFonts: ["TeX"],preferredFont: "TeX",imageFont: null}});</script><script type="text/javascript" src="includesFS/Mathjax/MathJax.js"></script><script src="includesFS/matlab-highlighter.min.js"></script><link href="includesFS/matlab-highlighter.css" rel="stylesheet" type="text/css"><script type="text/javascript" src="includesFS/jquery-latest.js"></script><script>$(document).ready(function(){      $("#divtop").load("includesFS/top.html");      $("#divbottom").load("includesFS/bottom.html");});</script><link href="../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)"></link><link href="../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)"></link><link href="../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)"></link><link href="../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)"></link><link href="../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)"></link><link href="../includes/product/css/site6_offcanvas.css" rel="stylesheet" type="text/css"></link><script src="../includes/shared/scripts/l10n.js" type="text/javascript"></script><script src="../includes/product/scripts/docscripts.js"></script><script src="../includes/shared/scripts/docscripts_rn.js"></script><script src="../includes/shared/scripts/mw.imageanimation.js" type="text/javascript"></script><script src="../includes/shared/scripts/jquery.highlight.js"></script><script src="../includes/product/scripts/bootstrap.min.js" type="text/javascript"></script><script src="../includes/product/scripts/global.js"></script><script src="includesFS/bottom.js" type="text/javascript"></script><script src="../includes/product/scripts/underscore-min.js"></script><script src="../includes/shared/scripts/f1help.js" type="text/javascript"></script><script src="../includes/product/scripts/suggest.js" type="text/javascript"></script><script src="../includes/shared/scripts/helpservices.js" type="text/javascript"></script><script src="../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script><!-- the following line should be kept this way only --><link href="includesFS/doc_center.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css"><link href="../includes/product/css/doc_center_print.css" media="print" rel="stylesheet" type="text/css"></head><body  onload="highlightMATLABCode();" id="responsive_offcanvas">  <div id="doc_header_spacer" class="header"></div><div class="sticky_header_container includes_subnav"><div class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-xs-12 col-sm-6 col-sm-push-6 col-md-5 col-md-push-7" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2017a" data-language="en" action="../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="sr-only">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"><div class="input-group-btn"><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search pull-right icon_32 visible-xs" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="col-sm-6 col-sm-pull-6 col-md-7 col-md-pull-5" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../documentation-center.html">Documentation</a></h1></div></div></div><div class="visible-xs" id="search_actuator"><button class="btn icon-search btn_search pull-right icon_16" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div><!--END.CLASS row--> </div><!--END.CLASS container-fluid--> </div><!--END.CLASS section_header level_3--><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_actuator" data-toggle="offcanvas" data-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="sr-only">Toggle navigation</span><span class="icon-menu icon_24"></span></button><span class="offcanvas_actuator_label"></span><span class="offcanvas_actuator_close"></span> </div><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-md-12 hidden-xs hidden-sm"></div></div></div></div></div></div></div><!--END.CLASS sticky_header_container--><div class="row-offcanvas row-offcanvas-left"><div id="sidebar" class="sidebar-offcanvas" role="navigation"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" xmlns:atict="http://www.arbortext.com/namespace/atict"><li itemprop="breadcrumb" itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb"> <a href="../documentation-center.html" itemprop="url"> <span itemprop="title">All Products</span></a></li></ul><ul class="nav_disambiguation" xmlns:atict="http://www.arbortext.com/namespace/atict"><li class="product"><a href="index.html">Flexible Statistics and Data Analysis (FSDA)</a><div class="dropdown"> <span id="dropdownMenu1" class="icon-arrow-down icon_16" data-toggle="dropdown"> </span><ul aria-labelledby="dropdownMenu1" class="dropdown-menu dropdown-menu-right" role="menu"><li role="presentation"> <a href="examples.html" role="menuitem" tabindex="-1">Examples</a></li><li role="presentation"> <a href="function-alpha.html" role="menuitem" tabindex="-1"> Functions and Other Reference</a></li><li role="presentation"> <a href="release_notes.html?s_cid=doc_flyout" role="menuitem" tabindex="-1"> Release Notes</a></li><li role="presentation"> <a href="tutorials.html" role="menuitem" tabindex="-1"> Tutorials</a></li></ul></div></li></ul><ul xmlns:atict="http://www.arbortext.com/namespace/atict" class="nav_disambiguation"> <li><a href="index.html">Flexible Statistics and Data Analysis Toolbox</a> </li> <li><a href="function-cate.html" itemprop="url">Functions</a></li></ul><!-- --><ul class="nav_scrollspy nav" xmlns:atict="http://www.arbortext.com/namespace/atict">  <li class="nav_scrollspy_function"> <a href="#responsive_offcanvas">avas</a></li> <li id="SSPY810-refentry" class="nav_scrollspy_title">On this page</li><li><a class="intrnllnk" href="#syntax">Syntax</a></li><li><a class="intrnllnk" href="#Description">Description</a></li><li><a class="intrnllnk" href="#Examples">Examples</a><ul><li><a class="intrnllnk" href="#Example_1">Example of the use of avas based on the Wang and Murphy data.</a></li><li><a class="intrnllnk" href="#Example_2">Example 1 from TIB88: brain body weight data.</a></li></ul></li><li><a class="intrnllnk" href="#ExtraExamples">Extra Examples</a><ul><li><a class="intrnllnk" href="#ExtraExample_1">Example 3 from TIB88: unequal variances.</a></li><li><a class="intrnllnk" href="#ExtraExample_2">Example 4 from TIB88: non constant underlying variance.</a></li><li><a class="intrnllnk" href="#ExtraExample_3">Example 5 from TIB88: missing group variable.</a></li><li><a class="intrnllnk" href="#ExtraExample_4">Example 6 from TIB88: binary.</a></li><li><a class="intrnllnk" href="#ExtraExample_5">Example 9 from TIB88: Nonmonotone function of X.</a></li><li><a class="intrnllnk" href="#ExtraExample_6">Example of use of option tyinitial.</a></li></ul></li><li><a class="intrnllnk" href="#Inputs">Input Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_y">y</a></li><li><a class="intrnllnk" href="#input_argument_X">X</a></li></ul></li><li><a class="intrnllnk" href="#NameValuePairs">Name-Value Pair Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_namevalue_delrsq">delrsq</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_l">l</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_maxit">maxit</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_nterm">nterm</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_PredictorOrderR2">PredictorOrderR2</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_Trapezoid">Trapezoid</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_rob">rob</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_scail">scail</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_tyinitial">tyinitial</a></li><li><a class="intrnllnk" href="#input_argument_namevalue_w">w</a></li></ul></li><li><a class="intrnllnk" href="#OutputArgs">Output Arguments</a><ul><li><a class="intrnllnk" href="#output_argument_out">out</a></li></ul></li><li><a class="intrnllnk" href="#MoreAbout">More About</a></li><li><a class="intrnllnk" href="#References">References</a></li><li><a class="intrnllnk" href="#SeeAlso">See Also</a></li></ul></nav><script src="../includes/product/scripts/offcanvas.js"></script></div><div id="divtop"></div><div class="site_container site_toc_closed"><div class="page_container"><div class="content_frame"><div id="content_container" class="content_container"><section id="doc_center_content"><div class="function_ref"><div itemprop="content"><h1 itemprop="title">avas</h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">avas computes additivity and variance stabilization for regression</p><div class="switch"><a id="expandAllPage" href="javascript:void(0);">expand all in page</a></div></div></div></div><div class="ref_sect"><h2 id="syntax">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><ul><li><code class="synopsis">out=avas(y,X)</code><span class="syntax_example"><a class="intrnllnk" href="avas.html#Example_1">example</a></span></li><li><code class="synopsis">out=avas(y,X,Name,Value)</code><span class="syntax_example"><a class="intrnllnk" href="avas.html#Example_2">example</a></span></li></ul></div></div></div>	<div class="ref_sect" itemprop="content">							<h2 id="Description">Description</h2>							<div class="descriptions">								<div class="description_module"><p>This function differs from ace because it uses a (nonparametric)
   variance-stabilizing transformation for the response variable.</p><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="avas.html#Example_1">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_out"><code>out</code></a>=avas(<a class="intrnllnk" href="#inputarg_y"><code>y</code></a>,<a class="intrnllnk" href="#inputarg_X"><code>X</code></a>)</code></span>Example of the use of avas based on the Wang and Murphy data.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="avas.html#Example_2">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_out"><code>out</code></a>=avas(<a class="intrnllnk" href="#inputarg_y"><code>y</code></a>,<a class="intrnllnk" href="#inputarg_X"><code>X</code></a>,<a class="intrnllnk" href="#namevaluepairarguments"><code>Name, Value</code></a>)</code></span>Example 1 from TIB88: brain body weight data.</p></div>								</div>							</div>							<div class="clear">							</div>						</div><div class="ref_sect" itemprop="content"><div class="examples"><h2 id="Examples">Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="example_1" class="example_module expandableContent"><div id="Example_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Example of the use of avas based on the Wang and Murphy data.</li></span></a></span></h3><div class="collapse"><p>
    In order to have the possibility of replicating the results in R using
    library acepack function mtR is used to generate the random data.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">rng('default')
seed=11;
negstate=-30;
n=200;
X1 = mtR(n,0,seed)*2-1;
X2 = mtR(n,0,negstate)*2-1;
X3 = mtR(n,0,negstate)*2-1;
X4 = mtR(n,0,negstate)*2-1;
res=mtR(n,1,negstate);
% Generate y
y = log(4 + sin(3*X1) + abs(X2) + X3.^2 + X4 + .1*res );
X = [X1 X2 X3 X4];
% Apply the avas algorithm
out= avas(y,X);
% Show the output graphically using function aceplot
aceplot(out)</pre></div></div><a href='http://rosa.unipr.it/fsda/avas.html#Example_1'><img vspace="5" hspace="5" src="images\avas_01.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website). Graphical output could not be included in the installation file because toolboxes cannot be greater than 20MB. To load locally the image files, download zip file http://rosa.unipr.it/fsda/images.zip and unzip it to <tt>(docroot)/FSDA/images</tt> or simply run routine <tt>downloadGraphicalOutput.m</tt>"> <img vspace="5" hspace="5" src="images\avas_02.png" alt=""> </a></p></div></div><div id="example_2" class="example_module expandableContent"><div id="Example_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>Example 1 from TIB88: brain body weight data.</li></span></a></span></h3><div class="collapse"><p>
     Comparison between ace and avas.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">YY=load('animals.txt');
y=YY(1:62,2);
X=YY(1:62,1);
out=ace(y,X);
aceplot(out)
out=avas(y,X);
aceplot(out)
% https://vincentarelbundock.github.io/Rdatasets/doc/robustbase/Animals2.html
% ## The `same' plot for Rousseeuw's subset:
% data(Animals, package = "MASS")
% brain &lt;- Animals[c(1:24, 26:25, 27:28),]
% plotbb(bbdat = brain)</pre></div></div></p></div></div></div><p> </p><div class="examples"><h2 id="ExtraExamples" class="bottom_ruled">Related Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="Extraexample_1" class="example_module expandableContent"><div id="ExtraExample_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Example 3 from TIB88: unequal variances.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">n=200;
rng('default')
seed=100;
negstate=-30;
x = mtR(n,0,seed)*3;
z = mtR(n,1,negstate);
y=x+0.1*x.*z;
X=x;
nr=1;
nc=2;
outACE=ace(y,X);
outAVAS=avas(y,X);
subplot(nr,nc,1)
yy=[y, outACE.ty outAVAS.ty];
yysor=sortrows(yy,1);
plot(yysor(:,1),yysor(:,2:3))
% plot(y,[outACE.ty outAVAS.ty])
title('Compare ACE and AVAS')
xlabel('y')
ylabel('ty')
legend({'ACE' 'AVAS'},'Location','Best')
subplot(nr,nc,2)
XX=[X, outACE.tX outAVAS.tX];
XXsor=sortrows(XX,1);
plot(XXsor(:,1),XXsor(:,2:3))
% plot(y,[outACE.ty outAVAS.ty])
title('Compare ACE and AVAS')
xlabel('x')
ylabel('tX')
legend({'ACE' 'AVAS'},'Location','Best')
% For R users, the R code to reproduce the example above is given
% below.
% set.seed(100)
% n=200
% x &lt;- runif(n)*3
% z &lt;- rnorm(n)
% y=x+0.1*x*z;
% out=ace(x,y)
% out=avas(x,y)</pre></div></div><a href='http://rosa.unipr.it/fsda/avas.html#ExtraExample_1'><img vspace="5" hspace="5" src="images\avas_03.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> </a></p></div></div><div id="Extraexample_2" class="example_module expandableContent"><div id="ExtraExample_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Example 4 from TIB88: non constant underlying variance.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">close all
negstate=-100;
rng('default')
seed=100;
n=200;
x1=mtR(n,1,seed);
x2=mtR(n,1,negstate);
z=mtR(n,1,negstate);
% x1=randn(n,1);
% x2=randn(n,1);
% z=randn(n,1);
absx1_x2=abs(x1-x2);
y=x1+x2+(1/3)*absx1_x2.*z;
X=[x1 x2];
out=avas(y,X);
tyhat=sum(out.tX,2);
ty=out.ty;
absty_tyhat=abs(ty-tyhat);
% hold('on')
plot(absx1_x2,absty_tyhat,'o');
lsline
% For R users, the R code to reproduce the example above is given
% below.
% # Example 4 non constant underlying variance
%  set.seed(100)
% n=200;
% x1=rnorm(n);
% x2=rnorm(n);
% z=rnorm(n);
% absx1_x2=abs(x1-x2);
% y=x1+x2+(1/3)*absx1_x2*z;
% X=cbind(x1,x2);
% out=avas(X,y);</pre></div></div></p></div></div><div id="Extraexample_3" class="example_module expandableContent"><div id="ExtraExample_3"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Example 5 from TIB88: missing group variable.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">rng('default')
seed=1000;
n=100;
x=mtR(n,0,seed)*10-5;
z=mtR(n,1,-seed);
%x=rand(n,1)*10-5;
%z=randn(n,1);
y1=3+5*x+z;
y2=-3+5*x+z;
y=[y1;y2];
X=[x;x];
out=avas(y,X);
aceplot(out);
% For R users, the R code to reproduce the example above is given
% below.
% # Example 5 missing group variable
% set.seed(1000)
% n=100;
% x=runif(n)*10-5;
% z=rnorm(n);
% y1=3+5*x+z;
% y2=-3+5*x+z;
% y=c(y1,y2);
% X=c(x,x)
% out=avas(X,y);</pre></div></div><a href='http://rosa.unipr.it/fsda/avas.html#ExtraExample_3'><img vspace="5" hspace="5" src="images\avas_04.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> <img vspace="5" hspace="5" src="images\avas_05.png" alt=""> </a></p></div></div><div id="Extraexample_4" class="example_module expandableContent"><div id="ExtraExample_4"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Example 6 from TIB88: binary.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">seed=20;
n=50;
y1=exp(-0.5+0.5*mtR(n,1,seed));
y2=exp(0.5+0.5*mtR(n,1,-seed));
y=[y1;y2];
X=[-0.5*ones(n,1); 0.5*ones(n,1)];
out=avas(y,X);
aceplot(out)
% For R users, the R code to reproduce the example above is given
% below.
% Example 6 binary
% set.seed(20)
% n=50;
% y1=exp(-0.5+0.5*rnorm(n));
% y2=exp(0.5+0.5*rnorm(n));
% y=c(y1,y2);
% X=c(-0.5*rep(1,n), 0.5*rep(1,n));
% out=avas(X,y);</pre></div></div></p></div></div><div id="Extraexample_5" class="example_module expandableContent"><div id="ExtraExample_5"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Example 9 from TIB88: Nonmonotone function of X.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">n=200;
x=rand(n,1)*2*pi;
z=randn(n,1);
y=exp(sin(x)+0.2*z);
X=x;
out=avas(y,X);
aceplot(out)</pre></div></div></p></div></div><div id="Extraexample_6" class="example_module expandableContent"><div id="ExtraExample_6"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Example of use of option tyinitial.</li></span></a></span></h3><div class="collapse"><p>
     Generate the data.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">rng(2000)
n=100;
X=10*rand(n,1);
sigma=0.1;
a=2;
b=0.3;
y=a+b*X+sigma*randn(n,1);
% The correct transformation is la=-0.5 (inverse square root)
la=-0.5;
y=normBoxCox(y,1,la,'inverse',true);
% call of AVAS without option tyinitial
subplot(2,1,1)
outAVAS=avas(y,X,'l',4);
tyfinal=outAVAS.ty;
out=fitlm(X,tyfinal);
plot(X,tyfinal,'o')
lsline
xlabel('Original x')
ylabel('Without option tyinitial')
title(['R2=' num2str(out.Rsquared.Ordinary)])
% call of AVAS with option tinitial set to true
subplot(2,1,2)
outAVAStyini=avas(y,X,'l',4,'tyinitial',true);
tyfinal=outAVAStyini.ty;
out=fitlm(X,tyfinal);
plot(X,tyfinal,'o')
lsline
xlabel('Original x')
ylabel('With option tyinitial')
title(['R2=' num2str(out.Rsquared.Ordinary)])</pre></div></div></p></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="Inputs">Input Arguments</h2><div class="expandableContent"><div class="arguments"><div class="input_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"> <div id="inputarg_y" class="clearfix"> </div> <h3 id="input_argument_y" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>y</code> &#8212; Response variable. </span>  </a><span class="example_desc">Vector.</span></span></h3> <div class="collapse"> <p><p>Response variable, specified as
               a vector of length n, where n is the number of
               observations. Each entry in y is the response for the
               corresponding row of X.</p> <p>
               Missing values (NaN's) and infinite values (Inf's) are
               allowed, since observations (rows) with missing or infinite
               values will automatically be excluded from the
               computations.</p></p> <p class="datatypelist"><strong> Data Types: </strong><code>single| double</code></p> </div> </div><div class="expandableContent"> <div id="inputarg_X" class="clearfix"> </div> <h3 id="input_argument_X" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>X</code> &#8212; Predictor variables. </span>  </a><span class="example_desc">Matrix.</span></span></h3> <div class="collapse"> <p><p>Matrix of explanatory
               variables (also called 'regressors') of dimension n x (p-1)
               where p denotes the number of explanatory variables
               including the intercept.</p> <p>
               Rows of X represent observations, and columns represent
               variables. By default, there is a constant term in the
               model, unless you explicitly remove it using input option
               intercept, so do not include a column of 1s in X. Missing
               values (NaN's) and infinite values (Inf's) are allowed,
               since observations (rows) with missing or infinite values
               will automatically be excluded from the computations.</p></p> <p class="datatypelist"><strong> Data Types: </strong><code>single| double</code></p> </div> </div><div id="namevaluepairarguments" class="clearfix"></div><h3 id="NameValuePairs" class="bottom_ruled">Name-Value Pair Arguments</h3><div class="namevaluecontainer"><p>Specify optional comma-separated pairs of <code>Name,Value</code> arguments. <code>Name</code> is the argument name and <code>Value</code> is the corresponding value. <code>Name</code> must appear  inside single quotes (<code>' '</code>).  You can specify several name and value pair arguments in any order as <code>  Name1,Value1,...,NameN,ValueN</code>.</p>  <span class="example_desc"><strong>Example:</strong><code><code> 'delrsq',0.001
</code>,<code> 'l',[3 3 1]
</code>,<code> 'maxit',30
</code>,<code> 'nterm',5
</code>,<code> 'PredictorOrderR2',true
</code>,<code> 'Trapezoid',true
</code>,<code> 'rob',true
</code>,<code> 'scail',true
</code>,<code> 'tyinitial',true
</code>,<code> 'w',1:n
</code></code></span></div><div class="expandableContent"><div id="inputarg_delrsq" class="clearfix"></div><h3 id="input_argument_namevalue_delrsq" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>delrsq</code> &#8212;termination threshold.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>Iteration (in the outer loop)
            stops when rsq changes less than delrsq in nterm. The default
            value of delrsq is 0.01.</p> <p>
           </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'delrsq',0.001
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_l" class="clearfix"></div><h3 id="input_argument_namevalue_l" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>l</code> &#8212;type of transformation.</span></a><span class="example_desc">vector.</span></span></h3><div class="collapse">	<p><p>Vector of length p which
           specifies the type of transformation for the explanatory
           variables.</p> <p>
           l(j)=1 =&gt; j-th variable assumes orderable values and any
                   transformation (also non monotone) is allowed.</p> <p>
           l(j)=2 =&gt; j-th variable assumes circular (periodic) values
                 in the range (0.0,1.0) with period 1.0.</p> <p>
           l(j)=3 =&gt; j-th variable transformation is to be monotone.</p> <p>
           l(j)=4 =&gt; j-th variable transformation is to be linear.</p> <p>
           l(j)=5 =&gt; j-th variable assumes categorical (unorderable) values.</p> <p>
           j =1, 2,..., p+1.</p> <p>
           The default value of l is a vector of ones of length p,
           that is the procedure assumes that all the explanatory
           variables have orderable values (and therefore can be
           transformed non monothonically).</p> <p>
           Note that in avas procedure the response is always transformed
           (in a monothonic way).</p><p>
           </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'l',[3 3 1]
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_maxit" class="clearfix"></div><h3 id="input_argument_namevalue_maxit" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>maxit</code> &#8212;maximum number of iterations for the outer loop.</span></a><span class="example_desc">scalar.</span></span></h3><div class="collapse">	<p><p>The
            default maximum number of iterations before exiting the outer
            loop is 20.</p> <p>
           </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'maxit',30
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_nterm" class="clearfix"></div><h3 id="input_argument_namevalue_nterm" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>nterm</code> &#8212;minimum number of consecutive iteration below the threshold
           to terminate the outer loop.</span></a><span class="example_desc">positive scalar.</span></span></h3><div class="collapse">	<p><p>This value
           specifies how many consecutive iterations below the threshold
           it is necessary to have to declare convergence in the outer
           loop. The default value of nterm is 3.</p> <p>
           </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'nterm',5
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div><div class="expandableContent"><div id="inputarg_PredictorOrderR2" class="clearfix"></div><h3 id="input_argument_namevalue_PredictorOrderR2" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>PredictorOrderR2</code> &#8212;inclusion of the variables using $R^2$.</span></a><span class="example_desc">boolean.</span></span></h3><div class="collapse">	<p><p>The default backfitting algorithm of AVAS (PredictorOrderR2=false)
           just does one
           iteration over the predictors, it may not find optimal
           transformations and it will be dependent on the order of the
           predictors in X. If (PredictorOrderR2=true), in the backfitting algorithm
           the explanatory variables become candidate for transformation
           depending on their $R^2$ order of importance.</p> <p>
           </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'PredictorOrderR2',true
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>logical</code></p></div></div><div class="expandableContent"><div id="inputarg_Trapezoid" class="clearfix"></div><h3 id="input_argument_namevalue_Trapezoid" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>Trapezoid</code> &#8212;strategy for evaluating points that lie outside the
           domain of fitted values inside the routine which computes the
           variance stabilizing transformation (ctsub).</span></a><span class="example_desc">boolean.</span></span></h3><div class="collapse">	<p><p>This
           options specifies the hypothesis to assume in the
           cases in which $\widehat{ty}_i^{old}&lt;\hat y_{(1)}$ or
           $\widehat{ty}^{old}&gt;\hat y_{n-k}$ where $\hat y_{(1)}$, ...,
           $\hat y_{(n-k)}$ are the fitted values sorted of the $n-k$
           units which have not been declared as outliers and
           $\widehat{ty}_i^{old}$ is the transformed value for unit $i$
           from previous iteration ($i=1, \ldots, n$).</p> <p>
           If this option is omitted or if Trapezoid is false
           (default), we assume a rectangulat hypothesis. In
           other words, we assume that below $\hat y_{(1)}$ the function
           $1/|e_1|, \ldots,  1/|e_{n-k}|$, is constant and equal to $1/|e_1|$, 
           $|e_1|, \ldots, |e_{n-k}|$ are the smoothed residuals
           corresponding to ordered fitted values.</p> <p>
           Similarly, we assume that beyond $\hat y_{n-k}$ the function is
           constant and equal to $1/|e_{n-k}|$. If Trapezoid is
           false we assume that below $\hat y_{(1)}$ or above $\hat
           y_{(n-k)}$  the function is constant and equal to the mean of
           $\sum_{j=1}^{n-k} 1/(|e_j| (n-k))$ (trapezoidal hypothesis).</p> <p>
           Additional details are given in the More About section of this
           file.</p><p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'Trapezoid',true
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>logical</code></p></div></div><div class="expandableContent"><div id="inputarg_rob" class="clearfix"></div><h3 id="input_argument_namevalue_rob" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>rob</code> &#8212;Use outlier detection in each step of the backfitting procedure.</span></a><span class="example_desc">boolean | struct.</span></span></h3><div class="collapse">	<p><p>If rob is not specified rob is set to false and no
           outlier detection routine is called.</p> <p>
           If rob is true, FSR routine is called to detect outliers
           before calling backfitting procedure and outliers are removed.</p> <p>
           If rob is a struct, it is possible to specify in the
           fields method, bdp and alphasim the values of the estimator to
           use, the breakdown point and and confidence level to use to
           declare the outliers.</p> <p>
           More precisely:</p> <p>
           rob.method = character which identifies the estimator to use.</p> <p>
               Possible values are 'FS' (Forward search estimator', 'LTS'
               (Least trimmed squares estimator), 'LMS' (Least median of
               squares), 'S' (S estimator). If this field is not specified
               'FS' is used.</p> <p>
           rob.bdp = a scalar in the interval (0, 0.5] which specifies
               breakdown point to use. If this field is not specified it is
               set to 0.2.</p> <p>
           rob.simalpha = simultaneous error rate one is willing to
               tolerate to declare the outliers. If rob.simalpha is not
               specified it is set to 0.01.</p><p>
           </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'rob',true
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>boolean or struct</code></p></div></div><div class="expandableContent"><div id="inputarg_scail" class="clearfix"></div><h3 id="input_argument_namevalue_scail" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>scail</code> &#8212;Inizialing values for the regressors.</span></a><span class="example_desc">boolean.</span></span></h3><div class="collapse">	<p><p>If scail is
           true (default value is false), a linear regression is done on
           the independent variables $X_1$, ...$X_{p-1}$ centered, using y
           standardized, getting the coefficients $b_1$, ..., $b_{p-1}$.</p> <p>
           If scail is true, AVAS takes the initial value of the transform
           of $X_j$ to be $b_j(X_j-mean(X_j))$, $j=1, \ldots, p-1$. This
           is done in order to limit the effect of the ordering of the
           variables on the final results. The purpose of this initial
           linear transformation is to let the the columns of matrix X
           have the same weight when predicting $y$.</p> <p>
           Note that this initialization option is always used inside the
           ACE routine but it is set to false in AVAS or compatibility
           with the original fortran program of Tibshirani.</p> <p>
           See the ADDED NOTE in the [Monotone Regression Splines in
           Action]: Comment.  Leo Breiman Statistical Science, Vol. 3, No.</p> <p>
           4 (Nov., 1988), pp. 442-445.</p><p>
           </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'scail',true
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>logical</code></p></div></div><div class="expandableContent"><div id="inputarg_tyinitial" class="clearfix"></div><h3 id="input_argument_namevalue_tyinitial" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>tyinitial</code> &#8212;Initial values for the transformed response.</span></a><span class="example_desc">boolean | struct.</span></span></h3><div class="collapse">	<p><p>If tyinitial is not specified tyinitial is set to false and the
           initial value for ty are simply the standardized values.</p> <p>
           If tyinitial is true, y is transformed using best BoxCox lambda
           value among the following values of lambda (-1, -0.8, -0.6,
           ..., 0.8, 1) and routines <a href="FSRfan.html">FSRfan</a> and <a href="fanBIC.html">fanBIC</a> are called.</p> <p>
           If tyinitial is a struct it is possible to specify in the
           fields la and family the values of lambda and the family to
           use. More precisely:</p> <p>
           tyinitial.la = values of the lambdas to consider inside FSRfan.</p> <p>
           tyinitial.family= string which identifies the family of transformations which
                   must be used. Character. Possible values are 'BoxCox'
                   (default), 'YJ', or 'YJpn'.</p> <p>
                   The Box-Cox family of power transformations equals
                   $(y^{\lambda}-1)/\lambda$ for $\lambda$ not equal to zero,
                   and $\log(y)$ if $\lambda = 0$.</p> <p>
                   The Yeo-Johnson (YJ) transformation is the Box-Cox
                   transformation of $y+1$ for nonnegative values, and of
                   $|y|+1$ with parameter $2-\lambda$ for $y$ negative.</p> <p>
                   Remember that BoxCox can be used just
                   if input y is positive. Yeo-Johnson family of
                   transformations does not have this limitation.</p> <p>
                   If family is 'YJpn' Yeo-Johnson family is applied but in
                   this case it is also possible to monitor (in the output
                   arguments out.Scorep and out.Scoren) the score test
                   respectively for positive and negative observations.</p><p>
           </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'tyinitial',true
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>boolean or struct</code></p></div></div><div class="expandableContent"><div id="inputarg_w" class="clearfix"></div><h3 id="input_argument_namevalue_w" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>w</code> &#8212;weights for the observations.</span></a><span class="example_desc">vector.</span></span></h3><div class="collapse">	<p><p>Row or column vector of
           length n containing the weights associated to each
           observations. If w is not specified we assum $w=1$ for $i=1,
           2, \ldots, n$.</p> <p>
           </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code> 'w',1:n
</code></p>	<p class="datatypelist"><strong>Data Types: </strong><code>double</code></p></div></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="OutputArgs" >Output Arguments</h2><div class="expandableContent"><div class="arguments"><div class="output_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"><div id="outputarg_out" class="clearfix"></div><h3 id="output_argument_out" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>out</code> &#8212; description</span></a><span class="example_desc">Structure</span></span></h3><div class="collapse"><p>Structure which contains the following fields<table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>ty</code></td><td><p>n x 1 vector containing the transformed y values.</p></td></tr><tr valign="top"><td><code>tX</code></td><td><p>n x p matrix containing the transformed X matrix.</p></td></tr><tr valign="top"><td><code>rsq</code></td><td><p>the multiple R-squared value for the transformed values in
               the last iteration of the outer loop.</p></td></tr><tr valign="top"><td><code>y</code></td><td><p>n x 1 vector containing the original y values.</p></td></tr><tr valign="top"><td><code>X</code></td><td><p>n x p matrix containing the original X matrix.</p></td></tr><tr valign="top"><td><code>niter</code></td><td><p>scalar. Number of iterations which have been necessary
               to achieve convergence.</p></td></tr><tr valign="top"><td><code>outliers</code></td><td><p>k x 1 vector containing the units declared as outliers
           when procedure is called with input option rob set to true. If
           rob is false out.outliers=[].</p></td></tr><tr valign="top"><td><code>pvaldw</code></td><td><p>scalar containing p-value of Durbin Watson test for
                    the independence of the residuals ordered by the
                    fitted values from the model.</p></td></tr><tr valign="top"><td><code>pvaljb</code></td><td><p><p>scalar containing p-value of Jarque and Bera test.</p> <p>
                    This statistic uses a combination of estimated
                    skewness and kurtosis to test for distributional shape
                    of the residuals.</p></p></td></tr></table></p></div></div></div></div></div></div><div class="moreabout ref_sect"><h2 id="MoreAbout">More About</h2><div class="expandableContent"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent" itemprop="content"><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span>Additional Details</span></a></span></h3><div class="expand"><p><p>In what follows we recall the techinque of the variance stabilizing
 transformation which is at the root of the avas routine.</p> <p>
 Let $ X $ be a random variable, with $ E[X]=\mu $ and $ \mathrm{Var}[X]=\sigma^2 $.</p><p>
 Define $ Y=g(X) $, where $g$ is a regular function. A first-order Taylor
 approximation for $Y=g(x)$ is
 </p>\[
 Y=g(X)\approx g(\mu)+g'(\mu)(X-\mu).
 \]
 Then
 \[
 E[Y]=g(\mu)\; \mbox{and} \; \mathrm{Var}[Y]=\sigma^2g'(\mu)^2. 
 \]<p>
 
 Consider now a random variable $ X $ such that $ E[X]=\mu $ and $
 \mathrm{Var}[X]=h(\mu) $. Notice the relation between the variance and
 the mean, which implies, for example, heteroskedasticity in a linear
 model. The goal is to find a function $ g $ such that $ Y=g(X) $ has a
 variance independent (at least approximately) of its expectation.</p> <p>
 
 Imposing the condition $ \mathrm{Var}[Y]\approx
 h(\mu)g'(\mu)^2=\mathrm{constant} $,  equality implies the differential
 equation
 </p>\[
 \frac{dg}{d\mu}=\frac{C}{\sqrt{h(\mu)}}.
 \]
 
 This ordinary differential equation has, by separation of variables, the solution
 \[
 g(\mu)=\int \frac{Cd\mu}{\sqrt{h(\mu)}}.
 \] 
  Tibshirani (JASA, p.395) has a random variable $W$ with $ E[W]=u $ and $\mathrm{Var}[W]=v(u)$. The variance stabilising transformation for $W$ is given by
 \[
 h(t)=\int^t \frac{1}{\sqrt{v(u)}}.
 \]<p>
 The constant $C = 1$ due to the standardization of the variance of $W$.</p> <p> 
 In our context  $\frac{1}{\sqrt{v(u)}}$ corresponds to vector of the
 reciprocal of the absolute values of the smoothed residuals sorted using
 the ordering based on fitted values of the regression model which uses
 the explanatory variables possibly transformed. The $x$ coordinates of
 the function to integrate are the fitted values sorted.</p> <p>
 
 As concerns the range of integration it goes from
 $\hat y_{(1)}$ the smallest fitted value, to $\widehat{ty}_i^{old}$.</p> <p>
 Therefore the lower extreme of integration is fixed for all $n$ integrals.</p> <p>
 The upper extremes of integration are given by the elements of
 transformed response values from previous iteration (say
 $\widehat{ty}_i^{old}$), corresponding to ordered fitted values.</p> <p>
 The output of the integration is a new set of transformed values
 $\widehat{ty}^{new}$.</p><p>
 
 
 In summary, the trick is that,  there is not just one integral, but there
 are $n$ integrals. Th $i$-th integral which is defined as
 </p>\[
  \widehat{ty}_i^{new}= \int_{\hat y_{(1)}}^{\widehat{ty}_i^{old}} \frac{1}{|e_i|} d \hat y
 \]<p>
 produces a new updated value for the transformed response
 $\widehat{ty}_i$ associated with $\hat y_{(i)}$ the $i$-th ordered fitted
 value. Note that the old transformed value from previous iteration was
 the upper extreme of integration.</p> <p>
 
 The estimate of $g$ is strictly increasing because it is the integral of
 a positive function (reciprocal of the absolute values of the residuals).</p> <p>
 
 The computation of the $n$ integrals is done by the trapezoidal rule and
 is detailed in routine <a href="ctsub.html">ctsub</a>.</p> <p>
 
 ${\it Remark}$: It may happen that at a particular iteration of the AVAS
 procedure using $\widehat{ty}$ and $\widehat{tX}$, $n-m$ units are declared as outliers. In
 this case the fit, the residuals and the associated smoothed values are
 computed using just $n-k$ observations.</p><p>
 Therefore the function to integrate has coordinates
 </p>\[
 (\hat y_{(1)}, 1/|e_1|) , (\hat y_{(2)}, 1/|e_2|), \ldots, (\hat y_{(n-k)}, 1/|e_{n-k}|)
 \]<p>
 where $\hat y_{(j)}$ is the $j$-th order statistic $j=1, 2, \ldots, n-k$
 among the fitted values (associated to non outlying observations) and
 $1/e_j$ is the reciprocal of the corresponding smoothed residual. Notice
 that $e_j$ is not the residual for unit $j$ but it is the residuals which
 corresponds to the $j$-th ordered fitted value $\hat y_{(j)}$. In order
 to have a new estimate of $\widehat{ty}^{new}$, we can still solve $n$
 integrals. If in the upper extreme of integration, we plug in the $n$ old
 values of $\widehat{ty}^{old}$ (including the outliers) we have the
 vector of length $n$ of the new estimates of transformed values
 $\widehat{ty}^{new}$.</p> <p>

</p></p></div></div></div></div><div class="ref_sect" itemprop="content"><div class="bibliography"><h2 id="References">References</h2> <div><p>Tibshirani R. (1987), Estimating optimal transformations for regression,
 "Journal of the American Statistical Association", Vol. 83, 394-405.</p></div><div><p>Wang D.  and Murphy M. (2005), Identifying nonlinear relationships
 regression using the ACE algorithm, "Journal of Applied Statistics",
 Vol. 32, pp. 243-258.</p></div></div></div><div class="ref_sect"><h2 id="SeeAlso">See Also</h2><p><span itemprop="seealso"><a href="ace.html" itemprop="url"><span itemprop="name"><code>ace</code></span></a></span> | <span itemprop="seealso"><a href="aceplot.html" itemprop="url"><span itemprop="name"><code>aceplot</code></span></a></span> | <span itemprop="seealso"><a href="smothr.html" itemprop="url"><span itemprop="name"><code>smothr</code></span></a></span> | <span itemprop="seealso"><a href="supsmu.html" itemprop="url"><span itemprop="name"><code>supsmu</code></span></a></span> | <span itemprop="seealso"><a href="ctsub.html" itemprop="url"><span itemprop="name"><code>ctsub</code></span></a></span></div><i>This page has been automatically generated by our routine <a href="publishFS.html">publishFS</a></i></div></section></div></div></div></div><div id="divbottom"></div></body></html>