<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<!--FScategory:Robust Regression Analysis and transformations-->


<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>FSRmdr :: Functions (Flexible Statistics Data Analysis Toolbox&trade;)</title>
<link href="docstyle.css" rel="stylesheet" type="text/css">
<meta content="refpage" name="chunktype">


<script  type="text/javascript" language="javaScript" src="bottom.js"></script>

</head>


<body>

<a name="top_of_page"></a>
<p style="font-size: 1px;">&nbsp;</p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr>
		<td valign="baseline"><b>Flexible Statistics Data Analysis Toolbox&trade;</b></td>
		<td align="right" valign="baseline"><a href="fsrinvmdr.html">
		<img align="bottom" alt="FSRfan" border="0" src="images_help/b_prev.gif"></a>&nbsp;&nbsp;
		<a href="fsrmdrrs.html">
		<img align="bottom" alt="" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<a name="bq24of9-1"></a><a class="indexterm" name="zmw57dd0e69698"></a>
<h1 class="reftitle">FSRmdr</h1>
<p class="purpose">Minimum deletion residual 
</p>
<h2>Syntax </h2>
<p class="synopsis"><tt>[mdr,Un,BB,Bols,S2] = FSRmdr(y,X,bsb)<br>[mdr,Un,BB,Bols,S2] = FSRmdr(y,X,bsb,<i>param1</i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)<br>
</tt></p>
<a name="bq24of9-2"></a>
<h2>Description</h2>
<p><tt>[mdr,Un,BB,Bols,S2] = FSRmdr(y,X,bsb)</tt> stores the values of the minimum deletion 
residual and other basic regression quantities in each step of the forward search. This function is called from FSR in order to compute a store the information 
which is required to run the automatic outlier detection procedure. </p>
<p><tt>y</tt> is a vector of length <i>n</i> containing the response values, while
<tt>X</tt> is the <i>n</i>-by-<i>p-1</i> matrix which contains (in the columns) the 
values of <i>p-1</i> predictive terms. <tt>bsb</tt> is a vector containing the list 
of the units forming the initial subset. If <tt>bsb=0</tt> (default) then the procedure starts 
with p units randomly chosen else if bsb is not 0 the search will start with <tt>
m0=length(bsb)</tt></p>
<p><tt><a name="bq24of9-3"></a>[mdr,Un,BB,Bols,S2] = FSRmdr(y,X,bsb)</tt> returns the following 
information </p>
<ul type="disc">
	<li>
		<tt>mdr</tt> &minus; n-init x 2 matrix which contains the monitoring of 
		minimum deletion residual or (m+1)ordered residual at each step of the 
		forward search. 
              <br>1st col = fwd search index (from init to n-1) 
              <br>2nd col = minimum deletion residual.&nbsp; REMARK: if the supplied initial subset is not 
              full rank, the forward search loop is not performed and mdr is a missing value. 
              If on the other hand, in a particular step of the search matrix X was singular, mdr 
              has just one column and contains the list of units which produced the non
              singular matrix of explanatory variables.
		</li>
		
		<li>
		<p><tt>Un</tt> &minus; (n-init) x 11 matrix which contains the unit(s) included 
		in the subset at each step of the fwd search. <br>REMARK: in every step 
		the new subset is compared with the old subset. Un contains the unit(s) 
		present in the new subset but not in the old one.<br>Un(1,2) for example 
		contains the unit included in step init+1.<br>...<br>Un(end,2) contains the units 
		included in the final step of the search.</p>
		</li>

		
		<li>
		<p><tt>BB</tt> &minus; n x (n-init+1) matrix containing the information about the units belonging
              to the subset at each step of the forward search. 
              <br>1st col = indexes of the units forming subset in the initial step 
              <br>... 
              <br>last column = units forming subset in the final step (all units)</p></li>
              
           		
		<li>
		<p><tt>Bols</tt> &minus; (n-init+1) x (p+1) matrix containing the monitoring of
              estimated beta coefficients in each step of the forward search</p>
		</li>

		
		<li>
		<p><tt>S2</tt> &minus; (n-init+1) x 3 matrix containing the monitoring of S2 or R2
              in each step of the forward search 
              <br>1st col = fwd search index (from init to n) 
              <br>2nd col = monitoring of S2 
              <br>3rd col = monitoring of R2</p>
		</li>

	</ul>
	<ul>
		<a name="zmw57dd0e69798"></a>
		<table border="1" cellpadding="5" cellspacing="0" class="note" summary="Note">
			<tr width="90%">
				<td>
				<p><b>Note</b>&nbsp;&nbsp; <tt>FSRmdr</tt> is nothing but a 
				simplified version of function <tt>FSReda</tt>. </p>
				</td>
			</tr>
		</table>
	</ul>
	
<p></p>
<p><tt>[mdr,Un,BB,Bols,S2] = FSRmdr(y,X,bsb,<i><tt>param1</tt></i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)</tt> 
specifies one or more of the name/value pairs described in the following table.</p>
<table border="2" cellpadding="4" cellspacing="0" class="body">
	<colgroup>
		<col width="21%"><col width="79%">
	</colgroup>
	<thead>
		<tr valign="top">
			<th bgcolor="#B2B2B2">Parameter</th>
			<th bgcolor="#B2B2B2">Value</th>
		</tr>
	</thead>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;intercept&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>If 1, a model with constant term will be fitted (default) else no constant 
		term will be included.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;init&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p>scalar, which specifies the point where to initialize the search
              and start monitoring required diagnostics. Notice that if bsb
              is supplied init>=length(bsb). if init is not specified it will be set equal to
		<br><tt>p+1</tt>, if the sample size is smaller than 40; <br><tt>min(3*p+1,floor(0.5*(n+p+1)))</tt>, otherwise.</td>
	</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2" style="height: 75px"><tt>&#39;nocheck&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 75px">
		<p>Scalar. If <tt>nocheck</tt> is equal to 1 no check is performed on
              matrix y and matrix X. Notice that y and X are left
              unchanged. In other words the additional column of ones for
              the intercept is not added. As default <tt>nocheck</tt>=0. The
              controls on h, alpha and nsamp still remain</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;plots&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p> If equal to one a plot of minimum deletion residual
              appears  on the screen with 1%, 50% and 99% confidence
              bands else (default) no plot is shown.
              Remark: the plot which is produced is very simple. In order
              to control a series of options in this plot and in order to
              connect it dynamically to the other forward plots it is necessary to use
              function mdrplot.</p>
		</td>
	</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;constr&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>   r x 1 vector which contains the list of units which are
 forced to join the search in the last r steps. The default
 is constr=''.  No constraint is imposed
		</p>
		</td>
	</tr>
	</table>
<p></p>
<a name="bq9x7hn"></a><a name="bq5gf2y"></a>
<h3>Examples</h3>

In this example we show the monitoring of s2, and the evolution of beta coefficients for the Hawkins dataset

<pre class="programlisting">
load('hawkins.txt');
y=hawkins(:,9);
X=hawkins(:,1:8);
[out]=LXS(y,X,'nsamp',10000);
[~,~,~,Bols,S2] = FSRmdr(y,X,out.bs);
</pre>
<p>
The forward plot of s2 shows that initially the estimate is virtually
zero. The four line segments comprising the plot correspond to the four groups
of observations
</p>

<pre class="programlisting">
% Plot of the monitoring of S2 and R2
figure;
subplot(1,2,1)
plot(S2(:,1),S2(:,2))
xlabel('Subset size m');
ylabel('S2');
subplot(1,2,2)
plot(S2(:,1),S2(:,3))
xlabel('Subset size m');
ylabel('R2');
</pre>


<img src="plots/fsrmdr1.gif">
<p></p>
<p>
The forward plots of the estimates of the beta coefficients show
that they are virtually constant until m = 86, after which they start fluctuating in different directions.
</p>


<pre class="programlisting">
% Plots of the monitoring of "Estimates of beta coefficients"
figure;
for j=3:size(Bols,2);
    subplot(2,4,j-2)
    plot(Bols(:,1),Bols(:,j))
    xlabel('Subset size m');
    ylabel(['b' num2str(j-2)]);
end
</pre>

<img alt="" src="plots/fsrmdr.gif">


<h3>See Also</h3>

<p><a href="fsr.html"><tt>FSR</tt></a>, <a href="fsreda.html"><tt>FSReda</tt></a></p>
<p></p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr valign="top">
		<td align="left" width="20"><a href="fsrinvmdr.html">
		<img align="bottom" alt="FSRfan" border="0" src="images_help/b_prev.gif"></a>
		</td>
		<td align="left">fsrinvmdr.html</td>
		<td>&nbsp;</td>
		<td align="right">fsrmdrrs.html</td>
		<td align="right" width="20"><a href="fsrmdrrs.html">
		<img align="bottom" alt="levfwdplot
" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<script type ="text/javascript" language="javaScript">
document.write(barra);
</script>
<!-- Last updated: Fri Jan 23 17:00:05 EST 2009-->

</body>

</html>
