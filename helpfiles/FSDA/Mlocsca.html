<!DOCTYPE HTML> <html itemscope="" xmlns="http://www.w3.org/1999/xhtml"><head><title>Mlocsca</title><meta content="refpage" name="chunktype"><meta content="function:Mlocsca" itemprop="refentity" name="refentity"><meta content="text/javascript" http-equiv="Content-Script-Type"><meta content="fcn" itemprop="pagetype" name="toctype"><meta content="ref/function" itemprop="infotype" name="infotype" /><meta content="Mlocsca computes M estimator of location and scale in univariate samples." itemprop="description" name="description" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /><script type="text/x-mathjax-config">MathJax.Hub.Config({extensions: ["tex2jax.js"],jax: ["input/TeX","output/HTML-CSS"],menuSettings: {zoom: "Double-Click", zscale: "300"},tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},MathMenu: {showRenderer: false},"HTML-CSS": {availableFonts: ["TeX"],preferredFont: "TeX",imageFont: null}});</script><script type="text/javascript" src="includesFS/Mathjax/MathJax.js"></script><script src="includesFS/matlab-highlighter.min.js"></script><link href="includesFS/matlab-highlighter.css" rel="stylesheet" type="text/css"><script type="text/javascript" src="includesFS/jquery-latest.js"></script><script>$(document).ready(function(){      $("#divtop").load("includesFS/top.html");      $("#divbottom").load("includesFS/bottom.html");});</script><link href="../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)"></link><link href="../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)"></link><link href="../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)"></link><link href="../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)"></link><link href="../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)"></link><link href="../includes/product/css/site6_offcanvas.css" rel="stylesheet" type="text/css"></link><script src="../includes/shared/scripts/l10n.js" type="text/javascript"></script><script src="../includes/product/scripts/docscripts.js"></script><script src="../includes/shared/scripts/docscripts_rn.js"></script><script src="../includes/shared/scripts/mw.imageanimation.js" type="text/javascript"></script><script src="../includes/shared/scripts/jquery.highlight.js"></script><script src="../includes/product/scripts/bootstrap.min.js" type="text/javascript"></script><script src="../includes/product/scripts/global.js"></script><script src="includesFS/bottom.js" type="text/javascript"></script><script src="../includes/product/scripts/underscore-min.js"></script><script src="../includes/shared/scripts/f1help.js" type="text/javascript"></script><script src="../includes/product/scripts/suggest.js" type="text/javascript"></script><script src="../includes/shared/scripts/helpservices.js" type="text/javascript"></script><script src="../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script><!-- the following line should be kept this way only --><link href="includesFS/doc_center.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css"><link href="../includes/product/css/doc_center_print.css" media="print" rel="stylesheet" type="text/css"></head><body  onload="highlightMATLABCode();" id="responsive_offcanvas">  <div id="doc_header_spacer" class="header"></div><div class="sticky_header_container includes_subnav"><div class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-xs-12 col-sm-6 col-sm-push-6 col-md-5 col-md-push-7" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2017a" data-language="en" action="../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="sr-only">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"><div class="input-group-btn"><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search pull-right icon_32 visible-xs" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="col-sm-6 col-sm-pull-6 col-md-7 col-md-pull-5" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../documentation-center.html">Documentation</a></h1></div></div></div><div class="visible-xs" id="search_actuator"><button class="btn icon-search btn_search pull-right icon_16" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div><!--END.CLASS row--> </div><!--END.CLASS container-fluid--> </div><!--END.CLASS section_header level_3--><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_actuator" data-toggle="offcanvas" data-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="sr-only">Toggle navigation</span><span class="icon-menu icon_24"></span></button><span class="offcanvas_actuator_label"></span><span class="offcanvas_actuator_close"></span> </div><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-md-12 hidden-xs hidden-sm"></div></div></div></div></div></div></div><!--END.CLASS sticky_header_container--><div class="row-offcanvas row-offcanvas-left"><div id="sidebar" class="sidebar-offcanvas" role="navigation"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" xmlns:atict="http://www.arbortext.com/namespace/atict"><li itemprop="breadcrumb" itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb"> <a href="../documentation-center.html" itemprop="url"> <span itemprop="title">All Products</span></a></li></ul><ul class="nav_disambiguation" xmlns:atict="http://www.arbortext.com/namespace/atict"><li class="product"><a href="index.html">Flexible Statistics and Data Analysis (FSDA)</a><div class="dropdown"> <span id="dropdownMenu1" class="icon-arrow-down icon_16" data-toggle="dropdown"> </span><ul aria-labelledby="dropdownMenu1" class="dropdown-menu dropdown-menu-right" role="menu"><li role="presentation"> <a href="examples.html" role="menuitem" tabindex="-1">Examples</a></li><li role="presentation"> <a href="function-alpha.html" role="menuitem" tabindex="-1"> Functions and Other Reference</a></li><li role="presentation"> <a href="release_notes.html?s_cid=doc_flyout" role="menuitem" tabindex="-1"> Release Notes</a></li><li role="presentation"> <a href="tutorials.html" role="menuitem" tabindex="-1"> Tutorials</a></li></ul></div></li></ul><ul xmlns:atict="http://www.arbortext.com/namespace/atict" class="nav_disambiguation"> <li><a href="index.html">Flexible Statistics and Data Analysis Toolbox</a> </li> <li><a href="function-cate.html" itemprop="url">Functions</a></li></ul><!-- --><ul class="nav_scrollspy nav" xmlns:atict="http://www.arbortext.com/namespace/atict">  <li class="nav_scrollspy_function"> <a href="#responsive_offcanvas">Mlocsca</a></li> <li id="SSPY810-refentry" class="nav_scrollspy_title">On this page</li><li><a class="intrnllnk" href="#syntax">Syntax</a></li><li><a class="intrnllnk" href="#Description">Description</a></li><li><a class="intrnllnk" href="#Examples">Examples</a><ul><li><a class="intrnllnk" href="#Example_1">Example of use of Mlocsca with two input arguments.</a></li><li><a class="intrnllnk" href="#Example_2">Example of use of Mlocsca with three input arguments.</a></li><li><a class="intrnllnk" href="#Example_3">Example of use of Mlocsca with four input arguments.</a></li><li><a class="intrnllnk" href="#Example_4">Example of use of Mlocsca with five input arguments.</a></li><li><a class="intrnllnk" href="#Example_5">Example of use of Mlocsca with six input arguments.</a></li></ul></li><li><a class="intrnllnk" href="#Inputs">Input Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_y">y</a></li><li><a class="intrnllnk" href="#input_argument_psifunc">psifunc</a></li><li><a class="intrnllnk" href="#input_argument_initialmu">initialmu</a></li><li><a class="intrnllnk" href="#input_argument_initialscale">initialscale</a></li><li><a class="intrnllnk" href="#input_argument_tol">tol</a></li><li><a class="intrnllnk" href="#input_argument_maxiter">maxiter</a></li></ul></li><li><a class="intrnllnk" href="#OutputArgs">Output Arguments</a><ul><li><a class="intrnllnk" href="#output_argument_outIRWLS">outIRWLS</a></li></ul></li><li><a class="intrnllnk" href="#MoreAbout">More About</a></li><li><a class="intrnllnk" href="#References">References</a></li><li><a class="intrnllnk" href="#SeeAlso">See Also</a></li></ul></nav><script src="../includes/product/scripts/offcanvas.js"></script></div><div id="divtop"></div><div class="site_container site_toc_closed"><div class="page_container"><div class="content_frame"><div id="content_container" class="content_container"><section id="doc_center_content"><div class="function_ref"><div itemprop="content"><h1 itemprop="title">Mlocsca</h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">Mlocsca computes M estimator of location and scale in univariate samples</p><div class="switch"><a id="expandAllPage" href="javascript:void(0);">expand all in page</a></div></div></div></div><div class="ref_sect"><h2 id="syntax">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><ul><li><code class="synopsis">outIRWLS=Mlocsca(y,psifunc)</code><span class="syntax_example"><a class="intrnllnk" href="Mlocsca.html#Example_1">example</a></span></li><li><code class="synopsis">outIRWLS=Mlocsca(y,psifunc,initialmu)</code><span class="syntax_example"><a class="intrnllnk" href="Mlocsca.html#Example_2">example</a></span></li><li><code class="synopsis">outIRWLS=Mlocsca(y,psifunc,initialmu,initialscale)</code><span class="syntax_example"><a class="intrnllnk" href="Mlocsca.html#Example_3">example</a></span></li><li><code class="synopsis">outIRWLS=Mlocsca(y,psifunc,initialmu,initialscale,tol)</code><span class="syntax_example"><a class="intrnllnk" href="Mlocsca.html#Example_4">example</a></span></li><li><code class="synopsis">outIRWLS=Mlocsca(y,psifunc,initialmu,initialscale,tol,maxiter)</code><span class="syntax_example"><a class="intrnllnk" href="Mlocsca.html#Example_5">example</a></span></li></ul></div></div></div>	<div class="ref_sect" itemprop="content">							<h2 id="Description">Description</h2>							<div class="descriptions">								<div class="description_module"><p>This routines compute simultaneous M estimates of location and scale in
 univariate samples.</p><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="Mlocsca.html#Example_1">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_outIRWLS"><code>outIRWLS</code></a>=Mlocsca(<a class="intrnllnk" href="#inputarg_y"><code>y</code></a>,<a class="intrnllnk" href="#inputarg_psifunc"><code>psifunc</code></a>)</code></span>Example of use of Mlocsca with two input arguments.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="Mlocsca.html#Example_2">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_outIRWLS"><code>outIRWLS</code></a>=Mlocsca(<a class="intrnllnk" href="#inputarg_y"><code>y</code></a>,<a class="intrnllnk" href="#inputarg_psifunc"><code>psifunc</code></a>,<a class="intrnllnk" href="#inputarg_initialmu"><code>initialmu</code></a>)</code></span>Example of use of Mlocsca with three input arguments.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="Mlocsca.html#Example_3">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_outIRWLS"><code>outIRWLS</code></a>=Mlocsca(<a class="intrnllnk" href="#inputarg_y"><code>y</code></a>,<a class="intrnllnk" href="#inputarg_psifunc"><code>psifunc</code></a>,<a class="intrnllnk" href="#inputarg_initialmu"><code>initialmu</code></a>,<a class="intrnllnk" href="#inputarg_initialscale"><code>initialscale</code></a>)</code></span>Example of use of Mlocsca with four input arguments.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="Mlocsca.html#Example_4">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_outIRWLS"><code>outIRWLS</code></a>=Mlocsca(<a class="intrnllnk" href="#inputarg_y"><code>y</code></a>,<a class="intrnllnk" href="#inputarg_psifunc"><code>psifunc</code></a>,<a class="intrnllnk" href="#inputarg_initialmu"><code>initialmu</code></a>,<a class="intrnllnk" href="#inputarg_initialscale"><code>initialscale</code></a>,<a class="intrnllnk" href="#inputarg_tol"><code>tol</code></a>)</code></span>Example of use of Mlocsca with five input arguments.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="Mlocsca.html#Example_5">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_outIRWLS"><code>outIRWLS</code></a>=Mlocsca(<a class="intrnllnk" href="#inputarg_y"><code>y</code></a>,<a class="intrnllnk" href="#inputarg_psifunc"><code>psifunc</code></a>,<a class="intrnllnk" href="#inputarg_initialmu"><code>initialmu</code></a>,<a class="intrnllnk" href="#inputarg_initialscale"><code>initialscale</code></a>,<a class="intrnllnk" href="#inputarg_tol"><code>tol</code></a>,<a class="intrnllnk" href="#inputarg_maxiter"><code>maxiter</code></a>)</code></span>Example of use of Mlocsca with six input arguments.</p></div>								</div>							</div>							<div class="clear">							</div>						</div><div class="ref_sect" itemprop="content"><div class="examples"><h2 id="Examples">Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="example_1" class="example_module expandableContent"><div id="Example_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>Example of use of Mlocsca with two input arguments.</li></span></a></span></h3><div class="collapse"><p>
     Example of M estimate of location and scale using TB function.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">psifuncTB=struct;
psifuncTB.class='TB';
bdp=0.5;
c=TBbdp(bdp,1);
% kc = E(rho) = sup(rho)*bdp
kc=c^2/6*bdp;
psifuncTB.c1=c;
psifuncTB.kc1=kc;
% trueloc and truescale are the true values of the two parameters
trueloc=5;
truescale=2;
% fraction of units to contaminate
fraccontamination=0.3;
% shift in contamination
shift=100;
% n is sample size
n=2000;
rng(1000)
u=truescale*randn(n,1)+trueloc;
n1=round(n*fraccontamination);
% shift contamination
u(1:n1)=u(1:n1)+shift;
% Specify initial estimate of location.
initialmu=10;
out=Mlocsca(u,psifuncTB,initialmu);
disp('Robust estimate of location')
disp(out.location)
disp('Robust estimate of scale')
disp(out.scale)</pre></div></div></p></div></div><div id="example_2" class="example_module expandableContent"><div id="Example_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>Example of use of Mlocsca with three input arguments.</li></span></a></span></h3><div class="collapse"><p>
     M estimate of location ans scale using Hampel rho function with a
     value of c associated to a breakdown point of 0.5<div class="programlisting"><div class="codeinput"><pre class="matlab-code">psifunc=struct;
psifunc.class='HA';
abc=[1.5 3.5 8];
bdp=0.5;
c=HAbdp(bdp,1,abc);
psifunc.c1=[c abc];
% kc = E(rho) = sup(rho)*bdp
kc=HArho(c*abc(3),[c, abc])*bdp;
psifunc.c1=[c, abc];
psifunc.kc1=kc;
% trueloc and truescale are the true values of the two parameters
trueloc=5;
truescale=2;
% n is sample size
n=20000;
u=truescale*randn(n,1)+trueloc;
% Just 2 outliers with point mass contamination
u(1:2)=10000000;
out=Mlocsca(u,psifunc);
disp('Robust estimate of location')
disp(out.location)
disp('Robust estimate of scale')
disp(out.scale)</pre></div></div></p></div></div><div id="example_3" class="example_module expandableContent"><div id="Example_3"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>Example of use of Mlocsca with four input arguments.</li></span></a></span></h3><div class="collapse"><p>
     M estimate of location and scale using optimal rho function with a
     value of c associated to a breakdown point of 0.3<div class="programlisting"><div class="codeinput"><pre class="matlab-code">psifuncOPT=struct;
psifuncOPT.class='OPT';
bdp=0.3;
cOPT=OPTbdp(bdp,1);
rhoOPTsup=OPTrho(200000,1);
% rhoOPTsup=1;
psifuncOPT.c1=cOPT;
% kc = E(rho) = sup(rho)*bdp
psifuncOPT.kc1=rhoOPTsup*bdp;
% trueloc and truescale are the true values of the two parameters
trueloc=5;
truescale=2;
% n is sample size
n=200;
u=truescale*randn(n,1)+trueloc;
% Just 10 outliers with point mass contamination
u(1:10)=10000000;
% 10 and 8 are our initial estimates of location and scale
out=Mlocsca(u,psifuncOPT,10,8);
disp('Robust estimate of location')
disp(out.location)
disp('Robust estimate of scale')
disp(out.scale)</pre></div></div></p></div></div><div id="example_4" class="example_module expandableContent"><div id="Example_4"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Example of use of Mlocsca with five input arguments.</li></span></a></span></h3><div class="collapse"><p>
     M estimate of location ans scale using power divergence rho function with a
     value of c associated to a breakdown point of 0.2<div class="programlisting"><div class="codeinput"><pre class="matlab-code">psifuncPD=struct;
psifuncPD.class='PD';
bdp=0.2;
c1=PDbdp(bdp);
psifuncPD.c1=c1;
psifuncPD.kc1=bdp;
% trueloc and truescale are the true values of the two parameters
trueloc=5;
truescale=2;
% n is sample size
n=200;
u=truescale*randn(n,1)+trueloc;
% Just 10 outliers with point mass contamination
u(1:20)=10000000;
% 10 and 8 are our initial estimates of location and scale
% Set the tolerance
tol=1e-20;
outIRWLS=Mlocsca(u,psifuncPD,10,8,tol);
disp('Robust estimate of location')
disp(outIRWLS.location)
disp('Robust estimate of scale')
disp(outIRWLS.scale)</pre></div></div><pre class="codeoutput">Robust estimate of location
    5.0739

Robust estimate of scale
    3.1579

</pre></p></div></div><div id="example_5" class="example_module expandableContent"><div id="Example_5"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>Example of use of Mlocsca with six input arguments.</li></span></a></span></h3><div class="collapse"><p>
     M estimate of location and scale using hyperbolic rho function with a
     value of c associated to a breakdown point of 0.11<div class="programlisting"><div class="codeinput"><pre class="matlab-code">psifuncHYP=struct;
psifuncHYP.class='HYP';
bdp=0.11;
[cHYP,A,B,d]=HYPbdp(bdp,1);
k=6;
rhoHYPsup=HYPrho(200000,[cHYP,k,A,B,d]);
% rhoHAsup=1;
psifuncHYP.c1=[cHYP,k,A,B,d];
% kc = E(rho) = sup(rho)*bdp
psifuncHYP.kc1=rhoHYPsup*bdp;
% trueloc and truescale are the true values of the two parameters
trueloc=5;
truescale=2;
% n is sample size
n=200;
u=truescale*randn(n,1)+trueloc;
% Just 10 outliers with point mass contamination
u(1:20)=10000000;
% 10 and 8 are our initial estimates of location and scale
% Set the tolerance
tol=1e-20;
% Set maximum number of iterations
maxiter=500;
out=Mlocsca(u,psifuncHYP,10,8,tol,maxiter);
disp('Robust estimate of location')
disp(out.location)
disp('Robust estimate of scale')
disp(out.scale)</pre></div></div></p></div></div></div><p> </p></div></div></div><div class="ref_sect" itemprop="content"><h2 id="Inputs">Input Arguments</h2><div class="expandableContent"><div class="arguments"><div class="input_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"> <div id="inputarg_y" class="clearfix"> </div> <h3 id="input_argument_y" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>y</code> &#8212; A vector with n elements which contains the response variable. </span>  </a><span class="example_desc">It can be both a row or column vector.</span></span></h3> <div class="collapse"> <p></p> <p class="datatypelist"><strong> Data Types: </strong><code>single| double</code></p> </div> </div><div class="expandableContent"> <div id="inputarg_psifunc" class="clearfix"> </div> <h3 id="input_argument_psifunc" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>psifunc</code> &#8212; a structure specifying the class of rho function to use, the
               consistency factor, and the value associated with the
               Expectation of rho in correspondence of the consistency
               factor. </span>  </a><span class="example_desc">struct.</span></span></h3> <div class="collapse"> <p>Psifunc is a struct which contains the following fields
       <table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>class</code></td><td><p><p>string identyfing the rho (psi) function to use.</p> <p>
                    Admissible values for class are 'bisquare', 'optimal'
                    'hyperbolic' and 'hampel'</p></p></td></tr><tr valign="top"><td><code>c1</code></td><td><p><p>consistency factor associated to required
                    breakdown point
                   More precisely, psifunc.c1(1) contains consistency
                   factor associated to required breakdown point or
                   nominal efficiency psifunc.c1(2:end) may contain other
                   parameters associated with the rho (psi) function.</p> <p>
                   For example, if psifunc.class is 'hampel', c1(2:4) must
                   contain parameters (a, b and c) of Hampel rho function.</p> <p>
                   If length(psifunc.c1)=1 psifunc.class is HA, then
                   default parameters for Hampel rho function are used.</p><p>
               Remark: if class is 'hyperbolic' it is also possible to
                   specify parameters k (sup CVC), A, B and d</p></p></td></tr><tr valign="top"><td><code>kc1</code></td><td><p>Expectation of rho associated with c1</p></td></tr></table></p> <p class="datatypelist"><strong> Data Types: </strong><code>struct</code></p> </div> </div><div id="optionalarguments" class="clearfix"></div><h3 id="namevaluepairs" class="bottom_ruled">Optional Arguments</h3><div class="expandableContent"> <div id="inputarg_initialmu" class="clearfix"> </div> <h3 id="input_argument_initialmu" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>initialmu</code> &#8212; starting value of the location estimate. </span>  </a><span class="example_desc">Scalar.</span></span></h3> <div class="collapse"> <p><p>The initial estimate of location to use in the first
               iteration.</p> <p>
               If not defined, initialmu is set equal to median(y).</p><p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code>0.34
</code></p> <p class="datatypelist"><strong> Data Types: </strong><code>double</code></p> </div> </div><div class="expandableContent"> <div id="inputarg_initialscale" class="clearfix"> </div> <h3 id="input_argument_initialscale" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>initialscale</code> &#8212; starting value of the dispersion estimate. </span>  </a><span class="example_desc">Scalar.</span></span></h3> <div class="collapse"> <p><p>The initial estimate of the scale to use in the first
               iteration.</p> <p>
               If not defined, initialscale is set equal to 1.4826*mad(y,1).</p><p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code>1.32
</code></p> <p class="datatypelist"><strong> Data Types: </strong><code>double</code></p> </div> </div><div class="expandableContent"> <div id="inputarg_tol" class="clearfix"> </div> <h3 id="input_argument_tol" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>tol</code> &#8212; scalar. </span>  </a><span class="example_desc">The tolerance for controlling convergence.</span></span></h3> <div class="collapse"> <p><p>If not defined, tol is fixed to 1e-7.</p> <p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code>1e-10
</code></p> <p class="datatypelist"><strong> Data Types: </strong><code>double</code></p> </div> </div><div class="expandableContent"> <div id="inputarg_maxiter" class="clearfix"> </div> <h3 id="input_argument_maxiter" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>maxiter</code> &#8212; scalar. </span>  </a><span class="example_desc">Maximum number of iterations to find the location estimate.</span></span></h3> <div class="collapse"> <p><p>If not defined, maxiter is fixed to 200.</p> <p>
               </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code>100
</code></p> <p class="datatypelist"><strong> Data Types: </strong><code>double</code></p> </div> </div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="OutputArgs" >Output Arguments</h2><div class="expandableContent"><div class="arguments"><div class="output_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"><div id="outputarg_outIRWLS" class="clearfix"></div><h3 id="output_argument_outIRWLS" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>outIRWLS</code> &#8212; description</span></a><span class="example_desc">Structure</span></span></h3><div class="collapse"><p>A structure containing the following fields:<table border="2" cellpadding="4" cellspacing="0" class="body"><colgroup><col width="20%"><col width="80%"></colgroup><thead><tr valign="top"><th valign="top">Value</th><th valign="top">Description</th></tr></thead><tr valign="top"><td><code>location</code></td><td><p>Location estimate. Estimate of location after
           refsteps refining steps</p></td></tr><tr valign="top"><td><code>scale</code></td><td><p>scale estimate. Estimate of scale after refsteps
           refining step</p></td></tr><tr valign="top"><td><code>weights</code></td><td><p>n-by-1 vector. Weights assigned to each
           observation</p></td></tr></table></p></div></div></div></div></div></div><div class="moreabout ref_sect"><h2 id="MoreAbout">More About</h2><div class="expandableContent"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent" itemprop="content"><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span>Additional Details</span></a></span></h3><div class="expand"><p>

 In the IRWLS (iterative reweighted least square) procedure the value of
 location and the value of the scale are updated in each step. In order to
 find simultaneous estimates of location and dispersion we need to solve
 the system of two equations
 \[
 \sum_{i=1}^n \psi_\text{loc}\left( \frac{y_i - \hat{\mu}}{\hat{\sigma}}\right)  =  0
 \]
 \[
 \sum_{i=1}^n \rho_\text{scale}\left( \frac{y_i - \hat{\mu}}{\hat{\sigma}}\right)  =  K.
 \]<p>

 In the two equations above we distinguish between $\rho_\text{scale}$ used for scale estimation
 and $\psi_\text{loc}$ and its derivatives used for location. The two need
 not be different and are, indeed, often the same. In this routine we
 assume that they are the same and are specified in input parameter psifunc.</p> <p>
 $K$ corresponds to input parameter psifunc.kc1.</p> <p>

 Given starting values $\hat{\mu}_0$ and $\hat{\sigma}_0$ the pair of reweighting equations moves forward from stage $k$ using the calculations<hr>[<b>1</b>] Find the location weights
 $ w_{i,k} = w\{(y_i - \hat{\mu}_k)/\hat{\sigma}_k\}$,
 Note that in order to find the weights we need psifunc.c1, the tuning
 constant associated to a nominal value of breakdown point or efficiency.</p><p><hr>[<b>2</b>] Calculate the new location estimate as
 </p>\[
 \hat{\mu}_{k+1} =
 \sum_{i=1}^n w_{i,k}y_i / \sum_{i=1}^n w_{i,k}.
 \]
 The new (squared) scale estimate is<hr>[<b>3</b>] 
 \[
 \hat{\sigma}^2_{k+1} = \hat{\sigma}^2_k\{{1}/(n K)\}\sum_{i=1}^n
 \rho_\text{scale}\{(y_i - \hat{\mu}_{k+1})/\hat{\sigma}_k\}.
\]<p>
 Note that in order to compute $\rho_\text{scale}$ we need psifunc.c1, the
 tuning constant associated to a nominal value of breakdown point or
 efficiency.  $K$ corresponds to input parameter psifunc.kc1.</p> <p><hr>[<b>4</b>] Return to Step 1 until the change in the estimates defined as
 </p>\[
  |\mu_{k+1}-\mu_{k}|/|\mu_{k}| +  |\sigma_{k+1}-\sigma_{k}|/\sigma_{k}
 \]<p>
 is less than a
 prespecified tolerance (optional input argument tol) or $k$
 is equal to optional input parameter maxiter (maximum number of
 iterations).</p> <p>

 This alternating algorithm converges to a point with zero derivatives,
 which may be a minimum, a maximum or a saddle point.</p><p>


</p><hr></p></div></div></div></div><div class="ref_sect" itemprop="content"><div class="bibliography"><h2 id="References">References</h2> <div><p>Maronna, R.A., Martin D. and Yohai V.J. (2006), "Robust Statistics, Theory
 and Methods", Wiley, New York.</p></div></div></div><div class="ref_sect"><h2 id="SeeAlso">See Also</h2><p><span itemprop="seealso"><a href="Mlocation.html" itemprop="url"><span itemprop="name"><code>Mlocation</code></span></a></span> | <span itemprop="seealso"><a href="Mscale.html" itemprop="url"><span itemprop="name"><code>Mscale</code></span></a></span> | <span itemprop="seealso"><a href="Sreg.html" itemprop="url"><span itemprop="name"><code>Sreg</code></span></a></span></div><i>This page has been automatically generated by our routine <a href="publishFS.html">publishFS</a></i></div></section></div></div></div></div><div id="divbottom"></div></body></html>