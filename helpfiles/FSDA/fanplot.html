<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<!--FScategory:Dynamic Statistical Visualization-->

<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>fanplot:: Functions (Flexible Statistics Data Analysis Toolbox&trade;)</title>
<link href="docstyle.css" rel="stylesheet" type="text/css">
<meta content="refpage" name="chunktype">


<script  type="text/javascript" language="javaScript" src="bottom.js"></script>

</head>


<body>



<a name="top_of_page"></a>
<p style="font-size: 1px;">&nbsp;</p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr>
		<td valign="baseline"><b>Flexible Statistics Data Analysis Toolbox&trade;</b></td>
		<td align="right" valign="baseline"><a href="estepfs.html">
		<img align="bottom" alt="dsxy2figxy" border="0" src="images_help/b_prev.gif"></a>&nbsp;&nbsp;
		<a href="fscolors.html">
		<img align="bottom" alt="FSM" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<a name="bq24of9-1"></a><a class="indexterm" name="zmw57dd0e69698"></a>
<h1 class="reftitle">fanplot</h1>

<p class="purpose">Simultaneous forward plot of the <a href="transf_score.html">Score</a> statistic Tp(k)
for several values of the transformation parameter &lambda; in each step of the forward search.
	</p>
<h2>Syntax </h2>
<p class="synopsis"><tt>fanplot(out)<br>fanplot(out,<i><tt>param1</tt></i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)<br>
</tt></p>
<a name="bq24of9-2"></a>
<h2>Description</h2>
<p><tt>fanplot(out)</tt> uses as input the output of function FSRfan. The fan 
plot enables us to appraise in a quantitative way the percentage of observations 
in agreement with the different values of the transformation parameter 
</p>
<p><tt>y</tt> is a vector of length n containing the response values, while <tt>X</tt> is the <i>n</i>-by-<i>p-1</i> matrix  
which contains (in the columns) the values of <i>p-1</i> predictive terms</p>
<p><tt><a name="bq24of9-3"></a>fanplot(out)</tt> needs as input the following information
</p>
<ul type="disc">
	<li><tt>out</tt> &minus; A structure of additional statistics with the following fields.
	<ul type="circle">
		<li>
		<p><tt>Score</tt> &minus; <tt>(n-init)</tt>-by-<tt>length(la)+1</tt> matrix containing the values of the
              score test for each value of the transformation parameter
              <br>1st col = fwd search index 
              <br>2nd col = value of the score test in each step of the 
              fwd search for <tt>la(1)</tt> 
              <br>...........
              <br>end col = value of the score test in each step of the fwd
              search for <tt>la(end)</tt> </p>
		</li>
		<li>
		<p><tt>la</tt> &minus; vector containing the values of lambda for which fan plot
              is constructed</p>
		</li>
		
		<li>
		<p><tt>bs</tt> &minus;<tt>p</tt>-by-<tt>length(la)</tt>   matrix containing the units forming
              the initial subset for each value of lambda</p>
		</li>

		<li>
		<p><tt>Un</tt> &minus; cell of size length(la). 
              <tt>out.Un{i}</tt> is a <tt>(n-init)</tt>-by-11 matrix which contains the unit(s) included in
              the subset at each step in the search associated with <tt>la(i)</tt>.
              REMARK: in every step the new subset is compared with the old subset. Un
              contains the unit(s) present in the new subset but not in
              the old one <tt>Un(1,2:end)</tt> for example contains the unit included
              in step init+1 <br>...<br> <tt>Un(end,2:end)</tt> contains the units included in the
              final step of the search </p>
		</li>
		<li>
		<p><tt>y</tt> &minus; A vector with n elements that contains the response
              variable which has been used		</p>
		</li>
		
		<li>
		<p><tt>X</tt> &minus; Data matrix of explanatory variables
              which has been used (it also contains the column of ones if
              input option intercept was missing or equal to 1)	</p>
		</li>
		
	</ul>
	
	
</ul>
<p></p>
<p><tt>fanplot(out,<i><tt>param1</tt></i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)</tt> 
specifies one or more of the name/value pairs described in the following table.</p>
<table border="2" cellpadding="4" cellspacing="0" class="body">
	<colgroup>
		<col width="21%"><col width="79%">
	</colgroup>
	<thead>
		<tr valign="top">
			<th bgcolor="#B2B2B2">Parameter</th>
			<th bgcolor="#B2B2B2">Value</th>
		</tr>
	</thead>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;conflev&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p>Confidence level for the bands (default is 0.99 that is
                  we plot two horizontal lines in correspondence of value
                  -2.58 and 2.58)</p>
		</td>
	</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;datatooltip&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p>Empty value or structure. The default is datatooltip=''. <br>If datatooltip is not empty the user can use the mouse
                  in order to have information about the unit selected,
                  the step in which the unit enters the search and the
                  associated label. <br>If datatooltip is a structure, it is
                  possible to control the aspect of the data cursor (see
                  function datacursormode for more details or the
                  examples below). The default options of the structure
                  are DisplayStyle='Window' and SnapToDataVertex='on'.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;label&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		  Cell containing the labels of the units (optional
              argument used when <tt>datatooltip=1</tt>. If this field is not
              present labels row1, ..., rown will be automatically
              created and included in the pop up <tt>datatooltip</tt> window)
              </td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;databrush&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>The core of this option is <tt>selectdataFS</tt>, a function used by 
		all graphic tools of the FSDA toolbox. A separate 
		common page details all <a href="databrushoption.html"><tt>databrush</tt> options</a>. </p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;xlimx&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>vector with two elements controlling minimum and maximum
                  of the x axis. Default value is [init n].</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;ylimy&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>vector with two elements controlling minimum and
                  maximum of the y axis. Default value for 
                  ylimy(1)=max(min(score_test),-20). Default value for
                  ylimy(2)=min(max(score_test),20).</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;lwdenv&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>Scalar which controls the line with of the horizontal lines associated
                  with the envelopes. Default is lwdenv=1.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;nameX&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>cell array of strings of length <em>p</em> containing the labels
                  of the variables of the regression dataset. If it is empty
                	(default) the sequence <em>X</em><sub>1</sub>, ..., <em>X</em><sub>p</sub> will be created
                  automatically..</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;namey&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		character containing the label of the response.</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;titl&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		a label for the title (default: 'Fan plot') 
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;labx&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		a label for the x-axis (default: 'Subset size m').</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;laby&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		a label for the y-axis (default: &#39;Score test statistic').</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;lwd&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		Scalar which controls line width of the curves which
                  contain the score test. Default line width=2. 
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;FontSize&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		Scalar which controls the font size of the labels of
                  the axes. Default value is 12.</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;SizeAxesNum&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		Scalar which controls the size of the numbers of the
                  axes. Default value is 10.</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;tag&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		 String which identifies the handle of the plot which is about to be created. 
		 The default is to use tag pl_fan. Notice that if the program finds a plot which
                 has a tag equal to the one specified by the user, then
                 the output of the new plot overwrites the existing one
                 in the same window else a new window is created.</td>
	</tr>
	</table>
<p></p>
<a name="bq9x7hn"></a><a name="bq5gf2y"></a>
<h3>Examples</h3>

<h3>Example 1</h3>
<p>Robust analysis of transformations for the <tt>wool dataset</tt>:</p>

<pre class="programlisting">
% Load wool data: 27 observations and 3 explanatory variables
XX=load('wool.txt');
y=XX(:,end);
X=XX(:,1:end-1);
% Function FSRfan stores the score test statistic. 
% In this case we use the five most common values of lambda are considered
[out]=FSRfan(y,X);
% Produce a fan plot and display it on the screen
fanplot(out);
</pre>

<p>The fan plot shows the log transformation is diffused throughout the data and does not depand on the 
presence of particular observations.</p>

<p><img alt="" height="589" src="plots/wooll_fan.jpg" width="717"></p>

<h3>Example 2</h3>
<p>Robust analysis of transformations for the <tt>loyalty cards dataset</tt>:</p>

<pre class="programlisting">
    XX=load('loyalty.txt');
    namey='Sales'
    y=XX(:,end);
    nameX={'Number of visits', 'Age', 'Number of persons in the family'};
    X=XX(:,1:end-1);
    % la = vector contanining the most common values of the transformation
    % parameter
    la=[0 1/3 0.4 0.5];
    % Store the score test statistics for the specified values of lambda
    % and automatically produce the fan plot
    [out]=FSRfan(y,X,'la',la,'init',size(X,2)+2,'plots',1,'lwd',3);

</pre>
<p>
The fan plot shows the even if the third root is the best value of the transformation
parameter at the end of the search in earlier steps it lies very close to the upper rejection region.
The best value of the transformation parameter seems to be the one associated with l=0.4 
which is always the confidence bands but at the end of search, due to the presence 
of particular observations it goes below the lower rejection line. 
</p>
<p><img alt="" src="plots/loyalty.jpg" height="699" width="859"></p>

<a name="bq24of9-11"></a>
<h2>See Also</h2>
<p><a href="score.html"><tt>Score</tt></a>, <a href="fsrfan.html"><tt>FSRfan</tt></a>,
</p>

<p>
<p></p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr valign="top">
		<td align="left" width="20"><a href="estepfs.html">
		<img align="bottom" alt="dsxy2figxy" border="0" src="images_help/b_prev.gif"></a>
		</td>
		<td align="left">estepfs.html</td>
		<td>&nbsp;</td>
		<td align="right">fscolors.html</td>
		<td align="right" width="20"><a href="fscolors.html">
		<img align="bottom" alt="FSM" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<script type ="text/javascript" language="javaScript">
document.write(barra);
</script>
<!-- Last updated: Fri Jan 23 17:00:05 EST 2009-->




</body>

</html>
