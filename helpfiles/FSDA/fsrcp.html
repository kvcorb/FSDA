<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<!--FScategory:Robust Model Selection-->



<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>FSRcp :: Functions (Flexible Statistics Data Analysis Toolbox&trade;)</title>
<link href="docstyle.css" rel="stylesheet" type="text/css">
<meta content="refpage" name="chunktype">

<meta content="function:FSRcp" name="refentity">
<meta content="text/javascript" http-equiv="Content-Script-Type">
<meta content="fcn" name="toctype">

<script  type="text/javascript" language="javaScript" src="bottom.js"></script>

</head>


<body>



<a name="top_of_page"></a>
<p style="font-size: 1px;">&nbsp;</p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr>
		<td valign="baseline"><b>Flexible Statistics Data Analysis Toolbox&trade;</b></td>
		<td align="right" valign="baseline"><a href="fsrcore.html">
		<img align="bottom" alt="" border="0" src="images_help/b_prev.gif"></a>&nbsp;&nbsp;
		<a href="fsreda.html">
		<img align="bottom" alt="FSReda" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>

<a name="bq24of9-1"></a><a class="indexterm" name="zmw57dd0e69698"></a>

<h1 class="reftitle">FSRcp</h1>
<p class="purpose">Cp and AIC monitoring for all models of interest of size <tt>smallp </tt> </p>
<h2>Syntax  </h2>
<p class="synopsis"><tt>[outCp] = FSRcp(y,X,smallp)<br>[outCp] = FSRcp(y,X,smallp,</tt><tt><i>param1</i></tt><tt>,</tt><tt><i>val1</i><tt>,</tt><i>param2</i><tt>,</tt><i>val2</i><tt>,...)<br>

</tt>
</tt></p>

<a name="f4811966"></a>

<h2>Description  </h2>
<p><tt>FSRcp(y,X)</tt> gives in structure outCp Mallows <em>C<sub>p</sub></em>(<em>m</em>) (and eventually AIC) monitored for all specified model of size smallp
</p>
<p><tt>y</tt> is a vector of length n containing the response values, while 
 <tt>
X</tt> is the <i>n</i>-by-<i>p-1</i> matrix which contains (in the columns) the values 
of <i>p-1</i> predictive terms. <tt>
smallp</tt> is a scalar which specifies the number of variables in the
              reduced models which will be considered </p>
<p><tt>[out] = FSRcp(y,X,smallp)</tt> returns the following information

</p>
<ul type="disc">
	<li><tt>outCp</tt> &minus; A structure of additional statistics with the following fields.
	
	<ul type="circle">
		<li>
		<p><tt>ListOut</tt> &minus; <tt>k</tt>-by-1 vector containing the list of the units declared 
		as outliers or NaN if the sample is considered homogeneous  </p>
		</li>
		<li>
		<p><tt>MAL</tt> &minus;  <tt>n-init+1</tt>-by-<tt>k</tt>+1 matrix which contains Mallows 
		Cp monitored for the <tt>k</tt> considered models. <br>1st col = fwd search index
		<br>2nd 
		col = <em>C<sub>p</sub></em> monitored for first selected model<br>3rd 
		col = <em>C<sub>p</sub></em> monitored for second sel</p>
		<p>cted model
		<br>
		...
		<br> (k+1)th col. = <em>C<sub>p</sub></em> monitored for <tt>k</tt>-th selected model</p>
		<p>Remark:  notice that k &#8804; (n choose <tt>smallp</tt>) and that all
                  models contain the constant </p>
		</li>
	
	<li>
		<p><tt>AIC</tt> &minus;  <tt>n-init+1</tt>-by-k+1 matrix which contains AIC
		 monitored for the k considered models. <br>1st col = fwd search index
		<br>2nd 
		col = AIC monitored for first selected model<br>3rd 
		col = AIC monitored for second selected model
		<br>
		...
		<br> (k+1)th col.= AIC monitored for k-th selected model</p>
		<p>Remark:  notice that k &#8804; (n choose smallp), that all
                  models contain the constant and 
                  that matrix AIC is produced only if input option <tt>aic</tt>=1 </p>
		</li>
	

	<li>
		<p><tt>Unall</tt> &minus; cell of dimension k. Each element of the cell contains
		a <tt>(n-init)</tt>-by-11 matrix which contains the unit(s) included 
		in the subset at each step of the fwd search. <br>REMARK: in every step 
		the new subset is compared with the old subset. Un contains the unit(s) 
		present in the new subset but not in the old one for the particular considered model.</p>
		</li>
		<li>
		<p><tt>LAB</tt> &minus; cell array of strings of length <tt>k</tt> containing the labels of the
                  models which have been extracted. First element of LAB
                  is associated with second column of matrix MAL...</p>
		</li>
		
		<li>
		<p><tt>Ajout</tt> &minus; numeric matrix which contains the list of the models whose Cp
                  values are inacceptable.
                  The number of columns of matrix Ajout is equal to smallp
                  This information is useful because in this way it is
                  possible to skip the computation of the submodels of
                  the rows of matrix Ajout. <br>
                  For example if <tt>smallp</tt>=3, <tt>bigP</tt>=6 and
                  <tt>Ajout</tt> = [ 2 3;
                            2 4;
                            2 7];
                  <br>the three models 23, 24, and 27 always have <em>C<sub>p</sub></em> values
                  much greater than the threshold (that is variables
                  2,3,4,7 are considered unimportant)</p>
		</li>
<li>
<tt>LABout</tt> &minus; 
cell array of strings which which contains as
                  strings the list of models which are inacceptable. Notice that
                  LABout is created only if option <tt>labout</tt>=1
</li>
	</ul>
	<ul>
		
		<a name="zmw57dd0e69798"></a>
		
		<table border="1" cellpadding="5" cellspacing="0" class="note" summary="Note">
			<tr width="90%">
				<td>
				<p><b>Note</b>&nbsp;&nbsp;  <tt>
				FSRcp</tt> automatically includes a 
				constant term in all models. Do not enter a column of 1s directly 
				into  <tt>X</tt>.</p>
				</td>
			</tr>
		</table>
	</ul>
	</li>
</ul>
<p></p>
<p><tt>[out] = FSRcp(y,X,<i>smallp,param1</i></tt><tt>,</tt><tt><i>val1</i><tt>,</tt><i>param2</i><tt>,</tt><i>val2</i><tt>,...)</tt></tt> 
specifies one or more of the name/value pairs described in the following table.</p>
<table border="2" cellpadding="4" cellspacing="0" class="body">
	<colgroup>
		<col width="21%"><col width="79%">
	</colgroup>
	<thead>
		<tr valign="top">
			<th bgcolor="#B2B2B2">Parameter</th>
			<th bgcolor="#B2B2B2">Value</th>
		</tr>
	</thead>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;intercept&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>If 1, a model with constant term will be fitted (default) else no constant 
		term will be included.   </p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;nocheck&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>Scalar. If nocheck is equal to 1 no check is performed on matrix <em>
		y</em> and matrix <em>X</em>. Notice that <em>y</em> and <em>X</em> are 
		left unchanged. In other words the additional column of ones for the intercept 
		is not added. As default  <tt>nocheck=0</tt>.</p>
		</td>
	</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;h&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p>The number of observations that have determined the least trimmed squares 
		estimator.  The default value of <tt>h</tt> is  
		 <tt>[(n+smallp+1)/2]</tt> 
		</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;lms&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Scalar. If  <tt>lms=1</tt> (default) Least Median of Squares is computed, 
		else Least trimmed squares is computed.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;nomes&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Scalar. If <tt>nomes</tt> is equal to 1 (default) no message about
                estimated time to compute LMS (LTS) for each considered
                model is displayed, else a message about estimated time
                is displayed.</p>
		</td>
	</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;nsamp&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Number of subsamples which will be extracted to find the robust estimator. 
		If  <tt>nsamp=0</tt> all subsets will be extracted. They will be 
		 <tt>(n choose 
		p)</tt>. Remark: if the number of all possible subset is smaller than 1000 
		the default is to extract all subsets otherwise just 1000.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;init&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Scalar which specifies the initial subset size to start monitoring the required quantities, 
		if init is not specified it will be set equal to   		
		<br><tt>smallp+1</tt>, if the sample size is smaller than 40; <br><tt>min(3*smallp+1,floor(0.5*(n+smallp+1)))</tt>, otherwise.</td>
			</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;aic&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Scalar, scalar. If <tt>aic</tt>=1 the value of AIC is also stored in each
                step of the search else (default) only Mallows Cp is stored 
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;labels&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>cell array of strings of length <tt>bigP</tt>-1 containing the
                names of the explanatory variables. If labels is a missing
                value the following sequence of strings will be
                automatically created for X <br>
                (1,2,3,4,5,6,7,8,9,A,B,C,D,E,E,G,H,I,J,K,...,Z)</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;fin_step&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>scalar specifying the portion of the search which has to be
                monitored to choose the best models 
                If fin_step is an integer greater
                or equal 1, it refers to the number of steps.
                For example if fin_step=10 the program considers the last
                10 steps to choose the best models.
                If fin_step is a real number alpha (0 &lt;
 alpha &#8804; 0.5) in the
                interval (0 0.5] than the program considers the last
                <tt>round(n*alpha)</tt> steps. As default <tt>fin_step</tt>=round(n*0.2)
                that is the last 20% of the steps are considered.
                <br>Remark1: the number of best models to consider is
                controlled by scalar <tt>first_k</tt> (see below)
                <br>Remark2: if fin_step is an empty value, no selection is
                done and all trajectories of Cp are displayed (in this
                case the value of <tt>first_k</tt> below is ignored, all models are
                considered of interest and output matrix <tt>outCp.Ajout</tt> is
                equal to an empty value)
		
		</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;first_k&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>scalar which specifies the number of best models to
                consider in each of the last <tt>fin_step</tt>. For example if
                <tt>first_k</tt>=5 in each of the last <tt>fin_step</tt>, the models which had
                the 5 smallest values of Cp are considered. As default
                <tt>first_k=3</tt>.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;Excl&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Matrix which contains the models which surely do not have
                to be considered. As default <tt>Excl==''</tt>
                <br>For example if <tt>smallp</tt>=3, <tt>bigP</tt>=6 and
                <br>  <tt>Excl</tt> = [ 2 3;
                            2 4;
                            2 7];
                <br>the three models 23, 24, and 27 are skipped</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;ExclThresh&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>scalar. Exclusion threshold associated to the upper
                percentage point of the F distribution of <em>C<sub>p</sub></em> which
                defines the threshold for declaring models as unuseful.
                The default value of <tt>ExclThresh</tt> is 0.99999 that is the
                models whose minimum value of <em>C<sub>p</sub></em> in the part of the
                search defined by <tt>fin_step</tt> is above <tt>ExclThresh</tt> are stored
                in output matrix outCp.Ajout. Notice that <tt>ExclThresh</tt> must
                be smaller than 1 </p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;labout&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>scalar. If <tt>labout</tt>=1 the output structure contains a cell
                array of string named LABOUT which contains the list of
                the models whose Cp values are inacceptable else
                (default) no model is created.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 142px"><tt>&#39;plots&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 142px">
		<p>scalar. <br>If plots==1 a plot is created on the screen which
                contains the trajectories of Cp monitored along the
                search with confidence bands
                <br>If plots==2 two plots are generated. The first contains
                the trajectories of Cp monitored along the search with
                confidence bands. The second contains the trajectories of
                AIC monitored along the search
                <br>else (default) no plot is shown on the screen. </p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2">&nbsp;</td>
		<td bgcolor="#F2F2F2">
		<p>Remark: the options below only work if <tt>plots</tt>=1</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;quant&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>vector which specifies the quantiles which are used to produce Cp 
		envelopes (the elements of quant are numbers between 0 and 1). The 
		default value of quant is quant=[0.025 0.5 0.975]</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;steps&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>vector which specifies in which steps of the plot which
                monitors Cp (AIC) it is
                necessary to include the labels of the models which have been
                previously chosen. The default is to write the labels of
                the models in steps <tt>round([n*0.5 n*0.8 n]);</tt>.
                <br> 
</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;titl&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>A label for the title (default: &#39;Forward Cp when 
		smallp=<tt>smallp</tt>&#39;).</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;labx&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>A label for the x-axis (default: &#39;Subset size m&#39;)</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;laby&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>A label for the y-axis (default: &#39;&#39;).</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 53px"><tt>&#39;xlimx&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 53px">
		<p>Vector with two elements controlling minimum and maximum on the x axis. 
		Default value is &#39;&#39; (automatic scale).</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;ylimy&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p>Vector with two elements controlling minimum and maximum on the x axis. 
		Default value is &#39;&#39; (automatic scale)</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;lwd&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Scalar which controls line width of the trajectories of residuals. Default line width=0.5. </p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;lwdenv&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>Scalar which controls the width of the lines associated with the envelopes. 
		Default is <tt>lwdenv=1</tt></p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;FontSize&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>Scalar which controls the font size of the labels of the axes. Default 
		value is 12.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;SizeAxesNum&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		Scalar which controls the size of the numbers of the
                  axes. Default value is 10.</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;selunitcolor&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p>cell containing the colors to be used for the trajectories associated 
		with the units in selunit. If length(selunitcolor)==1 the same color will 
		be used for all units in vector selunit <br>Remark: if for example length(selunitcolor)==2 
		and length(selunit)=6 the 3 highlighted trajectories which appear with selunitcolor{1} 
		and 3 highlighted trajectories with selunitcolor{2}</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;selunittype&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p>cell containing the line type of the curves</p>
		</td>
	</tr>
</table>
<p></p>

<a name="bq9x7hn"></a><a name="bq5gf2y"></a>

<h3>Examples</h3>

<h3>Example 1</h3>
Let us consider the ozone data.


<pre class="programlisting">
    % Load Ozone data (reduced set)
    X=load('ozone.txt');
    % Transform the response using logs
    X(:,end)=log(X(:,end));
    % Add a time trend
    X=[(-40:39)' X];
    % Define y
    y=X(:,end);
    % Define X
    X=X(:,1:end-1);
    % Extract the best models of size 4 and show the plot of Cp
    % All the default options are used therefore the plot of Cp and the
    % output matrix Cpmon.MAL only contains the searches associated with the
    % smallest 3 values of Cp in the last 16 steps of the search
    smallp=4;
    labels={'Time','1','2','3','4','5','6','7','8'};
    [Cpmon]=FSRcp(y,X,smallp,'plots',1,'labels',labels);

</pre>

<p> The monitoring of the trajectories of
Cp produces the following plot&nbsp;


</p>
<p>Clearly the plot becomes unreadable when there are a lot of trajectories. In 
order to solve this problem it is necessary to produce the candle stick plot.</p>
<p><img alt="" src="images_help/fsrcpsmallp4.jpg">&nbsp;</p>
<p>&nbsp;</p>

<h3>Example 2</h3>

In the example which follows we consider the best models of size 6 and 5,
    and plot the trajectories of <em>C<sub>p</sub></em>(<em>m</em>).
    Use labels defined by the user. 
    Extract 1000 subsets to initialize the search
    Finally when <tt>smallp</tt>=5 we exclude the searches of the models which were defined unacceptable for
    <tt>smallp</tt>=6.

<pre class="programlisting">
smallp=6;
labels={'Time','1','2','3','4','5','6','7','8'};
[Cpmon6]=FSRcp(y,X,smallp,'nsamp',1000,'plots',1,'labels',labels);
smallp=5;
[Cpmon5]=FSRcp(y,X,smallp,'nsamp',1000,'Excl',Cpmon6.Ajout,'plots',1,'labels',labels);
</pre>

<p>The plot below shows all the trajectories which have been selected when 
smallp=6.</p>
<p><img alt="" src="images_help/FSRcpsmallpp6.jpg"></p>
<p>The plot below shows the selected trajectories for <tt>smallp</tt>=5 after excluding 
the models contained in those considered unuseful for  
<tt>smallp</tt>=6</p>
<p><img alt="" src="images_help/FSRcpsmallpp5.jpg"></p>
<h3>See Also</h3>
<p><a href="cdsplot.html"><tt>cdsplot</tt></a>,  
  <a href="fsrms.html"><tt>FSRms</tt></a>, <a href="fsraddt.html"><tt>FSRaddt</tt></a></p>
<p></p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	
	<tr valign="top">
		<td align="left" width="20"><a href="fsrcore.html">
		<img align="bottom" alt="FSRbsb" border="0" src="images_help/b_prev.gif"></a>
		</td>
		<td align="left">fsrcore.html</td>
		<td>&nbsp;</td>
		<td align="right">fsreda.html</td>
		<td align="right" width="20"><a href="fsreda.html">
		<img align="bottom" alt="FSReda" border="0" src="images_help/b_next.gif"></a></td>
	</tr>

	
	
</table>

<script type ="text/javascript" language="javaScript">
document.write(barra);
</script>


<!-- Last updated: Fri Jan 23 17:00:05 EST 2009-->



</body>

</html>
