<?xml version="1.0" encoding="utf-8"?>
<HelpXML>
   <Title><!--This is simply the filename-->FSRr</Title>
   <Purpose><!--This is the second line of the .m file-->Forward search in linear regression reweighted</Purpose>
   <Description><!--Description section-->FSRr uses the units not declared by outliers by  FSR to produce a robust fit.&#xD;
   The units whose residuals exceeds the threshold determined by option&#xD;
   alpha are declared as outliers. Moreover, it is possible in option&#xD;
   R2th to modify the estimate of sigma2 which is used to declare&#xD;
   the outliers. This is useful when there is almost a perfect fit in the&#xD;
   data, the estimate of the error variance is very small and therefore&#xD;
   there is the risk of declaring as outliers very small deviations from&#xD;
   the robust fit. In this case the estimate of sigma2 is corrected in&#xD;
   order to achieve a value of R2 equal to R2th.</Description>
   <InpArgs><!--REQUIRED INPUT ARGUMENT SECTION-->
      <Item>
         <Name>y</Name>
         <ShortDesc>Response variable</ShortDesc>
         <TypeInd>Vector</TypeInd>
         <LongDesc>Response variable, specified as&#xD;
               a vector of length n, where n is the number of&#xD;
               observations. Each entry in y is the response for the&#xD;
               corresponding row of X.&#xD;
               Missing values (NaN's) and infinite values (Inf's) are&#xD;
               allowed, since observations (rows) with missing or infinite&#xD;
               values will automatically be excluded from the&#xD;
               computations.</LongDesc>
         <Example> </Example>
         <DataType>single| double</DataType>
         <ReqArg>1</ReqArg>
         <Struct> </Struct>
      </Item>
      <Item>
         <Name>X</Name>
         <ShortDesc>Predictor variables</ShortDesc>
         <TypeInd>Matrix</TypeInd>
         <LongDesc>Matrix of explanatory&#xD;
               variables (also called 'regressors') of dimension n x (p-1)&#xD;
               where p denotes the number of explanatory variables&#xD;
               including the intercept.&#xD;
               Rows of X represent observations, and columns represent&#xD;
               variables. By default, there is a constant term in the&#xD;
               model, unless you explicitly remove it using input option&#xD;
               intercept, so do not include a column of 1s in X. Missing&#xD;
               values (NaN's) and infinite values (Inf's) are allowed,&#xD;
               since observations (rows) with missing or infinite values&#xD;
               will automatically be excluded from the computations.</LongDesc>
         <Example> </Example>
         <DataType>single| double</DataType>
         <ReqArg>1</ReqArg>
         <Struct> </Struct>
      </Item>
   </InpArgs>
   <OptArgs><!--OPTIONAL (NAME/PAIRS) INPUT ARGUMENT SECTION-->
      <Item>
         <Name>alpha</Name>
         <ShortDesc>test size</ShortDesc>
         <TypeInd>Scalar</TypeInd>
         <LongDesc>Number between 0 and 1 which&#xD;
              defines test size to declare the outliers. The default value&#xD;
              is 0.01.&#xD;
                 </LongDesc>
         <Example> 'alpha',0.01&#xD;
                 </Example>
         <DataType>double</DataType>
         <Struct> </Struct>
      </Item>
      <Item>
         <Name>R2th</Name>
         <ShortDesc>R2 threshold</ShortDesc>
         <TypeInd>Scalar</TypeInd>
         <LongDesc>Scalar which defines the value R2 does&#xD;
              have to exceed. For example if R2 based on good observations&#xD;
              is 0.92 and R2th is 0.90 the estimate of the variance of the&#xD;
              residuals which is used to declare the outliers is adjusted&#xD;
              in order to have a value of R2 which is equal to 0.90. A&#xD;
              similar correction is applied to compute the prediction&#xD;
              intervals. The default value of R2th is 1 which means that&#xD;
              there is no correction.&#xD;
                 </LongDesc>
         <Example> 'R2th',0.99&#xD;
                 </Example>
         <DataType>double</DataType>
         <Struct> </Struct>
      </Item>
      <Item>
         <Name>fullreweight</Name>
         <ShortDesc>Option to declare outliers</ShortDesc>
         <TypeInd>Boolean</TypeInd>
         <LongDesc>If fullreweight is true&#xD;
              (default option), the list of outliers refers to all the&#xD;
              units whose residuals is above the threshold else if it is&#xD;
              false the outliers are the observaions which by procedure&#xD;
              FSR had been declared outliers and have a residual greater&#xD;
              than threshold&#xD;
                 </LongDesc>
         <Example> 'fullreweight',true&#xD;
                 </Example>
         <DataType>double</DataType>
         <Struct> </Struct>
      </Item>
      <Item>
         <Name>plotsPI</Name>
         <ShortDesc>Plot of prediction intervals</ShortDesc>
         <TypeInd>Scalar</TypeInd>
         <LongDesc>If plotsPI =1 and&#xD;
               the number of regressors (excluding the constant term) is&#xD;
               equal 1, it is possible to see on the screen the yX scatter&#xD;
               with superimposed the prediction intervals using a&#xD;
               confidence level 1-alpha, else no plot is shown on the&#xD;
               screen&#xD;
                 </LongDesc>
         <Example> 'plotsPI',1&#xD;
                 </Example>
         <DataType>double</DataType>
         <Struct> </Struct>
      </Item>
   </OptArgs>
   <OutArgs><!--OUTPUT ARGUMENT SECTION-->
      <Item>
         <Name>out</Name>
         <ShortDesc> </ShortDesc>
         <TypeInd> </TypeInd>
         <LongDesc> </LongDesc>
         <Struct>
            <ItemCell>
               <Value>outliers</Value>
               <Description>k x 1 vector containing the list of the units declared&#xD;
                  outliers by procedure FSR or NaN if the sample is&#xD;
                  homogeneous</Description>
            </ItemCell>
            <ItemCell>
               <Value>beta</Value>
               <Description>p-by-1 vector containing the estimated regression parameter&#xD;
                  by procedure FSR</Description>
            </ItemCell>
            <ItemCell>
               <Value>outliersr</Value>
               <Description>k1-by-1 vector containing the list of the units declared&#xD;
                  outliers after the reweighting step or NaN if the sample is&#xD;
                  homogeneous</Description>
            </ItemCell>
            <ItemCell>
               <Value>betar</Value>
               <Description>p-by-1 vector containing the estimated regression parameter&#xD;
                  after the reweighting step</Description>
            </ItemCell>
            <ItemCell>
               <Value>rstud</Value>
               <Description>n-by-2 matrix.&#xD;
                   First column = studentized residuals&#xD;
                   Second column = p-values (computed using as reference&#xD;
                   distribution the Student t)</Description>
            </ItemCell>
         </Struct>
      </Item>
      <Item>
         <Name>varargout</Name>
         <ShortDesc> xnew is a vector</ShortDesc>
         <TypeInd>xnew = vector with a number of new points where to evaluate the&#xD;
                  prediction interval.</TypeInd>
         <LongDesc>&#xD;
          ypred = values predicted by the fitted model on xnew. Vector of&#xD;
                  length(xnew)&#xD;
           yci  = Confidence intervals. A two-column matrix with each row providing&#xD;
                  one interval.</LongDesc>
         <Struct> </Struct>
      </Item>
   </OutArgs>
   <MoreAbout><!--MORE ABOUT SECTION--></MoreAbout>
   <Acknowledgements><!--ACKNOWLEDGEMENTS SECTION--></Acknowledgements>
   <References><!--REFERENCES SECTION--></References>
   <SeeAlso><!--SEE ALSO SECTION-->
      <Item>FSR</Item>
   </SeeAlso>
   <Ex><!--EXAMPLES SECTION-->
      <Item>
         <Title>Example of outlier detection in a case of almost perfect fit.</Title>
         <Desc/>
         <MATLABcode>
        randn('state', 123456);&#xD;
        n=200; p=1;&#xD;
        X = rand(n,p);&#xD;
        y = X + 0.01*randn(n,1);&#xD;
        % contaminated data points&#xD;
        ycont = y;&#xD;
        ycont(1:5) = ycont(1:5)+0.07;&#xD;
       &#xD;
        [out1 , xnew1 , ypred1, yci1] = ...&#xD;
                FSRr(ycont,X,'alpha',0.01,...&#xD;
                    'fullreweight',true ,'plotsPI',1,'plots',0);&#xD;
&#xD;
        h1 = allchild(gca); a1 = gca; f1 = gcf;&#xD;
        &#xD;
        [out2 , xnew2 , ypred2, yci2] = ...&#xD;
                FSRr(ycont,X,'alpha',0.01,'R2th',0.9,...&#xD;
                    'fullreweight',true ,'plotsPI',1,'plots',0);&#xD;
&#xD;
        h2 = allchild(gca); a2 = gca; f2 = gcf;&#xD;
&#xD;
        % move the figure above into a single one with two panels&#xD;
        figure; ax1 = subplot(2,1,1); ax2 = subplot(2,1,2);&#xD;
        copyobj(h1,ax1); title(ax1,get(get(a1,'title'),'string'));&#xD;
        copyobj(h2,ax2); title(ax2,get(get(a2,'title'),'string'));&#xD;
        close(f1); close(f2);&#xD;
&#xD;
        disp(['Outliers without R2 adjustment = ' num2str(out1.outliersr)]);&#xD;
        disp(['Outliers with    R2 adjustment = ' num2str(out2.outliersr)]);&#xD;
        &#xD;</MATLABcode>
         <Exec>0</Exec>
      </Item>
      <Item>
         <Title> </Title>
         <Desc> </Desc>
         <MATLABcode> </MATLABcode>
         <Exec>0</Exec>
      </Item>
      <Item>
         <Title> </Title>
         <Desc> </Desc>
         <MATLABcode> </MATLABcode>
         <Exec>0</Exec>
      </Item>
   </Ex>
   <ExtraEx><!--EXTRA EXAMPLES SECTION--></ExtraEx>
</HelpXML>