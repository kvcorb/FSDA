<html>
<head>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <title>overlap: Functions (Flexible Statistics Data Analysis
  Toolbox™)</title>
  <link href="docstyle.css" rel="stylesheet" type="text/css">
  <meta content="refpage" name="chunktype">
  <meta content="text/javascript" http-equiv="Content-Script-Type">
  <meta content="fcn" name="toctype">
  <script type="text/javascript" language="javaScript" src="bottom.js">
 </script>
</head>

<body>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<!--FScategory:Clustering-->
<a name="top_of_page"></a> 

<p style="font-size: 1px;"> </p>

<table border="0" cellpadding="0" cellspacing="0" class="nav"
summary="Navigation aid" width="100%">
  <tbody>
    <tr>
      <td valign="baseline"><b>Flexible Statistics Data Analysis
      Toolbox™</b></td>
      <td align="right" valign="baseline"><a href="optwei.html"><img
        align="bottom" alt="fanplot" border="0"
        src="images_help/b_prev.gif"></a>   <a href="position.html"><img
        align="bottom" alt="FSMeda" border="0"
      src="images_help/b_next.gif"></a></td>
    </tr>
  </tbody>
</table>

<a name="bq24of9-1"></a><a class="indexterm" name="zmw57dd0e69698"></a> 

<h1 class="reftitle">overlap</h1>

<p class="purpose">computes the exact overlap given the parameters of the mixture</p>

<p class="purpose"> </p>

<h2>Syntax </h2>

<p></p>

<p class="synopsis"><tt>[OmegaMap, BarOmega, MaxOmega, StdOmega, rcMax] =
overlap(k, v, Pi, Mu, S)<br>
[OmegaMap, BarOmega, MaxOmega, StdOmega, rcMax] = overlap(k, v, Pi, Mu, S, tol,
lim)</tt></p>

<h2>Description </h2>

<p>Background: Given two generic clusters i and j with  i ≠  j =1, ..., k,
indexed by φ(x; μ<sub>i</sub>,Σ<sub>i</sub>) and φ(x;
μ<sub>j</sub>,Σ<sub>j</sub>) with probabilities of occurrence π<sub>i</sub>
and π<sub>j</sub> , the misclassification probability with respect to cluster
i, (that is conditionally on x belonging to cluster i,  which is called
w<sub>j|i</sub>) is defined as Pr[π<sub>i</sub>  φ(x;
μ<sub>i</sub>,Σ<sub>i</sub>) &lt; π<sub>j</sub>  φ(x;
μ<sub>j</sub>,Σ<sub>j</sub>)]. The matrix containing the misclassification
probabilities w<sub>j|i</sub> is called <a href="#OmegaMap">OmegaMap</a>. The
probability of overlapping between groups i and j (called p<sub>ij</sub>) is
given by p<sub>ij </sub>=p<sub>ji </sub>= w<sub>j|i</sub> + w<sub>i|j</sub> =
OmegaMap(i,j)+OmegaMap(j,i),  i,j=1,2, ..., k. The diagonal elements of
OmegaMap are (by definition) set equal to 1. The average overlap (which in the
code below  is called <a href="#BarOmega">BarOmega</a>) is defined as the sum
of the off diagonal elements of OmegaMap (Σ<sub>i &gt; j=1,2, ..., k</sub>
p<sub>ij </sub>) divided by k(k-1)/2. The maximum overlap (which in the code
below is called <a href="#MaxOmega">MaxOmega</a>) is defined as
max(w<sub>j|i</sub> + w<sub>i|j</sub> ) = max p<sub>ij </sub> i ≠ j=1,2,
..., k. The standard deviation of overlap (which in the code is called <a
href="#StdOmega">StdOmega</a>) is the standard deviation of the k(k-1)/2
elements  p<sub>ij</sub>. The probability of misclassification w<sub>j|i</sub>
(w<sub>i|j</sub>) is nothing but the cdf of a linear combination of non central
Χ<sup>2</sup> distributions with 1 degree of freedom + a linear combination of
N(0,1) evaluated in a point c. The coefficients of the linear combinations of
non central Χ<sup>2</sup> and N(0,1) depend on the eigenvalues and
eigenvectors of matrix Σ<sub>j|i</sub> = Σ<sup>0.5</sup><sub>i</sub>
Σ<sup>-1</sup><sub>j </sub>Σ<sup>0.5</sup><sub>i</sub>. Point c depends on
the same eigenvalues and eigenvectors of matrix Σ<sub>j|i</sub>, the mixing
proportions  π<sub>i</sub> and π<sub>j </sub>and the determinants
|Σ<sub>i</sub>| and |Σ<sub>j</sub>|. This probability is computed using
routine <a href="ncx2mixtcdf.html">ncx2mixtcdf</a>.</p>

<p></p>

<p>overlap admits the following inputs</p>

<table cellspacing="0" class="body" cellpadding="4" border="2">
  <colgroup><col width="29%">
    <col width="71%">
  </colgroup>
  <tbody>
    <tr>
      <td><p><tt>k</tt></p>
      </td>
      <td><p>scalar, number of components (groups)</p>
      </td>
    </tr>
    <tr>
      <td><p><tt>v</tt></p>
      </td>
      <td><p>scalar, dimensionality (number of variables)</p>
      </td>
    </tr>
    <tr>
      <td><p><tt>Pi</tt></p>
      </td>
      <td><p>vector of length k containing mixing proportions sum(Pi)=1 </p>
      </td>
    </tr>
    <tr>
      <td><p><tt>Mu</tt></p>
      </td>
      <td><p>matrix of size k-by-v containing (in the rows) the centroids of
        the<br>
        k groups </p>
      </td>
    </tr>
    <tr valign="top">
      <td><p><tt>S</tt></p>
      </td>
      <td><p>3D array of size v-by-v-by-k containing covariance matrices of the
        <br>
        k groups. </p>
      </td>
    </tr>
  </tbody>
</table>

<p> </p>

<p>Optional parameters tol and lim will be used by function <a
href="ncx2mixtcdf.html">ncx2mixtcdf</a> which computes the cdf of a linear
combination of non central chi2 random variables (r.v.). </p>

<table cellspacing="0" class="body" cellpadding="4" border="2">
  <colgroup><col width="29%">
    <col width="71%">
  </colgroup>
  <tbody>
    <tr>
      <td style="width: 339px"><p><tt>tol</tt></p>
      </td>
      <td><p>scalar. Error bound for overlap computation default is 1e-06.</p>
      </td>
    </tr>
    <tr>
      <td style="width: 339px"><p><tt>lim</tt></p>
      </td>
      <td><p>lim : scalar = maximum number of integration terms (default is
        1000000).</p>
      </td>
    </tr>
  </tbody>
</table>

<p></p>

<p><tt>[OmegaMap, BarOmega, MaxOmega, StdOmega, rcMax] = overlap(k, v, Pi, Mu,
S) </tt> returns the following information </p>
<ul type="disc">
  <li><tt><a name="OmegaMap">OmegaMap</a></tt> matrix of misclassification
    probabilities (k-by-k).<br>
    OmegaMap(i,j) = w<sub>j|i</sub> is the probability that X coming from the
    i-th component (group) is classified to the j-th component. </li>
  <li><tt><a name="BarOmega">BarOmega</a></tt> − scalar. Value of average
    overlap. BarOmega is computed as <br>
    (sum(sum(OmegaMap))-k)/(0.5*k(k-1)).</li>
  <li><tt><a name="MaxOmega">MaxOmega</a></tt> − scalar. Value of maximum
    overlap.  MaxOmega is the  maximum of 
    <p>OmegaMap(i,j)+OmegaMap(j,i). In other words MaxOmega=<br>
     OmegaMap(rcMax(1),rcMax(2))+OmegaMap(rcMax(2),rcMax(1))</p>
  </li>
  <li><tt><a name="StdOmega">StdOmega</a></tt> − scalar. Value of standard
    deviation (std) of overlap.<br>
    StdOmega is the standard deviation of k*(k-1)/2  probabilities of
    overlapping  p<sub>ij.</sub></li>
  <li><p><tt>rcMax</tt> − vector of length 2. It containes the row and column
    numbers associated with the pair of components producing maximum overlap
    'MaxOmega'.</p>
  </li>
</ul>

<p> </p>

<h2>References </h2>

<p>Maitra, R. and Melnykov, V. (2010) “Simulating data to study performance
of finite mixture modeling and clustering algorithms”, The Journal of
Computational and Graphical Statistics, 2:19, 354-376. (to refer to this
publication we will use "MM2010 JCGS")</p>

<p>Melnykov, V., Chen, W.-C., and Maitra, R. (2012) “MixSim: An R Package for
Simulating Data to Study Performance of Clustering Algorithms”, Journal of
Statistical Software, 51:12, 1-25. </p>

<p></p>

<h3>Example 1</h3>

<p>Finding exact overlap for the Iris data. Group 1 is far from groups 2 and 3.
The overlap between groups 2 and 3 is large</p>

<p>  </p>
<pre class="programlisting">     load fisheriris;                                                        
    Y=meas;                                                                 
    Mu=grpstats(Y,species);                                                 
                                                                            
    S=zeros(4,4,3);                                                         
    S(:,:,1)=cov(Y(1:50,:));                                                
    S(:,:,2)=cov(Y(51:100,:));                                              
    S(:,:,3)=cov(Y(101:150,:));                                             
                                                                            
    pigen=ones(3,1)/3;                                                      
    k=3;                                                                    
    p=4;                                                                    
    [OmegaMap, BarOmega, MaxOmega, StdOmega, rcMax]=overlap(k,p,pigen,Mu,S)    
    disp('Omegamap= k-by-k matrix which contains misclassification probabilities')
    disp(OmegaMap);
    disp('Average overlap')
    disp(BarOmega)
    disp('Maximum overlap')
    disp(MaxOmega)
    disp('Groups with maximum overlap')
    disp(rcMax)</pre>

<p> </p>

<p>The output of this example is as follows</p>
<pre>OmegaMap= k-by-k matrix which contains misclassification probabilities
    1.0000    0.0000         0
    0.0000    1.0000    0.0230
         0    0.0263    1.0000</pre>
<pre>Average overlap
    0.0164</pre>
<pre>Maximum overlap
    0.0493</pre>

<p>Groups with maximum overlap 2 3 </p>

<h3>See Also</h3>

<p><tt><a href="simdataset.html">simdataset</a></tt> </p>


<p></p>

<table border="0" cellpadding="0" cellspacing="0" class="nav"
summary="Navigation aid" width="100%">
  <tbody>
    <tr valign="top">
      <td align="left" width="20"><a href="optwei.html"><img align="bottom"
        alt="fanplot" border="0" src="images_help/b_prev.gif"></a> </td>
      <td align="left">optwei.html</td>
      <td> </td>
      <td align="right">position.html</td>
      <td align="right" width="20"><a href="position.html"><img align="bottom"
        alt="FSMeda" border="0" src="images_help/b_next.gif"></a></td>
    </tr>
  </tbody>
</table>
<script type="text/javascript" language="javaScript">
document.write(barra);</script>
<!-- Last updated: Fri Jan 23 17:00:05 EST 2009-->
</body>
</html>
