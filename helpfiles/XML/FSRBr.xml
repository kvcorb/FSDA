<?xml version="1.0" encoding="utf-8"?>
<HelpXML>
   <Title><!--This is simply the filename-->FSRBr</Title>
   <Purpose><!--This is the second line of the .m file-->Bayesian forward search in linear regression reweighted</Purpose>
   <Description><!--Description section-->FSRBr uses the units not declared as outliers by  FSRB to produce a robust fit.&#xD;
   The units whose residuals exceeds the threshold determined by option&#xD;
   alpha are declared as outliers. Moreover, it is possible in option&#xD;
   R2th to modify the estimate of sigma2 which is used to declare&#xD;
   the outliers. This is useful when there is almost a perfect fit in the&#xD;
   data, the estimate of the error variance is very small and therefore&#xD;
   there is the risk of declaring as outliers very small deviations from&#xD;
   the robust fit. In this case the estimate of sigma2 is corrected in&#xD;
   order to achieve a value of R2 equal to R2th.</Description>
   <InpArgs><!--REQUIRED INPUT ARGUMENT SECTION-->
      <Item>
         <Name>y</Name>
         <ShortDesc>Response variable</ShortDesc>
         <TypeInd>Vector</TypeInd>
         <LongDesc>Response variable, specified as&#xD;
               a vector of length n, where n is the number of&#xD;
               observations. Each entry in y is the response for the&#xD;
               corresponding row of X.&#xD;
               Missing values (NaN's) and infinite values (Inf's) are&#xD;
               allowed, since observations (rows) with missing or infinite&#xD;
               values will automatically be excluded from the&#xD;
               computations.</LongDesc>
         <Example> </Example>
         <DataType>single| double</DataType>
         <ReqArg>1</ReqArg>
         <Struct> </Struct>
      </Item>
      <Item>
         <Name>X</Name>
         <ShortDesc>Predictor variables</ShortDesc>
         <TypeInd>Matrix</TypeInd>
         <LongDesc>Matrix of explanatory&#xD;
               variables (also called 'regressors') of dimension n x (p-1)&#xD;
               where p denotes the number of explanatory variables&#xD;
               including the intercept.&#xD;
               Rows of X represent observations, and columns represent&#xD;
               variables. By default, there is a constant term in the&#xD;
               model, unless you explicitly remove it using input option&#xD;
               intercept, so do not include a column of 1s in X. Missing&#xD;
               values (NaN's) and infinite values (Inf's) are allowed,&#xD;
               since observations (rows) with missing or infinite values&#xD;
               will automatically be excluded from the computations.</LongDesc>
         <Example> </Example>
         <DataType>single| double</DataType>
         <ReqArg>1</ReqArg>
         <Struct> </Struct>
      </Item>
   </InpArgs>
   <OptArgs><!--OPTIONAL (NAME/PAIRS) INPUT ARGUMENT SECTION-->
      <Item>
         <Name>alpha</Name>
         <ShortDesc>test size</ShortDesc>
         <TypeInd>Scalar</TypeInd>
         <LongDesc>Number between 0 and 1 which&#xD;
              defines test size to declare the outliers&#xD;
                 </LongDesc>
         <Example> 'alpha',0.01&#xD;
                 </Example>
         <DataType>double</DataType>
         <Struct> </Struct>
      </Item>
      <Item>
         <Name>R2th</Name>
         <ShortDesc>R2 threshold</ShortDesc>
         <TypeInd>Scalar</TypeInd>
         <LongDesc>Scalar which defines the value R2 does&#xD;
              have to exceed. For example if R2 based on good observations&#xD;
              is 0.92 and R2th is 0.90 the estimate of the variance of the&#xD;
              residuals which is used to declare the outliers is adjusted&#xD;
              in order to have a value of R2 which is equal to 0.90.&#xD;
                 </LongDesc>
         <Example> 'R2th',0.95&#xD;
                 </Example>
         <DataType>double</DataType>
         <Struct> </Struct>
      </Item>
      <Item>
         <Name>fullreweight</Name>
         <ShortDesc>Option to declare outliers</ShortDesc>
         <TypeInd>Boolean</TypeInd>
         <LongDesc>If fullreweight is true&#xD;
              (default option), the list of outliers refers to all the&#xD;
              units whose residuals is above the threshold else if it is&#xD;
              false the outliers are the observations which by procedure&#xD;
              FSR had been declared outliers and have a residual greater&#xD;
              than threshold&#xD;
                 </LongDesc>
         <Example> 'fullreweight',true&#xD;
                 </Example>
         <DataType>boolean</DataType>
         <Struct> </Struct>
      </Item>
      <Item>
         <Name>plotsPI</Name>
         <ShortDesc>Plot of prediction intervals</ShortDesc>
         <TypeInd>Scalar</TypeInd>
         <LongDesc>If plotsPI =1 and&#xD;
               the number of regressors (excluding the constant term) is&#xD;
               equal 1, it is possible to see on the screen the yX scatter&#xD;
               with superimposed the prediction intervals using a&#xD;
               confidence level 1-alpha, else no plot is shown on the&#xD;
               screen&#xD;
                 </LongDesc>
         <Example> 'plotsPI',1&#xD;
                 </Example>
         <DataType>double</DataType>
         <Struct> </Struct>
      </Item>
      <Item>
         <Name>intercept</Name>
         <ShortDesc>Indicator for constant term</ShortDesc>
         <TypeInd>Scalar</TypeInd>
         <LongDesc>If 1, a model with constant term will be fitted&#xD;
                       (default), if 0, no constant term will be included.&#xD;
                        </LongDesc>
         <Example> 'intercept',1&#xD;
                       </Example>
         <DataType>double</DataType>
         <Struct> </Struct>
      </Item>
      <Item>
         <Name>bayes</Name>
         <ShortDesc>Prior information</ShortDesc>
         <TypeInd>Structure</TypeInd>
         <LongDesc>It contains the following fields&#xD;
               bayes.beta0=  p-times-1 vector containing prior mean of \beta&#xD;
               bayes.R    =  p-times-p positive definite matrix which can be&#xD;
                       interpreted as X0'X0 where X0 is a n0 x p matrix&#xD;
                       coming from previous experiments (assuming that the&#xD;
                       intercept is included in the model.&#xD;
&#xD;
               The prior distribution of $\tau_0$ is a gamma distribution with&#xD;
               parameters $a_0$ and $b_0$, that is&#xD;
               \[&#xD;
                     p(\tau_0) \propto \tau^{a_0-1} \exp (-b_0 \tau)&#xD;
                       \qquad E(\tau_0) = a_0/b_0&#xD;
               \]&#xD;
               bayes.tau0 = scalar. Prior estimate of&#xD;
                       \[ \tau=1/ \sigma^2 =a_0/b_0 \]&#xD;
               bayes.n0   = scalar. Sometimes it helps to think of the prior&#xD;
                      information as coming from n0 previous experiments.&#xD;
                      Therefore we assume that matrix X0 (which defines&#xD;
                      R), was made up of n0 observations.&#xD;
              REMARK if structure bayes is not supplied the default&#xD;
                      values which are used are.&#xD;
                      beta0= zeros(p,1):  Vector of zeros.&#xD;
                      R=eye(p):           Identity matrix.&#xD;
                      tau0=1/1e+6:        Very large value for the&#xD;
                                          prior variance, that is a very&#xD;
                                          small value for tau0.&#xD;
                      n0=1:               just one prior observation.&#xD;
&#xD;
               $\beta$ is assumed to have a normal distribution with&#xD;
               mean $\beta_0$ and (conditional on $\tau_0$) covariance&#xD;
               $(1/\tau_0) (X_0'X_0)^{-1}$.&#xD;
               $\beta \sim N(    \beta_0, (1/\tau_0) (X_0'X_0)^{-1}    )$&#xD;
&#xD;
                     </LongDesc>
         <Example> bayes=struct;bayes.R=R;bayes.n0=n0;bayes.beta0=beta0;bayes.tau0=tau0;&#xD;
                     </Example>
         <DataType>double</DataType>
         <Struct>
            <ItemCell>
               <Value>beta0</Value>
               <Description>p-times-1 vector containing prior mean of \beta</Description>
            </ItemCell>
            <ItemCell>
               <Value>R</Value>
               <Description>p-times-p positive definite matrix which can be&#xD;
                       interpreted as X0'X0 where X0 is a n0 x p matrix&#xD;
                       coming from previous experiments (assuming that the&#xD;
                       intercept is included in the model.&#xD;
&#xD;
               The prior distribution of $\tau_0$ is a gamma distribution with&#xD;
               parameters $a_0$ and $b_0$, that is&#xD;
               \[&#xD;
                     p(\tau_0) \propto \tau^{a_0-1} \exp (-b_0 \tau)&#xD;
                       \qquad E(\tau_0) = a_0/b_0&#xD;
               \]</Description>
            </ItemCell>
            <ItemCell>
               <Value>tau0</Value>
               <Description>scalar. Prior estimate of&#xD;
                       \[ \tau=1/ \sigma^2 =a_0/b_0 \]</Description>
            </ItemCell>
            <ItemCell>
               <Value>n0</Value>
               <Description>scalar. Sometimes it helps to think of the prior&#xD;
                      information as coming from n0 previous experiments.&#xD;
                      Therefore we assume that matrix X0 (which defines&#xD;
                      R), was made up of n0 observations.&#xD;
              REMARK if structure bayes is not supplied the default&#xD;
                      values which are used are.&#xD;
                      beta0= zeros(p,1):  Vector of zeros.&#xD;
                      R=eye(p):           Identity matrix.&#xD;
                      tau0=1/1e+6:        Very large value for the&#xD;
                                          prior variance, that is a very&#xD;
                                          small value for tau0.&#xD;
                      n0=1:               just one prior observation.&#xD;
&#xD;
               $\beta$ is assumed to have a normal distribution with&#xD;
               mean $\beta_0$ and (conditional on $\tau_0$) covariance&#xD;
               $(1/\tau_0) (X_0'X_0)^{-1}$.&#xD;
               $\beta \sim N(    \beta_0, (1/\tau_0) (X_0'X_0)^{-1}    )$</Description>
            </ItemCell>
         </Struct>
      </Item>
      <Item>
         <Name>plots</Name>
         <ShortDesc>Plot on the screen</ShortDesc>
         <TypeInd>Scalar</TypeInd>
         <LongDesc>If plots=1 (default) the plot of minimum deletion&#xD;
                 residual with envelopes based on n observations and the&#xD;
                 scatterplot matrix with the outliers highlighted is&#xD;
                 produced.&#xD;
                 If plots=2 the user can also monitor the intermediate&#xD;
                 plots based on envelope superimposition.&#xD;
                 Else no plot is produced.&#xD;
                 </LongDesc>
         <Example> 'plots',1&#xD;
                 </Example>
         <DataType>double</DataType>
         <Struct> </Struct>
      </Item>
      <Item>
         <Name>init</Name>
         <ShortDesc>Search initialization</ShortDesc>
         <TypeInd>Scalar</TypeInd>
         <LongDesc>scalar which specifies the initial subset size to start&#xD;
                   monitoring exceedances of minimum deletion residual, if&#xD;
                   init is not specified it set equal to:&#xD;
                   p+1, if the sample size is smaller than 40;&#xD;
                   min(3*p+1,floor(0.5*(n+p+1))), otherwise.&#xD;
                   </LongDesc>
         <Example> 'init',100 starts monitoring from step m=100&#xD;
                   </Example>
         <DataType>double</DataType>
         <Struct> </Struct>
      </Item>
      <Item>
         <Name>nocheck</Name>
         <ShortDesc>Check input arguments</ShortDesc>
         <TypeInd>Scalar</TypeInd>
         <LongDesc>If nocheck is equal to 1 no check is performed on&#xD;
                    matrix y and matrix X. Notice that y and X are left&#xD;
                    unchanged. In other words the additional column of ones&#xD;
                     for the intercept is not added. As default nocheck=0.&#xD;
                   </LongDesc>
         <Example> 'nocheck',1&#xD;
                   </Example>
         <DataType>double</DataType>
         <Struct> </Struct>
      </Item>
      <Item>
         <Name>bivarfit</Name>
         <ShortDesc>Superimpose bivariate least square lines</ShortDesc>
         <TypeInd>Character</TypeInd>
         <LongDesc>This option adds one or more least square lines, based on&#xD;
                   SIMPLE REGRESSION of y on Xi, to the plots of y|Xi.&#xD;
                  bivarfit = ''&#xD;
                   is the default: no line is fitted.&#xD;
                  bivarfit = '1'&#xD;
                   fits a single ols line to all points of each bivariate&#xD;
                   plot in the scatter matrix y|X.&#xD;
                  bivarfit = '2'&#xD;
                   fits two ols lines: one to all points and another to&#xD;
                   the group of the genuine observations. The group of the&#xD;
                   potential outliers is not fitted.&#xD;
                  bivarfit = '0'&#xD;
                   fits one ols line to each group. This is useful for the&#xD;
                   purpose of fitting mixtures of regression lines.&#xD;
                  bivarfit = 'i1' or 'i2' or 'i3' etc.&#xD;
                   fits an ols line to a specific group, the one with&#xD;
                   index 'i' equal to 1, 2, 3 etc. Again, useful in case&#xD;
                   of mixtures.&#xD;
                 </LongDesc>
         <Example> 'bivarfit',2&#xD;
                 </Example>
         <DataType>char</DataType>
         <Struct> </Struct>
      </Item>
      <Item>
         <Name>multivarfit</Name>
         <ShortDesc>Superimpose multivariate least square lines</ShortDesc>
         <TypeInd>Character</TypeInd>
         <LongDesc>This option adds one or more least square lines, based on&#xD;
                   MULTIVARIATE REGRESSION of y on X, to the plots of y|Xi.&#xD;
                 multivarfit = ''&#xD;
                   is the default: no line is fitted.&#xD;
                 multivarfit = '1'&#xD;
                   fits a single ols line to all points of each bivariate&#xD;
                   plot in the scatter matrix y|X. The line added to the&#xD;
                   scatter plot y|Xi is avconst + Ci*Xi, where Ci is the&#xD;
                   coefficient of Xi in the multivariate regression and&#xD;
                   avconst is the effect of all the other explanatory&#xD;
                   variables different from Xi evaluated at their centroid&#xD;
                   (that is overline{y}'C))&#xD;
                 multivarfit = '2'&#xD;
                   equal to multivarfit ='1' but this time we also add the&#xD;
                   line based on the group of unselected observations&#xD;
                   (i.e. the normal units).&#xD;
                 </LongDesc>
         <Example> 'multivarfit','1'&#xD;
                 </Example>
         <DataType>char</DataType>
         <Struct> </Struct>
      </Item>
      <Item>
         <Name>labeladd</Name>
         <ShortDesc>Add outlier labels in plot</ShortDesc>
         <TypeInd>Character</TypeInd>
         <LongDesc>If this option is '1',  we label the outliers with the&#xD;
                 unit row index in matrices X and y. The default value is&#xD;
                 labeladd='', i.e. no label is added.&#xD;
                 </LongDesc>
         <Example> 'labeladd','1'&#xD;
                 </Example>
         <DataType>char</DataType>
         <Struct> </Struct>
      </Item>
      <Item>
         <Name>nameX</Name>
         <ShortDesc>Add variable labels in plot</ShortDesc>
         <TypeInd>Cell array of strings</TypeInd>
         <LongDesc>cell array of strings of length p containing the labels of&#xD;
                 the variables of the regression dataset. If it is empty&#xD;
                 (default) the sequence X1, ..., Xp will be created&#xD;
                 automatically&#xD;
                 </LongDesc>
         <Example> 'nameX',{'NameVar1','NameVar2'}&#xD;
                 </Example>
         <DataType>cell</DataType>
         <Struct> </Struct>
      </Item>
      <Item>
         <Name>namey</Name>
         <ShortDesc>Add response label</ShortDesc>
         <TypeInd>Character</TypeInd>
         <LongDesc>character containing the label of the response&#xD;
               </LongDesc>
         <Example> 'namey','NameOfResponse'&#xD;
               </Example>
         <DataType>char</DataType>
         <Struct> </Struct>
      </Item>
      <Item>
         <Name>ylim</Name>
         <ShortDesc>Control y scale in plot</ShortDesc>
         <TypeInd>Vector</TypeInd>
         <LongDesc>vector with two elements controlling minimum and maximum&#xD;
                 on the y axis. Default value is '' (automatic scale)&#xD;
               </LongDesc>
         <Example> 'ylim','[0,10]' sets the minim value to 0 and the&#xD;
               max to 10 on the y axis&#xD;
               </Example>
         <DataType>double</DataType>
         <Struct> </Struct>
      </Item>
      <Item>
         <Name>xlim</Name>
         <ShortDesc>Control x scale in plot</ShortDesc>
         <TypeInd>Vector</TypeInd>
         <LongDesc>vector with two elements controlling minimum and maximum&#xD;
                 on the x axis. Default value is '' (automatic scale)&#xD;
               </LongDesc>
         <Example> 'xlim','[0,10]' sets the minim value to 0 and the&#xD;
               max to 10 on the x axis&#xD;
               </Example>
         <DataType>double</DataType>
         <Struct> </Struct>
      </Item>
      <Item>
         <Name>bonflev</Name>
         <ShortDesc>Signal to use to identify outliers</ShortDesc>
         <TypeInd>Scalar</TypeInd>
         <LongDesc>option to be used if the distribution of the data is&#xD;
                 strongly non normal and, thus, the general signal&#xD;
                 detection rule based on consecutive exceedances cannot be&#xD;
                 used. In this case bonflev can be:&#xD;
                 - a scalar smaller than 1 which specifies the confidence&#xD;
                   level for a signal and a stopping rule based on the&#xD;
                   comparison of the minimum MD with a&#xD;
                   Bonferroni bound. For example if bonflev=0.99 the&#xD;
                   procedure stops when the trajectory exceeds for the&#xD;
                   first time the 99% bonferroni bound.&#xD;
                 - A scalar value greater than 1. In this case the&#xD;
                   procedure stops when the residual trajectory exceeds&#xD;
                   for the first time this value.&#xD;
                 Default value is '', which means to rely on general rules&#xD;
                 based on consecutive exceedances.&#xD;
               </LongDesc>
         <Example> 'bonflev',0.99&#xD;
               </Example>
         <DataType>double</DataType>
         <Struct> </Struct>
      </Item>
      <Item>
         <Name>msg</Name>
         <ShortDesc>Level of output to display</ShortDesc>
         <TypeInd>Scalar</TypeInd>
         <LongDesc>scalar which controls whether to display or not messages&#xD;
                 on the screen&#xD;
                 If msg==1 (default) messages are displayed on the screen about&#xD;
                   step in which signal took place and ....&#xD;
                 else no message is displayed on the screen&#xD;
               </LongDesc>
         <Example> 'msg',1&#xD;
               </Example>
         <DataType>double</DataType>
         <Struct> </Struct>
      </Item>
   </OptArgs>
   <OutArgs><!--OUTPUT ARGUMENT SECTION-->
      <Item>
         <Name>out</Name>
         <ShortDesc> </ShortDesc>
         <TypeInd> </TypeInd>
         <LongDesc>
            <ItemCell>
               <Value>outliers</Value>
               <Description>k x 1 vector containing the list of the units declared&#xD;
               outliers by procedure FSR or NaN if the sample is&#xD;
               homogeneous</Description>
            </ItemCell>
            <ItemCell>
               <Value>beta</Value>
               <Description>p-by-1 vector containing the estimated regression parameter&#xD;
               by procedure FSR</Description>
            </ItemCell>
            <ItemCell>
               <Value>outliersr</Value>
               <Description>k1 x 1 vector containing the list of the units declared&#xD;
               outliers after the reweighting step or NaN if the sample is&#xD;
               homogeneous</Description>
            </ItemCell>
            <ItemCell>
               <Value>betar</Value>
               <Description>p-by-1 vector containing the estimated regression parameter&#xD;
               after the reweighting step</Description>
            </ItemCell>
            <ItemCell>
               <Value>rstud</Value>
               <Description>n-by-2 matrix.&#xD;
              First column = studentized residuals&#xD;
              Second column = p-values (computed using as reference&#xD;
              distribution the Student t)</Description>
            </ItemCell>
         </LongDesc>
      </Item>
      <Item>
         <Name>varargout</Name>
         <ShortDesc> Vector</ShortDesc>
         <TypeInd>xnew : new points.</TypeInd>
         <LongDesc> Vector with a number of new points where to evaluate the&#xD;
                  prediction interval. xnew is a vector.&#xD;
          ypred : values predicted by the fitted model on xnew. Vector of&#xD;
                  length(xnew)&#xD;
           yci  : Confidence intervals. A two-column matrix with each row providing&#xD;
                  one interval.</LongDesc>
      </Item>
   </OutArgs>
   <MoreAbout><!--MORE ABOUT SECTION--></MoreAbout>
   <Acknowledgements><!--ACKNOWLEDGEMENTS SECTION--></Acknowledgements>
   <References><!--REFERENCES SECTION-->
      <Item>Atkinson A.C., Corbellini A., Riani M., (2016) Robust Bayesian&#xD;
 Regression, submitted</Item>
   </References>
   <SeeAlso><!--SEE ALSO SECTION-->
      <Item>FSRB</Item>
      <Item>FSR</Item>
   </SeeAlso>
   <Ex><!--EXAMPLES SECTION-->
      <Item>
         <Title>Example of FSRB for international trade data.</Title>
         <Desc>&#xD;
         Bayesian FS to fit the group of undervalued flows.&#xD;</Desc>
         <MATLABcode>
        load('fishery');&#xD;
        X = fishery.data(:,1);&#xD;
        y = fishery.data(:,2);&#xD;
        [n,p] = size(X);&#xD;
        X = X + 0.000001*randn(n,1);&#xD;
&#xD;
        % id = undervalued flows&#xD;
        id = (y./X &amp;lt; 9.5);&#xD;
        &#xD;
        % my prior on beta&#xD;
        mybeta = median(y(id)./X(id));&#xD;
        bmad   = mad(y(id)./X(id));&#xD;
        ListIn = find(y./X &amp;lt;= mybeta + bmad);&#xD;
        % gscatter(X,y,id)&#xD;
&#xD;
&#xD;
        rr          = y(ListIn)-(X(ListIn,:) * mybeta);&#xD;
        numS2cl     = rr'*rr;&#xD;
        dfe         = length(ListIn)-p;&#xD;
        S2cl        = numS2cl/dfe;&#xD;
        bayes       = struct;&#xD;
        bayes.R     = X(ListIn,:)'*X(ListIn,:);&#xD;
        bayes.tau0  = 1/S2cl;&#xD;
        bayes.n0    = length(ListIn);&#xD;
        bayes.beta0 = mybeta;&#xD;
&#xD;
        % fit based on Bayesian FS with prior on the underdeclared flows&#xD;
        [out_B, xnew1 , ypred1, yci1]   = FSRBr(y,X,'bayes',bayes,'intercept',0,'alpha',0.01,'bonflev',0.999,'fullreweight',false,'plotsPI',1,'plots',0);&#xD;
         &#xD;
        h1 = allchild(gca); a1 = gca; f1 = gcf;&#xD;
&#xD;
        % fit based on traditional FS&#xD;
        [out, xnew2 , ypred2, yci2]   = FSRr(y,X,'intercept',0,'alpha',0.01,'bonflev',0.999,'fullreweight',false,'plotsPI',1,'plots',0);&#xD;
&#xD;
        h2 = allchild(gca); a2 = gca; f2 = gcf;&#xD;
&#xD;
        % move the figure above into a single one with two panels&#xD;
        hh = figure; ax1 = subplot(2,1,1); ax2 = subplot(2,1,2);&#xD;
        copyobj(h1,ax1); title(ax1,get(get(a1,'title'),'string'));&#xD;
        copyobj(h2,ax2); title(ax2,get(get(a2,'title'),'string'));&#xD;
        figsize = get(hh, 'Position'); &#xD;
        set(hh,'Position',figsize);&#xD;
        close(f1); close(f2);&#xD;
&#xD;
        disp(['Bayesian FS fit    = ' num2str(out_B.betar) ' using a prior based on undervalued flows']);&#xD;
        disp(['Traditional FS fit = ' num2str(out.betar)]);&#xD;
&#xD;</MATLABcode>
         <Exec>1</Exec>
      </Item>
      <Item>
         <Title>Example of FSRB for international trade data (explore options).</Title>
         <Desc>&#xD;
         Bayesian FS to fit the group of undervalued flows.&#xD;</Desc>
         <MATLABcode>
        load('fishery');&#xD;
        X = fishery.data(:,1);&#xD;
        y = fishery.data(:,2);&#xD;
        [n,p] = size(X);&#xD;
        X = X + 0.000001*randn(n,1);&#xD;
&#xD;
        % id = undervalued flows&#xD;
        id = (y./X &amp;lt; 9.5);&#xD;
        &#xD;
        % my prior on beta&#xD;
        mybeta = median(y(id)./X(id));&#xD;
        bmad   = mad(y(id)./X(id));&#xD;
        ListIn = find(y./X &amp;lt;= mybeta + bmad);&#xD;
        % gscatter(X,y,id)&#xD;
&#xD;
&#xD;
        rr          = y(ListIn)-(X(ListIn,:) * mybeta);&#xD;
        numS2cl     = rr'*rr;&#xD;
        dfe         = length(ListIn)-p;&#xD;
        S2cl        = numS2cl/dfe;&#xD;
        bayes       = struct;&#xD;
        bayes.R     = X(ListIn,:)'*X(ListIn,:);&#xD;
        bayes.tau0  = 1/S2cl;&#xD;
        bayes.n0    = length(ListIn);&#xD;
        bayes.beta0 = mybeta;&#xD;
        alpha=0.0001;&#xD;
        bonflev=0.99999;&#xD;
        % fit based on Bayesian FS with prior on the underdeclared flows&#xD;
        [out_B, xnew1 , ypred1, yci1]   = FSRBr(y,X,'bayes',bayes,'intercept',0,'alpha',alpha,'bonflev',bonflev,'fullreweight',false,'plotsPI',1,'plots',0);&#xD;
         &#xD;
        h1 = allchild(gca); a1 = gca; f1 = gcf;&#xD;
&#xD;
        % fit based on traditional FS&#xD;
        [out, xnew2 , ypred2, yci2]   = FSRr(y,X,'intercept',0,'alpha',alpha,'bonflev',bonflev,'fullreweight',false,'plotsPI',1,'plots',0);&#xD;
&#xD;
        h2 = allchild(gca); a2 = gca; f2 = gcf;&#xD;
&#xD;
        % move the figure above into a single one with two panels&#xD;
        hh = figure; ax1 = subplot(2,1,1); ax2 = subplot(2,1,2);&#xD;
        copyobj(h1,ax1); title(ax1,get(get(a1,'title'),'string'));&#xD;
        copyobj(h2,ax2); title(ax2,get(get(a2,'title'),'string'));&#xD;
        figsize = get(hh, 'Position'); &#xD;
        set(hh,'Position',figsize);&#xD;
        close(f1); close(f2);&#xD;
&#xD;
        disp(['Bayesian FS fit    = ' num2str(out_B.betar) ' using a prior based on undervalued flows']);&#xD;
        disp(['Traditional FS fit = ' num2str(out.betar)]);&#xD;
&#xD;</MATLABcode>
         <Exec>0</Exec>
      </Item>
      <Item>
         <Title> </Title>
         <Desc> </Desc>
         <MATLABcode> </MATLABcode>
         <Exec>0</Exec>
      </Item>
   </Ex>
   <ExtraEx><!--EXTRA EXAMPLES SECTION--></ExtraEx>
</HelpXML>