<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<!--FScategory:Robust Model Selection-->

<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>FSRms :: Functions (Flexible Statistics Data Analysis Toolbox&trade;)</title>
<link href="docstyle.css" rel="stylesheet" type="text/css">
<meta content="refpage" name="chunktype">

<meta content="function:FSRms" name="refentity">
<meta content="text/javascript" http-equiv="Content-Script-Type">
<meta content="fcn" name="toctype">

<script  type="text/javascript" language="javaScript" src="bottom.js"></script>

</head>


<body>



<a name="top_of_page"></a>
<p style="font-size: 1px;">&nbsp;</p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr>
		<td valign="baseline"><b>Flexible Statistics Data Analysis Toolbox&trade;</b></td>
		<td align="right" valign="baseline"><a href="fsrmdrrs.html">
		<img align="bottom" alt="" border="0" src="images_help/b_prev.gif"></a>&nbsp;&nbsp;
		<a href="getomegamap.html">
		<img align="bottom" alt="" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>

<a name="bq24of9-1"></a><a class="indexterm" name="zmw57dd0e69698"></a>

<h1 class="reftitle">FSRms</h1>
<p class="purpose">Robust model selection using flexible trimming in linear 
regression  </p>
<h2>Syntax  </h2>
<p class="synopsis"><tt>[outms] = FSRms(y,X)<br>[outms] = FSRms(y,X,</tt><tt><i>param1</i></tt><tt>,</tt><tt><i>val1</i><tt>,</tt><i>param2</i><tt>,</tt><i>val2</i><tt>,...)<br>

</tt>
</tt></p>

<a name="f4811966"></a>

<h2>Description  </h2>
<p><tt>FSRms(y,X)</tt> gives in structure outCp Mallows <em>C<sub>p</sub></em> monitored for all specified model of size smallp
</p>
<p><tt>y</tt> is a vector of length n containing the response values, while 
 <tt>
X</tt> is the <i>n</i>-by-<i>p-1</i> matrix which contains (in the columns) the values 
of <i>p-1</i> predictive terms</p>
<p><tt>[out] = FSRms(y,X)</tt> returns the following information

</p>
<ul type="disc">
	<li><tt>out</tt> &minus; A structure of additional statistics with the following fields.
	
	<ul type="circle">
		<li>
		<p><tt>stor</tt> &minus; <tt>k</tt>-by-9 matrix containing statistics 
		which can be used to create the candles  <br>
		1st col: max <em>C<sub>p</sub></em> values<br>
2nd col: min <em>C<sub>p</sub></em> values<br>
3rd col: average <em>C<sub>p</sub></em> values<br>
 4nd col: median <em>C<sub>p</sub></em> values <br>
Remark: the information in the first 4 columns is  referred to the central part of the search<br>
5th col: x coordinates (or size of submodel)<br>
6th col: number of explanatory variables of the submodel<br>
7th col: y coordinate of final <em>C<sub>p</sub></em><br>
8th col: units entering the final step of the search<br>
9th col: maximum <em>C<sub>p</sub></em> value during the (central and final
               part of the) search (This information is used to print the
               labels on top of each model)
<br>
	
	</p>
		</li>
		<li>
		<p><tt>outl</tt> &minus;  <tt>r</tt>-by-4 matrix containing information about 'influential
              units' or empty matrix
              Influential units in this context are defined as the units
              which enter the subset in the final part of the search and
              bring the value of <em>C<sub>p</sub></em> below the minimum or above the
              maximum value of the central part of the search
              <br>1st col: x coordinates
              <br>2nd col: y coordinates
              <br>3rd col: step of entry into subset
              <br>4nd col: unit number
              <br>If matrix outl contains more columns they are ignored</p>
		</li>
		<li>
		<p><tt>siz</tt> &minus; vector of length 2 containing information about n (number of
              units of the sample and bigP, number of explanatory
              variables, including the constant, in the full model). <br>REMARK: This
              information is necessary to compute the envelopes. </p>
		</li>
		<li>
		<p><tt>MAL</tt> &minus; (n-init+1) x (k+1) matrix
                Mallows Cp monitored along the search for the selected
                models
                  1st col is fwd search index
                  2nd col is associated with first selected model
                  3rd col is associated with second selected model
                  ............
                  (k+1)th col is associated with k-th selected model
                  Notice that k<=(n choose <tt>smallp</tt>) and that all
                  models contain the constant  </p>
		</li>
		
		<li>
		<p><tt>LAB</tt> &minus; cell array of strings of length k containing the labels
                  of the models which have been extracted. First element
                  of LAB is associated with second column of matrix
                  MAL Last element of LAB is associated with last
                  column of matrix MAL </p>
		</li>

		
	</ul>
	<ul>
		<p></p>
		<a name="zmw57dd0e69798"></a>
		
		<table border="1" cellpadding="5" cellspacing="0" class="note" summary="Note">
			<tr width="90%">
				<td>
				<p><b>Note</b>&nbsp;&nbsp;  <tt>
				FSRms</tt> automatically includes a 
				constant term in all models. Do not enter a column of 1s directly 
				into  <tt>X</tt>.</p>
				<p><b>Note</b>&nbsp;&nbsp; 
				the loop through all values of <tt>smallp</tt> works backwards in
      the sense that first all possible submodels of size bigP-1 are
      considered, then the models with size <tt>bigP-2</tt>, <tt>bigP-3</tt>...
				</p>

				</td>
			</tr>
		</table>
	</ul>
	</li>
</ul>
<p></p>
<p><tt>[out] = FSRms(y,X,</tt><tt><i>param1</i></tt><tt>,</tt><tt><i>val1</i><tt>,</tt><i>param2</i><tt>,</tt><i>val2</i><tt>,...)</tt></tt> 
specifies one or more of the name/value pairs described in the following table.</p>
<table border="2" cellpadding="4" cellspacing="0" class="body">
	<colgroup>
		<col width="21%"><col width="79%">
	</colgroup>
	<thead>
		<tr valign="top">
			<th bgcolor="#B2B2B2">Parameter</th>
			<th bgcolor="#B2B2B2">Value</th>
		</tr>
	</thead>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;intercept&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>If 1, a model with constant term will be fitted (default) else no constant 
		term will be included.   </p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;nocheck&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>Scalar. If nocheck is equal to 1 no check is performed on matrix <em>
		y</em> and matrix <em>X</em>. Notice that <em>y</em> and <em>X</em> are 
		left unchanged. In other words the additional column of ones for the intercept 
		is not added. As default  <tt>nocheck=0</tt>.</p>
		</td>
	</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;h&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p>The number of observations that have determined the least trimmed squares 
		estimator.  The default value of <tt>h</tt> is  
		 <tt>[(n+p+1)/2]</tt> 
		</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;lms&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>Scalar. If  <tt>lms=1</tt> (default) Least Median of Squares is computed, 
		else Least trimmed squares is computed.</p>
		</td>
	</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;nsamp&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Number of subsamples which will be extracted to find the robust estimator. 
		If  <tt>nsamp=0</tt> all subsets will be extracted. They will be 
		 <tt>(n choose 
		p)</tt>. Remark: if the number of all possible subset is smaller than 1000 
		the default is to extract all subsets otherwise just 1000.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;init&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Scalar which specifies the initial subset size to start monitoring the required quantities, 
		if init is not specified it will be set equal to   		
		<br><tt>p+1</tt>, if the sample size is smaller than 40; <br><tt>min(3*p+1,floor(0.5*(n+p+1)))</tt>, otherwise.</td>
			</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;smallpint&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>vector which specifies which submodels (number of variables)
              must be considered. The default is to consider all models
              from size 2 to size bigP-1. In other words, as default,
              smallpint=(bigP-1):-1:2.
              When smallpint=2 all submodels including one explanatory
              variable and the constant will be considered.
              When smallpint=3 all submodels including two explanatory
              variables and a constant will be considered. ....</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;labels&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>cell array of strings of length <tt>bigP</tt>-1 containing the
                names of the explanatory variables. If labels is a missing
                value the following sequence of strings will be
                automatically created for X <br>
                (1,2,3,4,5,6,7,8,9,A,B,C,D,E,E,G,H,I,J,K,...,Z)</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;fin_step&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>vector with two elements.
              The first element specifies the initial step of the search
              which has to be monitored to choose the best models as
              specified in scalar first_k below. The second element
              specifies the ending point of the central part of the
              search. This information will be used to create the
              candlestick Cp plot.
              If the elements of fin_step are integers greater or equal 1
              they refer to the number of steps. For example if
              fin_step=[10 3] the program considers the last 10 steps to
              choose the best models and the central part of the search
              is defined up to step n-3.
              If the elements of fin_step are real numbers alpha (<alpha<0.5) in the interval (0 0.5] then the
              program considers the last round(n*alpha) steps.
              As default fin_step(1)=round(n*0.2) that is the last 20%
              of the steps are considered.
              As default fin_step(2)=round(n*0.05) that
              is the central part of the search extends up to 95% of the
              observations                <br>Remark1: the number of best models to consider is
                controlled by scalar <tt>first_k</tt> (see below)
                <br>
		
		</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;first_k&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>scalar which specifies the number of best models to
                consider in each of the last <tt>fin_step</tt>. For example if
                <tt>first_k</tt>=5 in each of the last <tt>fin_step</tt>, the models which had
                the 5 smallest values of Cp are considered. As default
                <tt>first_k=3</tt>.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;ignore&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>scalar. If ignore=1, when dealing with p explanatory
              variables, the submodels of the models with p+1
              explanatory variables which were considered irrelevant
              according to option ExclThresh, are not considered. <br>As
              default ignore=1, because this saves computational time.
              <br>If ignore is different from 1, for each p all submodels of
              size p which contain a constant are considered</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;ExclThresh&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>scalar which has effect only if ignore=1.
              Exclusion threshold associated to the uppper
              percentage point of the F distribution of Cp which defines
              the threshold for each p declaring models as irrelevant.
              The default value of ExclThresh is 0.99999 that is the
              models whose minimum value of Cp in the part of the
              search defined by fin_step is above ExclThresh are
              stored for each p. If option ignore=1, the submodels with
              p-1 explanatory variables which are contained inside the
              models considered irrelevant are not considered</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 42px"><tt>&#39;plots&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 42px">
		<p>scalar. If plots=1 a candlestick Cp plot is created on the screen
              else (default) no plot is shown on the screen 0</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;steps&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>vector which specifies in which steps of the plot which
                monitors Cp (AIC) it is
                necessary to include the labels of the models which have been
                previously chosen. The default is to write the labels of
                the models in steps <tt>round([n*0.5 n*0.8 n]);</tt>.
                <br> This options only works if plots is equal 1
                or is equal 2.
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;meanmed&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>specfy how to construct the boxes of the candles. If 
		meanmed=1 boxes are constructed using mean and median
		else using the first and third quartile.</p>
		
	</tr>

</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2">&nbsp;</td>
		<td bgcolor="#F2F2F2">
		Remark: the options below only work if plots=1</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;rl&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>scalar which specifies the spread of the candles around
              each integer value defining the size of the submodels 
              For example if rl=0.4 for each smallp candles are spread in the
              interval [smallp-rl smallp+rl]. The default value of rl
              is 0.4. rl does not have to be greater than 0.45 otherwise
              the candles overlap</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;quant&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>vector containing quantiles for the horizontal lines
              associated with the confidence bands of Cp
              The default is to plot 2.5% and
              97.5% envelopes. In other words the default is
              quant=[0.025;0.975]).</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;CandleWidth&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Scalar defining the width of the boxes associated with
              the central part of the search. The default width is 0.05;</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 33px"><tt>&#39;LineWidth&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 33px">
		<p> Line Width (in points) for the vertical lines outside the 
              boxes of the candles. The default LineWidth is 0.5 points.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 53px"><tt>&#39;xlimx&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 53px">
		<p>Vector with two elements controlling minimum and maximum on the x axis. 
		Default value is &#39;&#39; (automatic scale).</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;ylimy&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p>Vector with two elements controlling minimum and maximum on the x axis. 
		Default value is &#39;&#39; (automatic scale)</p>
		</td>
	</tr>
	</table>

<a name="bq9x7hn"></a><a name="bq5gf2y"></a>

<h3>Examples</h3>

<h3>Example 1</h3>
Let us consider the full ozone data modified as suggested ny Riani and Atkinson 
(2010)


<pre class="programlisting">
X=load('ozone_330_obs.txt');
y=log(X(:,9));
Time1=[(1:165)';(165:-1:1)'];
X=[Time1 X(:,1:8)];
</pre>

The default model selection procedure based on the
code<br>


<pre class="programlisting">
labels={'Time','1','2','3','4','5','6','7','8'};
outms=FSRms(y,X,'labels',labels,'plots',1);
</pre>

<p> 
produces the following candlestick plot</p>
<p><img alt="" src="images_help/img10.gif">&nbsp;</p>
<p>If the user wants to reproduce the candlestick plot given in Figure 5 of 
Riani and Atkinson (2010), the following code has to be used</p>

<pre class="programlisting">
n=length(y);
fin_step=floor([n*0.1 n*0.02]);
FSRms(y,X,'fin_step',fin_step,'plots',1,'labels',labels,'smallpint',[4:7])
</pre>

&nbsp;<p><img alt="" src="images_help/img14.gif"></p>
<p>The figure has slightly changed and certainly there can be some random 
fluctuations due to the number of subset which have been used to initialize the 
search for each model. However, The indication of the previous two Figures
does not change at all: the values of <tt>smallp</tt> of 4 or 5 should yield
a satisfactory model. For <tt>smallp</tt> = 4 the best model has the trend, x3 and x7,
although the plot shows the values of <em>C<sub>p</sub></em>(<em>m</em>) increasing towards the end of the
search. By far the most stable model for <tt>smallp</tt>= 5 adds x2 to these variables.&nbsp;
</p>

<p>&nbsp;</p>
<h2>See Also</h2>

<p><a href="cdsplot.html"><tt>cdsplot</tt></a>,  
  <a href="fsrcp.html"><tt>FSRcp</tt></a></p>
<p></p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr valign="top">
		<td align="left" width="20"><a href="fsrmdrrs.html">
		<img align="bottom" alt="fanplot" border="0" src="images_help/b_prev.gif"></a>
		
		</td>
		<td align="left">fsrmdrrs.html</td>
		<td>&nbsp;</td>
		<td align="right">getomegamap.html</td>
		<td align="right" width="20"><a href="getomegamap.html">
		<img align="bottom" alt="FSRaddt" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>

<script type ="text/javascript" language="javaScript">
document.write(barra);
</script>
<!-- Last updated: Fri Jan 23 17:00:05 EST 2009-->



</body>

</html>
