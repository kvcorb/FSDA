<!DOCTYPE HTML> <html itemscope="" xmlns="http://www.w3.org/1999/xhtml"><head><title>medcouple</title><meta content="refpage" name="chunktype"><meta content="function:medcouple" itemprop="refentity" name="refentity"><meta content="text/javascript" http-equiv="Content-Script-Type"><meta content="fcn" itemprop="pagetype" name="toctype"><meta content="ref/function" itemprop="infotype" name="infotype" /><meta content="MEDCOUPLE computes the medcouple, a robust skewness estimator.." itemprop="description" name="description" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /><script type="text/x-mathjax-config">MathJax.Hub.Config({extensions: ["tex2jax.js"],jax: ["input/TeX","output/HTML-CSS"],menuSettings: {zoom: "Double-Click", zscale: "300"},tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},MathMenu: {showRenderer: false},"HTML-CSS": {availableFonts: ["TeX"],preferredFont: "TeX",imageFont: null}});</script><script type="text/javascript" src="includesFS/Mathjax/MathJax.js"></script><script src="includesFS/matlab-highlighter.min.js"></script><link href="includesFS/matlab-highlighter.css" rel="stylesheet" type="text/css"><script type="text/javascript" src="includesFS/jquery-latest.js"></script><script>$(document).ready(function(){      $("#divtop").load("includesFS/top.html");      $("#divbottom").load("includesFS/bottom.html");});</script><link href="../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)"></link><link href="../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)"></link><link href="../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)"></link><link href="../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)"></link><link href="../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)"></link><link href="../includes/product/css/site6_offcanvas.css" rel="stylesheet" type="text/css"></link><script src="../includes/shared/scripts/l10n.js" type="text/javascript"></script><script src="../includes/product/scripts/docscripts.js"></script><script src="../includes/shared/scripts/docscripts_rn.js"></script><script src="../includes/shared/scripts/mw.imageanimation.js" type="text/javascript"></script><script src="../includes/shared/scripts/jquery.highlight.js"></script><script src="../includes/product/scripts/bootstrap.min.js" type="text/javascript"></script><script src="../includes/product/scripts/global.js"></script><script src="includesFS/bottom.js" type="text/javascript"></script><script src="../includes/product/scripts/underscore-min.js"></script><script src="../includes/shared/scripts/f1help.js" type="text/javascript"></script><script src="../includes/product/scripts/suggest.js" type="text/javascript"></script><script src="../includes/shared/scripts/helpservices.js" type="text/javascript"></script><script src="../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script><!-- the following line should be kept this way only --><link href="includesFS/doc_center.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css"><link href="../includes/product/css/doc_center_print.css" media="print" rel="stylesheet" type="text/css"></head><body  onload="highlightMATLABCode();" id="responsive_offcanvas">  <div id="doc_header_spacer" class="header"></div><div class="sticky_header_container includes_subnav"><div class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-xs-12 col-sm-6 col-sm-push-6 col-md-5 col-md-push-7" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2017a" data-language="en" action="../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="sr-only">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"><div class="input-group-btn"><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search pull-right icon_32 visible-xs" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="col-sm-6 col-sm-pull-6 col-md-7 col-md-pull-5" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../documentation-center.html">Documentation</a></h1></div></div></div><div class="visible-xs" id="search_actuator"><button class="btn icon-search btn_search pull-right icon_16" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div><!--END.CLASS row--> </div><!--END.CLASS container-fluid--> </div><!--END.CLASS section_header level_3--><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_actuator" data-toggle="offcanvas" data-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="sr-only">Toggle navigation</span><span class="icon-menu icon_24"></span></button><span class="offcanvas_actuator_label"></span><span class="offcanvas_actuator_close"></span> </div><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-md-12 hidden-xs hidden-sm"></div></div></div></div></div></div></div><!--END.CLASS sticky_header_container--><div class="row-offcanvas row-offcanvas-left"><div id="sidebar" class="sidebar-offcanvas" role="navigation"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" xmlns:atict="http://www.arbortext.com/namespace/atict"><li itemprop="breadcrumb" itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb"> <a href="../documentation-center.html" itemprop="url"> <span itemprop="title">All Products</span></a></li></ul><ul class="nav_disambiguation" xmlns:atict="http://www.arbortext.com/namespace/atict"><li class="product"><a href="index.html">Flexible Statistics and Data Analysis (FSDA)</a><div class="dropdown"> <span id="dropdownMenu1" class="icon-arrow-down icon_16" data-toggle="dropdown"> </span><ul aria-labelledby="dropdownMenu1" class="dropdown-menu dropdown-menu-right" role="menu"><li role="presentation"> <a href="examples.html" role="menuitem" tabindex="-1">Examples</a></li><li role="presentation"> <a href="function-alpha.html" role="menuitem" tabindex="-1"> Functions and Other Reference</a></li><li role="presentation"> <a href="release_notes.html?s_cid=doc_flyout" role="menuitem" tabindex="-1"> Release Notes</a></li><li role="presentation"> <a href="tutorials.html" role="menuitem" tabindex="-1"> Tutorials</a></li></ul></div></li></ul><ul xmlns:atict="http://www.arbortext.com/namespace/atict" class="nav_disambiguation"> <li><a href="index.html">Flexible Statistics and Data Analysis Toolbox</a> </li> <li><a href="function-cate.html" itemprop="url">Functions</a></li></ul><!-- --><ul class="nav_scrollspy nav" xmlns:atict="http://www.arbortext.com/namespace/atict">  <li class="nav_scrollspy_function"> <a href="#responsive_offcanvas">medcouple</a></li> <li id="SSPY810-refentry" class="nav_scrollspy_title">On this page</li><li><a class="intrnllnk" href="#syntax">Syntax</a></li><li><a class="intrnllnk" href="#Description">Description</a></li><li><a class="intrnllnk" href="#Examples">Examples</a><ul><li><a class="intrnllnk" href="#Example_1">the fast medcouple (default) on chi2 data.</a></li><li><a class="intrnllnk" href="#Example_2"></a></li><li><a class="intrnllnk" href="#Example_3">The medcouple on small datasets.</a></li><li><a class="intrnllnk" href="#Example_4">Boxplot using medcouple to adjust for skewness.</a></li></ul></li><li><a class="intrnllnk" href="#ExtraExamples">Extra Examples</a><ul><li><a class="intrnllnk" href="#ExtraExample_1">Assess the perfomance of the various medcouple solutions.</a></li></ul></li><li><a class="intrnllnk" href="#Inputs">Input Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_z">z</a></li><li><a class="intrnllnk" href="#input_argument_mcm">mcm</a></li><li><a class="intrnllnk" href="#input_argument_wmm">wmm</a></li></ul></li><li><a class="intrnllnk" href="#OutputArgs">Output Arguments</a><ul><li><a class="intrnllnk" href="#output_argument_medout">medout</a></li><li><a class="intrnllnk" href="#output_argument_varargout">varargout</a></li></ul></li><li><a class="intrnllnk" href="#MoreAbout">More About</a></li><li><a class="intrnllnk" href="#References">References</a></li><li><a class="intrnllnk" href="#SeeAlso">See Also</a></li></ul></nav><script src="../includes/product/scripts/offcanvas.js"></script></div><div id="divtop"></div><div class="site_container site_toc_closed"><div class="page_container"><div class="content_frame"><div id="content_container" class="content_container"><section id="doc_center_content"><div class="function_ref"><div itemprop="content"><h1 itemprop="title">medcouple</h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose">MEDCOUPLE computes the medcouple, a robust skewness estimator.</p><div class="switch"><a id="expandAllPage" href="javascript:void(0);">expand all in page</a></div></div></div></div><div class="ref_sect"><h2 id="syntax">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><ul><li><code class="synopsis">medout =medcouple(z)</code><span class="syntax_example"><a class="intrnllnk" href="medcouple.html#Example_1">example</a></span></li><li><code class="synopsis">medout =medcouple(z, mcm)</code><span class="syntax_example"><a class="intrnllnk" href="medcouple.html#Example_2">example</a></span></li><li><code class="synopsis">medout =medcouple(z, mcm, wmm)</code><span class="syntax_example"><a class="intrnllnk" href="medcouple.html#Example_3">example</a></span></li><li><code class="synopsis">[medout , varargout]=medcouple(___)</code><span class="syntax_example"><a class="intrnllnk" href="medcouple.html#Example_4">example</a></span></li></ul></div></div></div>	<div class="ref_sect" itemprop="content">							<h2 id="Description">Description</h2>							<div class="descriptions">								<div class="description_module"><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="medcouple.html#Example_1">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_medout"><code>medout</code></a>=medcouple(<a class="intrnllnk" href="#inputarg_z"><code>z</code></a>)</code></span>the fast medcouple (default) on chi2 data.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="medcouple.html#Example_2">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_medout"><code>medout</code></a>=medcouple(<a class="intrnllnk" href="#inputarg_z"><code>z</code></a>,<a class="intrnllnk" href="#inputarg_mcm"><code> mcm</code></a>)</code></span></p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="medcouple.html#Example_3">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_medout"><code>medout</code></a>=medcouple(<a class="intrnllnk" href="#inputarg_z"><code>z</code></a>,<a class="intrnllnk" href="#inputarg_mcm"><code>mcm</code></a>,<a class="intrnllnk" href="#inputarg_wmm"><code> wmm</code></a>)</code></span>The medcouple on small datasets.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="medcouple.html#Example_4">	example</a></p>	<p><span itemprop="syntax"><code>[<a class="intrnllnk" href="#outputarg_medout"><code>medout </code></a>,<a class="intrnllnk" href="#outputarg_varargout"><code> varargout</code></a>]=medcouple(___)</code></span>Boxplot using medcouple to adjust for skewness.</p></div>								</div>							</div>							<div class="clear">							</div>						</div><div class="ref_sect" itemprop="content"><div class="examples"><h2 id="Examples">Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="example_1" class="example_module expandableContent"><div id="Example_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> the fast medcouple (default) on chi2 data.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">rng(5);
data = chi2rnd(5,1000,1);
mc1 = medcouple(data);
stddev = std(data);
figure;
histogram(data);
title(['Medcouple = ' num2str(mc1) ' -- Standard deviation = ' num2str(stddev)],'FontSize',16);</pre></div></div><a href='http://rosa.unipr.it/fsda/medcouple.html#Example_1'><img vspace="5" hspace="5" src="images\medcouple_01.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)."> </a></p></div></div><div id="example_2" class="example_module expandableContent"><div id="Example_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li></li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">rng(5);
method = 1;
mc2 = medcouple(chi2rnd(5,1000,1),method);</pre></div></div></p></div></div><div id="example_3" class="example_module expandableContent"><div id="Example_3"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> The medcouple on small datasets.</li></span></a></span></h3><div class="collapse"><p>
     For small n, it is better to compute the the medcouple also on 
     the reflected sample -z and return (medcouple(z) - medcouple(-z))/2;
     To work on positive values we do this with:<div class="programlisting"><div class="codeinput"><pre class="matlab-code">z = chi2rnd(5,25,1);
mcm = 1; % use naive method (n is small ...)
medoutR = 0.5*(-medcouple(repmat(max(z),size(z,1),1)-z , mcm) + medcouple(z,mcm));
medout  = medcouple(z,mcm);
disp('Application to a non problematic dataset:');
disp(['result with reflected option = ' num2str(medoutR) ' --- result on z only = ' num2str(medoutR)]);</pre></div></div><pre class="codeoutput">Application to a non problematic dataset:
result with reflected option = -0.1548 --- result on z only = -0.1548
</pre></p></div></div><div id="example_4" class="example_module expandableContent"><div id="Example_4"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Boxplot using medcouple to adjust for skewness.</li></span></a></span></h3><div class="collapse"><p>
     Apply to symmetric and skewed data<div class="programlisting"><div class="codeinput"><pre class="matlab-code">rng(5);
%orientation = 'horizontal'; 
orientation = 'vertical'; 
% normal data with an outlier
datain1 = 15+randn(200,1);     
datain1 = [datain1 ; 35];      
% log-normal data with an outlier
datain2 = lognrnd(0,1,200,1);  
datain2 = [datain2 ; 35]; 
k  = 1.5;
% limits on normal data + one outlier
MC_1  = medcouple(datain1);
Q1_1  = quantile(datain1,0.25);
Q3_1  = quantile(datain1,0.75);
IQR_1 = Q3_1 - Q1_1;
DataLimLower_1 = Q1_1 - k * exp(-3.5 * MC_1) * IQR_1;
DataLimUpper_1 = Q3_1 + k * exp(4 * MC_1)    * IQR_1;
% limits on log-normal data + one outlier
MC_2  = medcouple(datain2);
Q1_2  = quantile(datain2,0.25);
Q3_2  = quantile(datain2,0.75);
IQR_2 = Q3_2 - Q1_2;
DataLimLower_2 = Q1_2 - k * exp(-3.5 * MC_2) * IQR_2;
DataLimUpper_2 = Q3_2 + k * exp(4 * MC_2)    * IQR_2;
% boxplot
boxplot([datain1,datain2],'Whisker',k,'Orientation',orientation,...
'OutlierSize',10,'Symbol','*r', ...
'labels',{'Normal(15,1)+outlier','Log-normal(0,1)+outlier'});
title({'Boxplot adjusted for skewness' , 'with medcouple (red limits)'}, 'FontSize' , 20)
set(gca,'FontSize',16);
switch orientation
case 'vertical'
% add the limits (for vertical boxplot)
xx  = xlim(gca);
xx2 = xx/1.1;   xx2(1) = xx(2)/1.5;
xx1 = xx/2; xx1(1) = xx(2)/3.5;
line(xx1,[DataLimLower_1 , DataLimLower_1] , 'Color','red');
line(xx1,[DataLimUpper_1 , DataLimUpper_1] , 'Color','red');
line(xx2,[DataLimLower_2 , DataLimLower_2] , 'Color','red');
line(xx2,[DataLimUpper_2 , DataLimUpper_2] , 'Color','red');
case 'horizontal'
% add the limits (for horizontal boxplot)
yy  = ylim(gca);
yy2 = yy/1.1;   yy2(1) = yy(2)/1.5;
yy1 = yy/2; yy1(1) = yy(2)/3.5;
line([DataLimLower_1 , DataLimLower_1] , yy1,'Color','red');
line([DataLimUpper_1 , DataLimUpper_1] , yy1,'Color','red');
line([DataLimLower_2 , DataLimLower_2] , yy2,'Color','red');
line([DataLimUpper_2 , DataLimUpper_2] , yy2,'Color','red');
end</pre></div></div><a href='http://rosa.unipr.it/fsda/medcouple.html#Example_4'><img vspace="5" hspace="5" src="images\medcouple_02.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)."> </a></p></div></div></div><p> </p><div class="examples"><h2 id="ExtraExamples" class="bottom_ruled">Related Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="Extraexample_1" class="example_module expandableContent"><div id="ExtraExample_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Assess the perfomance of the various medcouple solutions.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">% Uses the time execution of the weighted median returned in varargout
% Tm=matlab-fast-quickselectFSw; Tw=matlab-fast-whimed
% Ts=matlab-simplified; To=matlab-octile; Tq=matlab-quantiles;
tm=0; tmmex=0; tw=0; ts=0; to = 0; tq=0;
N      = 800;   % sample size
cycles = 1000;  % number of repetitions
for c = 1:cycles
if mod(c,floor(cycles/10))==0, disp(['repetition n. ' num2str(c)]); end
% Generate different random sequences (seed 896 is a good one to
% compare consistency with the original C code on a difficult sequence)
myseed = randi(1000,1,1);
rng(myseed , 'twister');
datain = rand(N,1);
% REMARK: to generate N random integers (for example between 1 and
% 1000) using the Mersenne Twister in both C and MATLAB, note that the
% line below is equivalent to randi(1000,N,1):
%datain = ceil(datain*1000);
% Line below is to test with skewed data from the lognormal
%datain = lognrnd(0,1,N,1);
% just to ensure that data are stored in a column vector
datain = datain(:);
% $n\log n$, using quickselectFSw
tm0 = tic;
[MCm , t_diva] = medcouple(datain,0,0);
tm  = tm+toc(tm0);
% $n\log n$, using quickselectFSwmex
tm0mex = tic;
[MCmmex , t_diva_mex] = medcouple(datain,0,2);
tmmex  = tmmex+toc(tm0mex);
% $n\log n$, using Haase's weighted median (which is based on MATLAB sortrows)
tw0 = tic;
[MCw , t_Haase] = medcouple(datain,0,1);
tw  = tw+toc(tw0);
% $n^2$ "naive" algorithm, simplified
ts0 = tic;
MCs = medcouple(datain,1);
ts  = ts+toc(ts0);
% Quantiles-based approximation
to0 = tic;
MCo = medcouple(datain,2);
to  = to+toc(to0);
% Octiles-based approximation
tq0 = tic;
MCq = medcouple(datain,3);
tq  = tq+toc(tq0);
end
disp(' ');
disp(['OVERALL TIME EXECUTION IN ' num2str(cycles) ' MC COMPUTATION']);
disp(['time using WM by Haase       = ' num2str(tw)]);
disp(['time using quickselectFSw    = ' num2str(tm)]);
disp(['time using quickselectFSwmex = ' num2str(tmmex)]);
disp(['time using the naive         = ' num2str(ts)]);
disp(['time using quantiles         = ' num2str(tq)]);
disp(['time using octiles           = ' num2str(to)]);
disp(' ');
disp('TIME SPENT IN COMPUTING WEIGHTED AVERAGES IN A SINGLE MC COMPUTATION')
disp(['t_Haase             = ' num2str(t_Haase)]);
disp(['t_quickselectFSw    = ' num2str(t_diva)]);
disp(['t_quickselectFSwmex = ' num2str(t_diva_mex)]);</pre></div></div><pre class="codeoutput">repetition n. 100
repetition n. 200
repetition n. 300
repetition n. 400
repetition n. 500
repetition n. 600
repetition n. 700
repetition n. 800
repetition n. 900
repetition n. 1000
 
OVERALL TIME EXECUTION IN 1000 MC COMPUTATION
time using WM by Haase       = 1.067
time using quickselectFSw    = 0.6265
time using quickselectFSwmex = 0.40976
time using the naive         = 1.8243
time using quantiles         = 0.03866
time using octiles           = 0.096466
 
TIME SPENT IN COMPUTING WEIGHTED AVERAGES IN A SINGLE MC COMPUTATION
t_Haase             = 0.0011679
t_quickselectFSw    = 0.0003701
t_quickselectFSwmex = 0.0001257
</pre></p></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="Inputs">Input Arguments</h2><div class="expandableContent"><div class="arguments"><div class="input_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"> <div id="inputarg_z" class="clearfix"> </div> <h3 id="input_argument_z" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>z</code> &#8212; Uni-dimensional array. </span>  </a><span class="example_desc">The elements of the array z represent a  
        sample from a univariate distribution.</span></span></h3> <div class="collapse"> <p>They can be missing (nan)
        of infinite (inf) values, which are excluded from the computation
        if present.</p> <p class="datatypelist"><strong> Data Types: </strong><code>single| double</code></p> </div> </div><div id="optionalarguments" class="clearfix"></div><h3 id="namevaluepairs" class="bottom_ruled">Optional Arguments</h3><div class="expandableContent"> <div id="inputarg_mcm" class="clearfix"> </div> <h3 id="input_argument_mcm" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>mcm</code> &#8212; Scalar. </span>  </a><span class="example_desc">Medcouple Method.</span></span></h3> <div class="collapse"> <p><p>By default (mcm = 0 or not specified)
          the medcouple is computed using a fast $O(n log n)$ algorithm.</p> <p>
          mcm = 1 applies a naive $O^2(n)$ method. With mcm = 2 the
          medcouple is replaced by a quantile-based approximation.</p> <p>
          Similarily, mcm = 3 uses a octile-based approximation.</p> <p>
          All methods are discussed in the references reported below. The
          fast options are the most precise; the simplified (naive)
          algotithm is also very fast but may be less accurate, as the
          kernel function of Hubert and Struyf is implemented in a way
          that does not take into account possible zeros at the
          denominator (these cases are simply not considered in the
          calculation). The quantile and octile approximations by
          definition are robust skewness estimators alternatives to the
          medcouple.</p><p>
          </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code>'mcm',2
</code></p> <p class="datatypelist"><strong> Data Types: </strong><code>single | double</code></p> </div> </div><div class="expandableContent"> <div id="inputarg_wmm" class="clearfix"> </div> <h3 id="input_argument_wmm" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>wmm</code> &#8212; Scalar. </span>  </a><span class="example_desc">Weighted Median Method.</span></span></h3> <div class="collapse"> <p><p>By default (wmm=0 or not specified)
          the weighted median is computed using function quickselectFSw,
          which csn compute any weighted quantile. If wmm=1 the weighted
          median is computed using the algorithm by Sven Haase
          <a href="https://it.mathworks.com/matlabcentral/fileexchange/23077-weighted-median">https://it.mathworks.com/matlabcentral/fileexchange/23077-weighted-median</a>
          Option wmm=2 applies the mex file quickselectFSwmex.</p> <p>
          </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code>'wmm',1
</code></p> <p class="datatypelist"><strong> Data Types: </strong><code>single | double</code></p> </div> </div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="OutputArgs" >Output Arguments</h2><div class="expandableContent"><div class="arguments"><div class="output_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"><div id="outputarg_medout" class="clearfix"></div><h3 id="output_argument_medout" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>medout</code> &#8212;The medcouple of z.</span></a><span class="example_desc">Scalar</span></span></h3><div class="collapse"><p> This is a robust measure of  
            skewness for the elements in z.</p></div></div><div class="expandableContent"><div id="outputarg_varargout" class="clearfix"></div><h3 id="output_argument_varargout" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>varargout</code> &#8212;T     : The execution time spent for computing the weighted median.</span></a><span class="example_desc">Scalar</span></span></h3><div class="collapse"><p><p> The computation of the weighted median is a critical
            step in the medcouple and it is also computational demanding.</p> <p>
            For assessment purposes it is reported optionally.</p></p></div></div></div></div></div></div><div class="moreabout ref_sect"><h2 id="MoreAbout">More About</h2><div class="expandableContent"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent" itemprop="content"><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span>Additional Details</span></a></span></h3><div class="expand"><p><p>
﻿The fast algorithm for the medcouple (Brys G., Hubert M. and Struyf A., 
 2004) is a robust measure of skewness used to adjust the whiskers of a
 boxplot (Hubert M. and Vandervierenb E., 2008) and avoid wrong
 declaration of outliers in asymmetric univariate data. The medcouple
 replaces the classical skewness (that is based on the third moment of a
 data distribution) with a scaled median difference of the left and right
 half of the distribution. More precisely, it is defined as the median of
 the kernel function
 $h(z_i,z_j)=\frac{(z_j-median(z))-(median(z)-z_i)}{z_j-z_i}$ over all
 pairs $(z_i,z_j)$ where $z_i&lt;=median(z)$ and $z_j &gt;= median(z)$. The MATLAB
 toolbox LIBRA  <a href="(http://wis.kuleuven.be/stat/robust.html)">(http://wis.kuleuven.be/stat/robust.html)</a>and the R package
 robustbase  <a href="(https://cran.r-project.org/web/packages/robustbase)">(https://cran.r-project.org/web/packages/robustbase)</a> implement
 the fast medcouple with wrapper functions to the same compiled C source,
 to maximize speed. This <a href="medcouple.html">medcouple</a> function replicates faithfully the C
 function mlmc.c in pure MATLAB code, but replaces the key computations of
 the median and weighted median (which are intensively used) with calls to
 the FSDA functions quickselectFS and quickselectFSw or, optionally, to
 the $n\log n$ solution of Sven Haase (2022) <a href="weightedMedian.html">weightedMedian</a>. The result
 is a readable MATLAB function that does not ﻿sacrifices performance. The
 FSDA implementation also optimizes the computation of the medcouple
 kernel function, to take into account the case where there are multiple
 values equal to the median, the denominator becomes 0 and the kernel is
 therefore defined differently: we computed it efficiently in the
 sub-function calwork, using the signum function. The consistency of the
 MATLAB and original C implementations have been carefully verified with
 simulations that ensure the same random numbers generation in the two
 environments. The code that has been used can be found in the FSDA github
 project.</p> <p>

</p></p></div></div></div></div><div class="ref_sect" itemprop="content"><div class="bibliography"><h2 id="References">References</h2> <div><p>Brys G., Hubert M. and Struyf A. (2004), A Robust Measure of Skewness,
 "Journal of Computational and Graphical Statistics", Vol. 13(4), pp.
 996-1017.</p></div><div><p>Hubert M. and Vandervierenb E. (2008), An adjusted boxplot for skewed
 distributions, "Computational Statistics and Data Analysis", Vol. 52, pp.
 5186-5201.</p></div><div><p>Johnson D.B. and Mizoguchi T. (1978), Selecting the Kth Element in X + Y
 and X1 + X2 + ... + Xm, "SIAM Journal of Computing", Vol. 7, pp. 147-153.</p></div><div><p>Hinkley D.V. (1975), On Power Transformations to Symmetry, "Biometrika",
 Vol. 62, pp.101-111.</p></div></div></div><div class="ref_sect"><h2 id="SeeAlso">See Also</h2><p><span itemprop="seealso"><a href="quickselectFS.html" itemprop="url"><span itemprop="name"><code>quickselectFS</code></span></a></span> | <span itemprop="seealso"><a href="quickselectFSw.html" itemprop="url"><span itemprop="name"><code>quickselectFSw</code></span></a></span></div><i>This page has been automatically generated by our routine <a href="publishFS.html">publishFS</a></i></div></section></div></div></div></div><div id="divbottom"></div></body></html>