<!DOCTYPE HTML> <html itemscope="" xmlns="http://www.w3.org/1999/xhtml"><head><title>msdcutoff</title><meta content="refpage" name="chunktype"><meta content="function:msdcutoff" itemprop="refentity" name="refentity"><meta content="text/javascript" http-equiv="Content-Script-Type"><meta content="fcn" itemprop="pagetype" name="toctype"><meta content="ref/function" itemprop="infotype" name="infotype" /><meta content=" Mahalanobis Squared Distance cutof." itemprop="description" name="description" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /><script type="text/x-mathjax-config">MathJax.Hub.Config({extensions: ["tex2jax.js"],jax: ["input/TeX","output/HTML-CSS"],menuSettings: {zoom: "Double-Click", zscale: "300"},tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},MathMenu: {showRenderer: false},"HTML-CSS": {availableFonts: ["TeX"],preferredFont: "TeX",imageFont: null}});</script><script type="text/javascript" src="includesFS/Mathjax/MathJax.js"></script><script src="includesFS/matlab-highlighter.min.js"></script><link href="includesFS/matlab-highlighter.css" rel="stylesheet" type="text/css"><script type="text/javascript" src="includesFS/jquery-latest.js"></script><script>$(document).ready(function(){      $("#divtop").load("includesFS/top.html");      $("#divbottom").load("includesFS/bottom.html");});</script><link href="../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)"></link><link href="../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)"></link><link href="../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)"></link><link href="../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)"></link><link href="../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)"></link><link href="../includes/product/css/site6_offcanvas.css" rel="stylesheet" type="text/css"></link><script src="../includes/shared/scripts/l10n.js" type="text/javascript"></script><script src="../includes/product/scripts/docscripts.js"></script><script src="../includes/shared/scripts/docscripts_rn.js"></script><script src="../includes/shared/scripts/mw.imageanimation.js" type="text/javascript"></script><script src="../includes/shared/scripts/jquery.highlight.js"></script><script src="../includes/product/scripts/bootstrap.min.js" type="text/javascript"></script><script src="../includes/product/scripts/global.js"></script><script src="includesFS/bottom.js" type="text/javascript"></script><script src="../includes/product/scripts/underscore-min.js"></script><script src="../includes/shared/scripts/f1help.js" type="text/javascript"></script><script src="../includes/product/scripts/suggest.js" type="text/javascript"></script><script src="../includes/shared/scripts/helpservices.js" type="text/javascript"></script><script src="../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script><!-- the following line should be kept this way only --><link href="includesFS/doc_center.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css"><link href="../includes/product/css/doc_center_print.css" media="print" rel="stylesheet" type="text/css"></head><body  onload="highlightMATLABCode();" id="responsive_offcanvas">  <div id="doc_header_spacer" class="header"></div><div class="sticky_header_container includes_subnav"><div class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-xs-12 col-sm-6 col-sm-push-6 col-md-5 col-md-push-7" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2017a" data-language="en" action="../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="sr-only">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"><div class="input-group-btn"><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search pull-right icon_32 visible-xs" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="col-sm-6 col-sm-pull-6 col-md-7 col-md-pull-5" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../documentation-center.html">Documentation</a></h1></div></div></div><div class="visible-xs" id="search_actuator"><button class="btn icon-search btn_search pull-right icon_16" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div><!--END.CLASS row--> </div><!--END.CLASS container-fluid--> </div><!--END.CLASS section_header level_3--><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_actuator" data-toggle="offcanvas" data-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="sr-only">Toggle navigation</span><span class="icon-menu icon_24"></span></button><span class="offcanvas_actuator_label"></span><span class="offcanvas_actuator_close"></span> </div><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-md-12 hidden-xs hidden-sm"></div></div></div></div></div></div></div><!--END.CLASS sticky_header_container--><div class="row-offcanvas row-offcanvas-left"><div id="sidebar" class="sidebar-offcanvas" role="navigation"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" xmlns:atict="http://www.arbortext.com/namespace/atict"><li itemprop="breadcrumb" itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb"> <a href="../documentation-center.html" itemprop="url"> <span itemprop="title">All Products</span></a></li></ul><ul class="nav_disambiguation" xmlns:atict="http://www.arbortext.com/namespace/atict"><li class="product"><a href="index.html">Flexible Statistics and Data Analysis (FSDA)</a><div class="dropdown"> <span id="dropdownMenu1" class="icon-arrow-down icon_16" data-toggle="dropdown"> </span><ul aria-labelledby="dropdownMenu1" class="dropdown-menu dropdown-menu-right" role="menu"><li role="presentation"> <a href="examples.html" role="menuitem" tabindex="-1">Examples</a></li><li role="presentation"> <a href="function-alpha.html" role="menuitem" tabindex="-1"> Functions and Other Reference</a></li><li role="presentation"> <a href="release_notes.html?s_cid=doc_flyout" role="menuitem" tabindex="-1"> Release Notes</a></li><li role="presentation"> <a href="tutorials.html" role="menuitem" tabindex="-1"> Tutorials</a></li></ul></div></li></ul><ul xmlns:atict="http://www.arbortext.com/namespace/atict" class="nav_disambiguation"> <li><a href="index.html">Flexible Statistics and Data Analysis Toolbox</a> </li> <li><a href="function-cate.html" itemprop="url">Functions</a></li></ul><!-- --><ul class="nav_scrollspy nav" xmlns:atict="http://www.arbortext.com/namespace/atict">  <li class="nav_scrollspy_function"> <a href="#responsive_offcanvas">msdcutoff</a></li> <li id="SSPY810-refentry" class="nav_scrollspy_title">On this page</li><li><a class="intrnllnk" href="#syntax">Syntax</a></li><li><a class="intrnllnk" href="#Description">Description</a></li><li><a class="intrnllnk" href="#Examples">Examples</a><ul><li><a class="intrnllnk" href="#Example_1">cutoff for a standard Normal.</a></li><li><a class="intrnllnk" href="#Example_2">cutoff for a Student-t.</a></li></ul></li><li><a class="intrnllnk" href="#ExtraExamples">Extra Examples</a><ul><li><a class="intrnllnk" href="#ExtraExample_1">cutoff values for robust squared Mahalanobis distances.</a></li></ul></li><li><a class="intrnllnk" href="#Inputs">Input Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_conflev">conflev</a></li><li><a class="intrnllnk" href="#input_argument_v">v</a></li><li><a class="intrnllnk" href="#input_argument_nu">nu</a></li></ul></li><li><a class="intrnllnk" href="#OutputArgs">Output Arguments</a><ul><li><a class="intrnllnk" href="#output_argument_cutoff">cutoff</a></li></ul></li><li><a class="intrnllnk" href="#MoreAbout">More About</a></li><li><a class="intrnllnk" href="#References">References</a></li><li><a class="intrnllnk" href="#SeeAlso">See Also</a></li></ul></nav><script src="../includes/product/scripts/offcanvas.js"></script></div><div id="divtop"></div><div class="site_container site_toc_closed"><div class="page_container"><div class="content_frame"><div id="content_container" class="content_container"><section id="doc_center_content"><div class="function_ref"><div itemprop="content"><h1 itemprop="title">msdcutoff</h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose"> Mahalanobis Squared Distance cutof</p><div class="switch"><a id="expandAllPage" href="javascript:void(0);">expand all in page</a></div></div></div></div><div class="ref_sect"><h2 id="syntax">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><ul><li><code class="synopsis">cutoff=msdcutoff(conflev,v)</code><span class="syntax_example"><a class="intrnllnk" href="msdcutoff.html#Example_1">example</a></span></li><li><code class="synopsis">cutoff=msdcutoff(conflev,v,nu)</code><span class="syntax_example"><a class="intrnllnk" href="msdcutoff.html#Example_2">example</a></span></li></ul></div></div></div>	<div class="ref_sect" itemprop="content">							<h2 id="Description">Description</h2>							<div class="descriptions">								<div class="description_module"><p>Critical threshold derived from the Mahalanobis Squared Distance 
 distribution for normal or Student-t population.</p><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="msdcutoff.html#Example_1">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_cutoff"><code>cutoff</code></a>=msdcutoff(<a class="intrnllnk" href="#inputarg_conflev"><code>conflev</code></a>,<a class="intrnllnk" href="#inputarg_v"><code>v</code></a>)</code></span>cutoff for a standard Normal.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="msdcutoff.html#Example_2">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_cutoff"><code>cutoff</code></a>=msdcutoff(<a class="intrnllnk" href="#inputarg_conflev"><code>conflev</code></a>,<a class="intrnllnk" href="#inputarg_v"><code>v</code></a>,<a class="intrnllnk" href="#inputarg_nu"><code>nu</code></a>)</code></span>cutoff for a Student-t.</p></div>								</div>							</div>							<div class="clear">							</div>						</div><div class="ref_sect" itemprop="content"><div class="examples"><h2 id="Examples">Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="example_1" class="example_module expandableContent"><div id="Example_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>cutoff for a standard Normal.</li></span></a></span></h3><div class="collapse"><p>.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">n  = 100;
v  = 3;
conflev = 0.975;
cutoffN = msdcutoff(conflev,v);</pre></div></div></p></div></div><div id="example_2" class="example_module expandableContent"><div id="Example_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>cutoff for a Student-t.</li></span></a></span></h3><div class="collapse"><p>.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">n  = 100;
v  = 3;
nu = 5;
cutoffT = msdcutoff(conflev,v,nu);</pre></div></div></p></div></div></div><p> </p><div class="examples"><h2 id="ExtraExamples" class="bottom_ruled">Related Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="Extraexample_1" class="example_module expandableContent"><div id="ExtraExample_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> cutoff values for robust squared Mahalanobis distances.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">n  = 100;    v  = 3;    nu = 5;    conflev = 0.975;    % sample from the T    Yt = random('T',nu,[n,v]);     Yn = random('Normal',0,1,[n,v]);     % mcd with the T-model    RAWt = mcd(Yt,'modelT',nu,'plots',0);    % mcd with the Normal-model    RAWn = mcd(Yn,'plots',0);    % T-cutoff    cutoffT = msdcutoff(conflev,v,nu);    % Normal-cutoff    cutoffN = msdcutoff(conflev,v);    plot(1:n,RAWt.md,'xr' , 1:n,RAWn.md,'ob');     hold on;    line([1 , n] , [cutoffT , cutoffT] , 'Color', 'r');    line([1 , n] , [cutoffN , cutoffN] , 'Color', 'b');    legend({'Student-t','Normal','cutoff-t','cutoff Normal'});</pre></div></div><pre class="codeoutput">Total estimated time to complete MCD:  0.64 seconds 
Total estimated time to complete MCD:  0.19 seconds 
</pre><a href='http://rosa.unipr.it/fsda/msdcutoff.html#ExtraExample_1'><img vspace="5" hspace="5" src="images/msdcutoff_01.png" alt="Click here for the graphical output of this example (link to Ro.S.A. website)"> </a></p></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="Inputs">Input Arguments</h2><div class="expandableContent"><div class="arguments"><div class="input_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"> <div id="inputarg_conflev" class="clearfix"> </div> <h3 id="input_argument_conflev" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>conflev</code> &#8212; Confidence level. </span>  </a><span class="example_desc">Scalar.</span></span></h3> <div class="collapse"> <p>Number between 0 and 1 containing
               confidence level.
               Usually conflev=0.95, 0.975 0.99 (individual alpha)
               or 1-0.05/n, 1-0.025/n, 1-0.01/n (simultaneous alpha).
               Default value is 0.975
               Example - 'conflev',0.99
               </p> <p class="datatypelist"><strong> Data Types: </strong><code>double</code></p> </div> </div><div class="expandableContent"> <div id="inputarg_v" class="clearfix"> </div> <h3 id="input_argument_v" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>v</code> &#8212; Multivariate dimension. </span>  </a><span class="example_desc">Scalar.</span></span></h3> <div class="collapse"> <p>Number of variables in the 
               multivariate sample. 
               Example - 'v',2
               </p> <p class="datatypelist"><strong> Data Types: </strong><code>double</code></p> </div> </div><div id="optionalarguments" class="clearfix"></div><h3 id="namevaluepairs" class="bottom_ruled">Optional Arguments</h3><div class="expandableContent"> <div id="inputarg_nu" class="clearfix"> </div> <h3 id="input_argument_nu" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>nu</code> &#8212; Degrees of freedom. </span>  </a><span class="example_desc">Scalar.</span></span></h3> <div class="collapse"> <p>If this optional argument is 
               provided, then the sample is assumed to be heavy-tailed and 
               modelled by a Student-t distribution with nu degrees of 
               freedom. nu must be a positive value. 
               </p>	<p class="description_valueexample">       <strong>Example: </strong><code>'nu',5
</code></p> <p class="datatypelist"><strong> Data Types: </strong><code>double</code></p> </div> </div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="OutputArgs" >Output Arguments</h2><div class="expandableContent"><div class="arguments"><div class="output_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"><div id="outputarg_cutoff" class="clearfix"></div><h3 id="output_argument_cutoff" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>cutoff</code> &#8212;Cutoff value.</span></a><span class="example_desc">Scalar</span></span></h3><div class="collapse"><p> The cutoff value for the Mahalanobis 
               Squared Distances distribution.</p></div></div></div></div></div></div><div class="moreabout ref_sect"><h2 id="MoreAbout">More About</h2><div class="expandableContent"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent" itemprop="content"><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span>Additional Details</span></a></span></h3><div class="expand"><p> Mahalanobis distances measure the distance of a sample unit from the mean
 of a distribution, taking into account the correlation between the units
 in the covariance matrix. If $x$ is an observation from a multivariate
 distribution with mean $\mu$ and covariance $\Sigma$, the Mahalanobis
 squared distance (MSD) of $x$ from $\mu$ is $D^{2}=(x − \mu)^{t}
 \Sigma^{-1} (x − \mu)$. When $x$ is from a $v$-dimensional multivariate
 normal with known mean and covariance, the population MSD is distributed
 as a chi-squared $\chi_{v}^{2}$ random variable with $\nu$ degrees of
 freedom (Mardia et al, 1979). Then, to test the deviation of an
 observation from the multivariate normal assumption we can compare its
 MSD with an appropriate quantile of the chi-squared distribution: the
 observation will be considered an outlier if the associated $D^{2}$ value
 is larger than the critical value of the chi-squared distribution. There
 are known limitations to the application of this cut-off, for example
 when the sample is high dimensional and its size is not sufficiently
 high. In this case the distribution of the sample MSD is a scaled Beta
 distribution (Gnanadesikan and Kettenring, 1972). For continuous
 Student-t samples, which account for heavy-tailed distributions, the
 appropriate cutoff value depends from a standard Beta distribution with
 shape parameters $v/2$ and $\nu/2$, as shown by Barabesi et al (2023).

</p></div></div></div></div><div class="ref_sect" itemprop="content"><div class="bibliography"><h2 id="References">References</h2> <div><p>Gnanadesikan, R. and Kettenring, J. R. (1972), Robust estimates,
 residuals, and outlier detection with multiresponse data. Biometrics,
 28:81–124.</p></div><div><p>Barabesi, L. and Cerioli, A. and García-Escudero, L.A. and Mayo-Iscar,
 A. (2023), Trimming heavy-tailed multivariate data. Submitted.</p></div><div><p>Mardia, K. and Kent, J. and Bibby, J. (1979), Multivariate Analysis,
 Academic Press, New York.</p></div><div><p>Rousseeuw, P.J. and Van Driessen, K. (1999), A fast algorithm for the
 minimum covariance determinant estimator, Technometrics, 41:212-223.</p></div><div><p>Maronna, R.A., Martin D. and Yohai V.J. (2006), "Robust Statistics,
 Theory and Methods", Wiley, New York.</p></div></div></div><div class="ref_sect"><h2 id="SeeAlso">See Also</h2><p><span itemprop="seealso"><a href="mcd.html" itemprop="url"><span itemprop="name"><code>mcd</code></span></a></span></div><i>This page has been automatically generated by our routine <a href="publishFS.html">publishFS</a></i></div></section></div></div></div></div><div id="divbottom"></div></body></html>