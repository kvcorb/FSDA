<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<html><head>
<!--FScategory:Robust Regression Analysis and transformations-->
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"><title>FSRBmdr :: Functions (Flexible Statistics Data Analysis
Toolbox™)</title>

<link href="docstyle.css" rel="stylesheet" type="text/css">
<meta content="refpage" name="chunktype">
<script language="javaScript" src="bottom.js" type="text/javascript"></script>
</head>


<body>
<a name="top_of_page"></a>
<p style="font-size: 1px;">&nbsp;</p>
<table class="nav" summary="Navigation aid" border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody>
<tr>
<td valign="baseline"><b>Flexible Statistics
Data Analysis Toolbox™</b></td>
<td align="right" valign="baseline"><a href="fsrinvmdr.html"> <img alt="FSRfan" src="images_help/b_prev.gif" align="bottom" border="0"></a>&nbsp;&nbsp;
<a href="fsrms.html"> <img alt="" src="images_help/b_next.gif" align="bottom" border="0"></a></td>
</tr>
</tbody>
</table>
<a name="bq24of9-1"></a><a class="indexterm" name="zmw57dd0e69698"></a>
<h1 class="reftitle">FSRBeda</h1>
<p class="purpose">Bayesian minimum deletion residual </p>
<h2>Syntax </h2>
<p class="synopsis"><tt>[out]
= FSRBeda(y, X)<br>
[out] = FSRBeda(y, X,&nbsp;<i>param1</i>,
<i><tt>val1</tt></i>, <i><tt>param2</tt></i>,
<i><tt>val2</tt></i>,...)<br>
</tt></p>
<a name="bq24of9-2"></a>
<h2>Description</h2>
<p><tt>[out] = FSRBeda(y, X)</tt> </p>
<p>enables to monitor several quantities in each step of the
Bayesian search. </p>
<table class="body" border="2" cellpadding="4" cellspacing="0">
<colgroup><col width="21%"><col width="79%"></colgroup>
<thead> <tr>
<th bgcolor="#b2b2b2">Parameter</th>
<th bgcolor="#b2b2b2">Value</th>
</tr>
</thead> <tbody>
<tr>
<td bgcolor="#f2f2f2"><tt>'y'</tt></td>
<td bgcolor="#f2f2f2">A vector with n elements that
contains the response variables.&nbsp;Missing values (NaN's) and
infinite values (Inf's) are&nbsp;allowed, since observations (rows)
with missing or infinite&nbsp;values will automatically beexcluded
from the computations.</td>
</tr>
<tr>
<td bgcolor="#f2f2f2"><tt>'X'</tt></td>
<td bgcolor="#f2f2f2"> Data matrix of explanatory
variables (also called 'regressors') of dimension (n x p-1). Rows of <tt>X</tt>
represent observations, and columns represent variables. Missing values
(NaN's) and infinite values (Inf's) are allowed, since observations
(rows) with missing or infinite values will automatically be excluded
from the computations.</td>
</tr>
<tr>
<td bgcolor="#f2f2f2"></td>
<td bgcolor="#f2f2f2">PRIOR INFORMATION: <br>
β is assumed to have a normal distribution with mean β and (conditional
on τ) covariance (1/τ<sub>0</sub>) (X<sub>0</sub>'X<sub>0</sub>)<sup>-1</sup>
β~N(β<sub>0</sub>, (1/τ<sub>0</sub>) (X<sub>0</sub>'X<sub>0</sub>)<sup>-1</sup>)
<br>
The prior distribution of τ<sub>0</sub> is a γ distribution
with parameters a and b, that is p(τ<sub>0</sub>) ∝ τ<sup>a<sub>0</sub>-1</sup>
Exp(-b<sub>0</sub>, τ) and E(τ<sub>0</sub>)= a<sub>0</sub>/b<sub>0</sub></td>
</tr>
</tbody>
</table>
<p>Remark: The user should only give the input arguments that
have to change their default value. The name of the input arguments
needs to be followed by their value. The order of the input arguments
is of no importance. Missing values (NaN's) and infinite values (Inf's)
are allowed, since observations (rows) with missing or infinite values
will automatically be excluded from the computations. y can be both a
row of column vector.
</p>
<p><tt><a name="bq24of9-3"></a>[out]=FSRBeda(y,
X)</tt> returns the following information </p>
<ul type="disc">
<li>
<tt>RES: n-by-(n-init+1)</tt> matrix containing the
monitoring of scaled residuals<br>
1st row = residual for first unit<br>
......<br>
nth row = residual for nth unit.
</li>
<li>
<tt>LEV: (n+1)-by-(n-init+1)</tt> matrix containing
the monitoring of leverage
1st row = leverage for first unit<br>
......<br>
nth row = leverage for nth unit.
</li>
<li>
<tt>BB: n-by-(n-init+1)</tt> matrix which the
units belonging to the subset at each step of the forward search.<br>
1st col = index forming subset in the initial step<br>
...<br>
last column = units forming subset in the final step (i.e. all units).<br>

</li>
<li>
<p><tt>mdr: (n-init)-by-3</tt> matrix which contains
the monitoring of Bayesian minimum deletion residual or (m+1)ordered
residual at each step of the forward search.
1st col = fwd search index (from init to n-1)<br>
2nd col = minimum deletion residual<br>
3rd col = (m+1)-ordered residual<br>
Remark: these quantities are stored with sign, that is the min deletion
residual is stored with negative sign if it corresponds to a negative
residual.
</p>
</li>
<li>
<p><tt>msr: (n-init)-by-3</tt> matrix which
contains the monitoring of Bayesian minimum deletion residual or
(m+1)ordered residual at each step of the forward search.
1st col = fwd search index (from init to n-1)<br>
2nd col = minimum deletion residual
3rd col = (m+1)-ordered residual
Remark: these quantities are stored with sign, that is the min deletion
residual is stored with negative sign if it corresponds to a negative
residual
</p>
</li>
<li>
<p><tt>Bols</tt>: <tt>(n-init+1)-by-(p+1)</tt> matrix
containing the monitoring of posterior mean (conditional on τ<sub>0</sub>)
of
β (regression coefficents) β<sub>1</sub> = (cR + X'X)<sup>-1</sup>
(cRβ<sub>0</sub>+X'y)<br>
</p>
</li>
<li>
<tt>covbeta1</tt>: <tt> p-by-p-by-(n-init+1)</tt> 3D array containing posterior covariance matrix (conditional on τ<sub>1</sub>) of β
<tt>covbeta1</tt> = (1/τ<sub>1</sub>) * (cR + X'X)<sup>-1</sup> where τ<sub>1</sub> is defined as a<sub>1</sub>/b<sub>1</sub>
(that is through the gamma parameters of the posterior distribution of
τ) The posterior distribution of τ is a gamma distribution with
parameters a<sub>1</sub> and b<sub>1</sub>.
</li>
<li>
<tt>gam</tt>: <tt> (n-init+1)-by-3</tt> matrix containing:<br>
1st col = fwd search index (from init to n)<br>
2nd col = parameter a<sub>1</sub> of the posterior gamma distribution of &tau;<br>
3rd col = parameter b<sub>1</sub> of the posterior gamma distribution of &tau;<br>
Remark: a<sub>1</sub> = 0.5(cn<sub>0</sub> + m) where m is subset size b<sub>1</sub> 
= 0.5( n0 / &tau;<sub>0</sub> + (y-X*&beta;<sub>1</sub>)'y +(&beta;<sub>0</sub>-&beta;<sub>1</sub>)'cR&beta;<sub>0</sub> )
</li>
<li>
<tt>S2</tt>: <tt> (n-init+1)-by-3</tt> matrix containing the monitoring of S<sup>2</sup> or R<sup>2</sup> in each step of the forward search<br>
1st col = fwd search index (from init to n)<br>
2nd col = monitoring of S<sup>2</sup> (S<sup>2</sup> is nothing but 1/&tau;<sub>1</sub>)<br>
3rd col = monitoring of R<sup>2</sup>
</li>
<li>
<tt>Coo</tt>: <tt> (n-init+1)-by-2</tt> matrix containing the monitoring of Cook or modified Cook distance in each step of the forward search<br>
1st col = fwd search index (from init to n)<br>
2nd col = monitoring of Cook distance
</li>
<li>
<tt>Bpval</tt>: <tt> (n-init+1)-by-(p+1)</tt>  containing Bayesian p-values.<br>
p-value = P(|t| > | \hat &beta; se(&beta;) |)= prob. of beta different from 0<br>
1st col = fwd search index (from init to n)<br>
2nd col = p-value for first variable<br>
...<br>
(p+1) col = p-value for p-th variable
</li>
<li>
<tt>Bhpd: (n-init+1)-by-2-by-p</tt> 3D array.<br>
<tt>Bhpd(:,:,1)</tt> = lower and upper HPDI conflev for first variable<br>
...<BR>
<tt>Bhpd(:,:,p)</tt> = lower and upper HPDI conflev for p-th variable
</li>
<li>
<tt>postodds: (n-init+1)-by-(p+1)</tt> matrix which contains posterior odds for &beta;<sub>j</sub>=0
For example the posterior odd of &beta;<sub>0</sub>=0 is p(y| model which contains all expl variables 
except the one associated with &beta;<sub>0</sub>) divided by 
p(y| model which contains all expl. variables)<br>
1st col = fwd search index (from init to n)<br>
2nd col = posterior odd for &beta;<sub>1</sub><br>
...<br>
(p+1) col = posterior odd for &beta;<sub>p</sub>
</li>
<li>
<tt>modelprob: (n-init+1)-by-(p+1)</tt> matrix which contains which contains
posterior model probability of the model which excludes
variable j. For example if modelprob(j)= 0.28, that is if
the probability of the model which does not contain
variable j is equal to 0.28, it means that there is a 28%
chance that &beta;<sub>j</sub>=0 and a 72% chance that it is not.<br>
1st col = fwd search index (from init to n)<br>
2nd col = posterior model prob of the model which excludes &beta;<sub>1</sub><br>
...<br>
(p+1) col = posterior model prob of the model which excludes &beta;<sub>p</sub>
</li>
<li>
<tt>Un: (n-init)-by-11</tt>  matrix which contains the unit(s)
included in the subset at each step of the fwd search.<br>
REMARK: in every step the new subset is compared with the
old subset.<br> 
<tt>Un</tt> contains the unit(s) present in the new
ubset but not in the old one <tt>Un(1,2)</tt> for example contains
the unit included in step <tt>init+1<br> Un(end,2)</tt> contains the
units included in the final step of the search.
</li>
<li>
<tt>y: </tt> A vector with n elements that contains the response variable which has been used
</li>
<li>
<tt>X: </tt> Data matrix of explanatory variables
which has been used (it also contains the column of ones if
input option intercept was missing or equal to 1)
</li>
</ul>
<ul>
<a name="zmw57dd0e69798"></a>
<table style="width: 811px; height: 65px;" class="note" summary="Note" border="1" cellpadding="5" cellspacing="0">
<tbody>
<tr width="90%">
<td>
<p><b>Note</b>&nbsp;<tt>FSRBeda</tt>
is an enhanced version of function <tt>FSRBmdr</tt>
with a set of flexible options and an articulate output. </p>
</td>
</tr>
</tbody>
</table>
</ul>
<p></p>
<p><tt>[out] = FSRBeda(y,X,<i><tt>param1</tt></i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)</tt>
specifies one or more of the name/value pairs described in the
following table.</p>
<table class="body" border="2" cellpadding="4" cellspacing="0">
<colgroup><col width="21%"><col width="79%"></colgroup>
<thead> <tr>
<th bgcolor="#b2b2b2">Parameter</th>
<th bgcolor="#b2b2b2">Value</th>
</tr>
</thead> <tbody>
<tr>
<td bgcolor="#f2f2f2"><tt>'intercept'</tt></td>
<td bgcolor="#f2f2f2">
<p>If 1, a model with constant term will be fitted
(default) else no constant term will be included.</p>
</td>
</tr>
<tr>
<td><tt>'bayes'</tt></td>
<td>a structure which specifies prior information<br>
Strucure bayes contains the following fields<br>
<tt>beta0</tt>:&nbsp; p-times-1 vector containing
prior mean of &beta;<br>
<tt>R</tt>&nbsp; p-x-p positive definite matrix
which can be
interepreted as X<sub>0</sub>'X<sub>0</sub>
where X<sub>0 </sub>is a n<sub>0</sub> x p
matrix coming from previous experiments (assuming that the intercept is
included in the model) <br>
The prior distribution of τ<sub>0</sub> is a γ distribution
with parameters a and b, that is p(τ<sub>0</sub>) ∝ τ<sup>a<sub>0</sub>-1</sup>
Exp(-b<sub>0</sub>, τ) and E(τ<sub>0</sub>)= a<sub>0</sub>/b<sub>0</sub><br>
<br>
<tt>tau0</tt>:&nbsp; scalar. Prior estimate of
τ=1/ σ<sup>2</sup> =a<sub>0</sub>/b<sub>0</sub><br>
<tt>n0</tt>&nbsp;: scalar.
Sometimes it helps to think of the prior information as coming from n<sub>0</sub>
previous experiments. Therefore we assume that matrix X<sub>0 </sub>(which
defines R), was made up of n<sub>0 </sub> observations. </td>
</tr>
<tr>
<td></td>
<td>
REMARK: if structure bayes is not supplied the default&nbsp;values
which are used are:<br>
<tt>beta0</tt>=zeros(p,1)vector of zeros<br>
<tt>R</tt>
=eye(p)Identity matrix<br>
<tt>tau0</tt>=1/1e+6; Very large value for the prior
variance, that is a
very small value for&nbsp;τ<sub>0</sub><br>
<tt>n0</tt>=1; just one prior observation</td>
</tr>
<tr>
<td bgcolor="#f2f2f2"><tt>'bsb'</tt></td>
<td bgcolor="#f2f2f2"> m x 1 vector containing
vector containing the list of units forming the
initial&nbsp;subset, if bsb=0 then the procedure starts with
p&nbsp;units randomly chosen else if bsb is not 0 the search
will start with m0=length(bsb). The default value of
bsb is '' that is in the first step just prior information is
used.</td>
</tr>
<tr>
<td bgcolor="#f2f2f2"><tt>'init'</tt></td>
<td bgcolor="#f2f2f2">
<p>scalar, which specifies the point where to initialize
the search and start monitoring required diagnostics. Notice that if
bsb is supplied init&gt;=length(bsb). if init is not specified it
will be set equal to <tt>p+1</tt>, if the sample size is
smaller than 40; <tt>min(3*p+1,floor(0.5*(n+p+1)))</tt>,
otherwise.</p>
</td>
</tr>
<tr>
<td bgcolor="#f2f2f2"><tt>'nocheck'</tt></td>
<td bgcolor="#f2f2f2">
<p>Scalar. If <tt>nocheck</tt> is equal to 1
no check is performed on matrix y and matrix X. Notice that y and X are
left unchanged. In other words the additional column of ones for the
intercept is not added. As default <tt> nocheck=0</tt>.</p>
</td>
</tr>
<tr>
<td bgcolor="#f2f2f2"><tt>'conflev'</tt></td>
<td bgcolor="#f2f2f2">
vector which contains the confidence levels to be used
to compute HPDI. This input option is used just if input <tt>stats=1</tt>.
The
default value of conflev is [0.95 0.99] that is 95% and 99% HPDI
confidence intervals are computed. </td>
</tr>
<tr>
<td bgcolor="#f2f2f2"></td>
<td bgcolor="#f2f2f2">
REMARK: The user should only give the input arguments
that have to change their default value. The name of the input
arguments needs to be followed by their value. The order of the input
arguments is of no importance.<br>
Missing values (NaN's) and infinite values (Inf's) are allowed, since
observations (rows) with missing or infinite values will automatically
be excluded from the computations. y can be both a row of column
vector.
</td>
</tr>
</tbody>
</table>
<p>&nbsp;References:<br>
Atkinson A.C. Corbellini A, and Riani M. (2015), Robust Bayesian
Regression, submitted.</p>
<p><br>
Copyright 2008-2014.<br>
Written by FSDA team</p>
<a name="bq9x7hn"></a><a name="bq5gf2y"></a>
<h3>Examples</h3>
In this example for the house price data we monitor the forward plots
in the second half of the search of HPD regions for the parameters of
the linear model and, bottom right-hand panel, the estimate of S<sup>2</sup>.<br>
The horizontal lines correspond to prior values.
<pre>
load hprice.txt;
close all;
n=size(hprice,1);
y=hprice(:,1);
X=hprice(:,2:5);
n0=5;
p=5;

% Hyperparameters for natural conjugate prior
b0=zeros(p,1);
b0(2,1)=10;
b0(3,1)=5000;
b0(4,1)=10000;
b0(5,1)=10000;
% s02=1/4.0e-1;
s02=1/4.0e-8;
capv0=2.4*eye(p);
capv0(2,2)=6e-7;
capv0(3,3)=.15;
capv0(4,4)=.6;
capv0(5,5)=.6;
capv0inv=inv(capv0);
R=capv0inv;
tau0=1/s02;


bayes=struct;
bayes.R=capv0inv;
bayes.n0=n0;
bayes.beta0=b0;
bayes.tau0=tau0;

% init = point to start monitoring diagnostics along the FS
init=250;

outBA=FSRBeda(y,X,'bayes',bayes,'init',init, 'conflev', [0.95 0.99]);

% Set font size, line width and line style
figure;
lwd=3;
FontSize=18;
linst={'-','--',':','-.','--',':'};

for ij=1:5
my_subplot=subplot(3,2,ij);
hold('on')
% plot 95% and 99% HPD trajectories
plot(outBA.Bols(:,1),outBA.Bhpd(:,1:2,ij),'LineStyle',linst{4},'LineWidth',lwd,'Color','r')
plot(outBA.Bols(:,1),outBA.Bhpd(:,3:4,ij),'LineStyle',linst{4},'LineWidth',lwd,'Color','b')

% plot posterior estimate
plot(outBA.Bols(:,1),outBA.Bols(:,ij+1)','LineStyle',linst{1},'LineWidth',lwd,'Color','k')

% Add the horizontal line which corresponds to prior values
xL = get(my_subplot,'XLim');
db0=b0(ij,1);
line(xL,[db0 db0],'Color','r','LineWidth',lwd);

% Set ylim
limU=max([outBA.Bhpd(:,4,ij); b0(ij)]);
limL=min([outBA.Bhpd(:,3,ij); b0(ij)]);
ylim([limL limU])

% Set xlim
xlim([init n]);

ylabel(['$\hat{\beta_' num2str(ij-1) '}$'],'Interpreter','LaTeX','FontSize',20,'rot',-360);
set(gca,'FontSize',FontSize);
if ij&gt;4
xlabel('Subset size m','FontSize',FontSize);
end
end

% Subplot associatied with the monitoring of sigma^2
subplot(3,2,6);
plot(outBA.S2(:,1),outBA.S2(:,2),'LineStyle',linst{1},'LineWidth',lwd,'Color','k')
set(gca,'FontSize',FontSize);
xlabel('Subset size m','FontSize',FontSize);
ylabel('$\hat{\sigma}^2$','Interpreter','LaTeX','FontSize',20);


% Add multiple title
suplabel('Housing data; forward plots in the second half of the search of HPD regions for beta','t')</pre>
<img src="plots/fsrbeda01.jpg">

<p></p>
<h3>See Also</h3>
<p><a href="fsrb.html"><tt>FSRB</tt></a>,
<a href="regressb.html">regressB</a></p>
<p></p>
<table class="nav" summary="Navigation aid" border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody>
<tr>
<td align="left" width="20"><a href="fsrinvmdr.html"> <img alt="FSRfan" src="images_help/b_prev.gif" align="bottom" border="0"></a>
</td>
<td align="left">fsrinvmdr.html</td>
<td>&nbsp;</td>
<td align="right">fsrms.html</td>
<td align="right" width="20"><a href="fsrms.html"> <img alt="levfwdplot" src="images_help/b_next.gif" align="bottom" border="0"></a></td>
</tr>
</tbody>
</table>
<script language="javaScript" type="text/javascript">
document.write(barra);
</script>
<!-- Last updated: Fri Jan 23 17:00:05 EST 2009-->
</body></html>