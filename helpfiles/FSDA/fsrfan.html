<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<!--FScategory:Robust Regression Analysis and transformations-->


<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<title>FSRfan :: Functions (Flexible Statistics Data Analysis Toolbox&trade;)</title>
<link href="docstyle.css" rel="stylesheet" type="text/css">
<meta content="refpage" name="chunktype">
<script  type="text/javascript" language="javaScript" src="bottom.js"></script>

</head>


<body>

<a name="top_of_page"></a>
<p style="font-size: 1px;">&nbsp;</p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr>
		<td valign="baseline"><b>Flexible Statistics Data Analysis Toolbox&trade;</b></td>
		<td align="right" valign="baseline"><a href="fsrenvmdr.html">
		<img align="bottom" alt="FSRenvmdr" border="0" src="images_help/b_prev.gif"></a>&nbsp;&nbsp;
		<a href="fsrh.html">
		<img align="bottom" alt="FSRmdr" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<a name="bq24of9-1"></a><a class="indexterm" name="zmw57dd0e69698"></a>
<h1 class="reftitle">Forward Score test</h1>
<p class="purpose">Score test statistic (see function
<a href="transf_score.html">Score</a>) for several values of the transformation 
parameter &lambda; in each step of the forward search. </p>
<h2>Syntax </h2>
<p class="synopsis"><tt>[out] = FSRfan(y,X)<br>[out] = FSRfan(y,X,<i><tt>param1</tt></i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)<br>
</tt></p>
<a name="bq24of9-2"></a>
<h2>Description</h2>
<p><tt>[out] = FSRfan(y,X)</tt> produces all the necessary elements to compute the 
‘‘fan plot&quot; which is nothing but the simultaneous forward plot of the score test 
statistic (see function <a href="transf_score.html">Score</a>) for several values 
of the transformation parameter &lambda;. Each search is separate, so that the observations 
may, and do, enter in different orders in the searches. This plot enables us to 
appraise in a quantitative way the percentage of observations in agreement with 
the different values of the transformation parameter If the size of the data set 
is small (i.e. smaller than 100) generally it is enough to consider the five most 
common value of &lambda; : &minus;1,&minus;0.5, 0, 0.5 and 1 otherwise a finer grid of values of &lambda; 
may be needed. </p>
<p>Function FSRfan performs a separate search for each value of &lambda; which is tested. 
The data are transformed and a starting point is found for each forward search, 
which then proceeds independently for each values of &lambda; using the transformed data.
</p>
<p><tt>y</tt> is a vector of length n containing the response values, while <tt>
X</tt> is the <i>n</i>-by-<i>p-1</i> matrix which contains (in the columns) the values 
of <i>p-1</i> predictive terms</p>
<p><tt><a name="bq24of9-3"></a>[out] = FSRfan(y,X)</tt> returns the following information
</p>
<ul type="disc">
	<li><tt>out</tt> &minus; A structure of additional statistics with the following fields.
	<ul type="circle">
		<li>
		<p><tt>Score</tt> &minus; (n-init) x length(la)+1 matrix containing the values 
		of the score test for each value of the transformation parameter <br>1st 
		col = fwd search index <br>2nd col = value of the score test in each step 
		of the fwd search for la(1) <br>........... <br>end col = value of the score 
		test in each step of the fwd search for la(end) </p>
		</li>
		<li>
		<p><tt>la</tt> &minus; vector containing the values of lambda for which fan plot 
		is constructed</p>
		</li>
		<li>
		<p><tt>bs</tt> &minus; p x length(la) matrix containing the units forming the 
		initial subset for each value of lambda</p>
		</li>
		<li>
		<p><tt>Un</tt> &minus; cell of size length(la). <tt>out.Un{i}</tt> is a (n-init) 
		x 11 matrix which contains the unit(s) included in the subset at each step 
		in the search associated with <tt>la(i)</tt>. REMARK: in every step the 
		new subset is compared with the old subset. Un contains the unit(s) present 
		in the new subset but not in the old one <tt>Un(1,2:end)</tt> for example 
		contains the unit included in step init+1 <br>...<br><tt>Un(end,2:end)</tt> 
		contains the units included in the final step of the search </p>
		</li>
		<li>
		<p><tt>y</tt> &minus; A vector with n elements that contains the response variable 
		which has been used </p>
		</li>
		<li>
		<p><tt>X</tt> &minus; Data matrix of explanatory variables which has been used 
		(it also contains the column of ones if input option intercept was missing 
		or equal to 1) </p>
		</li>
	</ul>
	<ul>
		<a name="zmw57dd0e69798"></a>
		<table border="1" cellpadding="5" cellspacing="0" class="note" summary="Note">
			<tr width="90%">
				<td>
				<p><b>Note</b>&nbsp;&nbsp; <tt>FSRfan</tt> automatically includes 
				a constant term in all models. Do not enter a column of 1s directly 
				into <tt>X</tt>.</p>
				</td>
			</tr>
		</table>
	</ul>
	</li>
</ul>
<p></p>
<p><tt>[out] = FSRfan(y,X,<i><tt>param1</tt></i>,<i><tt>val1</tt></i>,<i><tt>param2</tt></i>,<i><tt>val2</tt></i>,...)</tt> 
specifies one or more of the name/value pairs described in the following table.</p>
<table border="2" cellpadding="4" cellspacing="0" class="body">
	<colgroup>
		<col width="21%"><col width="79%">
	</colgroup>
	<thead>
		<tr valign="top">
			<th bgcolor="#B2B2B2">Parameter</th>
			<th bgcolor="#B2B2B2">Value</th>
		</tr>
	</thead>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;intercept&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>If 1, a model with constant term will be fitted (default) else no constant 
		term will be included.  </p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;nocheck&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>Scalar. If nocheck is equal to 1 no check is performed on matrix y and 
		matrix X. Notice that y and X are left unchanged. In other words the additional 
		column of ones for the intercept is not added. As default <tt>nocheck=0</tt>.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;la&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p>Vector which specifies for which values of the transformation parameter 
		&lambda; it is necessary to compute the score test. Default value of la is <tt>
		la=[-1 -0.5 0 0.5 1]</tt>; that is the five most common values of &lambda;</p>
		</td>
	</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2" style="height: 54px"><tt>&#39;h&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 54px">
		<p>The number of observations that have determined the least trimmed squares 
		estimator. <tt>h</tt> generally is an integer greater or equal than <tt>[(n+size(X,2)+1)/2]</tt> 
		but smaller then <tt>n</tt></p>
		</td>
	</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;nsamp&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Number of subsamples which will be extracted to find the robust estimator. 
		If <tt>nsamp=0</tt> all subsets will be extracted. They will be <tt>(n choose 
		p)</tt>. Remark: if the number of all possible subset is smaller than 1000 
		the default is to extract all subsets otherwise just 1000.</p>
		</td>
	</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;lms&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Scalar. If <tt>lms=1</tt> (default) Least Median of Squares is computed, 
		else Least trimmed squares is computed.</p>
		</td>
	</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;plots&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Scalar. If <tt>plots=1</tt> the fan plot is produced else (default) no 
		plot is produced</p>
		</td>
	</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;init&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Scalar which specifies the initial subset size to start monitoring exceedances, 
		if init is not specified it will be set equal to   		
		<br><tt>p+1</tt>, if the sample size is smaller than 40; <br><tt>min(3*p+1,floor(0.5*(n+p+1)))</tt>, otherwise.</td>
			</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;conflev&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>confidence level for the bands (default is 0.99 that is we plot two horizontal 
		lines in correspondence of value -2.58 and 2.58.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2"><tt>&#39;titl&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>a label for the title (default: &#39;Fan plot&#39;) </p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;labx&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>a label for the x-axis (default: &#39;Subset size m&#39;).</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;laby&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>a label for the y-axis (default: &#39;Score test statistic&#39;).</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;xlimx&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>vector with two elements controlling minimum and maximum of the x axis. 
		Default value is [init n].</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;ylimy&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>vector with two elements controlling minimum and maximum of the y axis. 
		Default value for ylimy(1)=max(min(score_test),-20). Default value for ylimy(2)=min(max(score_test),20).</p>
		</td>
	</tr>
	<tr valign="top">
		<td bgcolor="#F2F2F2"><tt>&#39;lwd&#39;</tt></td>
		<td bgcolor="#F2F2F2">
		<p>Scalar which controls line width of the curves which contain the score 
		test. Default line width=2. </p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;lwdenv&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>Scalar which controls the line with of the horizontal lines associated 
		with the envelopes. Default is lwdenv=1.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;FontSize&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>Scalar which controls the font size of the labels of the axes. Default 
		value is 12.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;SizeAxesNum&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>Scalar which controls the size of the numbers of the axes. Default value 
		is 10.</p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;msg&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>Scalar which controls whether to display or not messages
              on the screen If <tt>msg=1</tt> (default) messages are displyed
              on the screen about estimated time to compute LMS (LTS) for each 
		value of &lambda;. </p>
		</td>
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;intercept&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p>Scalar. If 1, a model with constant term will be fitted (default), if 0,
		 no constant term will be included. </p>
		
	</tr>
	<tr>
		<td bgcolor="#F2F2F2" style="height: 32px"><tt>&#39;tag&#39;</tt></td>
		<td bgcolor="#F2F2F2" style="height: 32px">
		<p> String which identifies the handle of the plot which
                  is about to be created. The default is to use tag
                  <tt>pl_fan</tt>. Notice that if the program finds a plot which
                  has a tag equal to the one specified by the user, then
                  the output of the new plot overwrites the existing one
                  in the same window else a new window is created.</p>
		</td>
	</tr>
</table>
<p></p>
<a name="bq9x7hn"></a><a name="bq5gf2y"></a>
<h3>Examples</h3>
<h3>Example 1</h3>
<p>Robust analysis of transformations for the <tt>wool dataset</tt>:</p>
<pre class="programlisting">
% Load wool data: 27 observations and 3 explanatory variables
XX=load(&#39;wool.txt&#39;);
y=XX(:,end);
X=XX(:,1:end-1);
% Function FSRfan stores the score test statistic. 
% In this case we use the five most common values of lambda are considered
[out]=FSRfan(y,X);
% Produce a fan plot and display it on the screen
fanplot(out);
</pre>
<p>The fan plot shows the log transformation is diffused throughout the data and 
does not depend on the presence of particular observations.</p>
<p><img alt="" height="589" src="plots/wooll_fan.jpg" width="717"></p>
<h3>Example 2</h3>
<p>Robust analysis of transformations for the <tt>loyalty cards dataset</tt>:</p>
<pre class="programlisting">
    XX=load(&#39;loyalty.txt&#39;);
    y=XX(:,end);
    X=XX(:,1:end-1);
    % la = vector contanining the most common values of the transformation
    % parameter
    la=[0 1/3 0.4 0.5];
    % Store the score test statistics for the specified values of lambda
    % and automatically produce the fan plot
    [out]=FSRfan(y,X,&#39;la&#39;,la,&#39;init&#39;,size(X,2)+2,&#39;plots&#39;,1,&#39;lwd&#39;,3);

</pre>
<p>The fan plot shows the even if the third root is the best value of the transformation 
parameter at the end of the search in earlier steps it lies very close to the upper 
rejection region. The best value of the transformation parameter seems to be the 
one associated with l=0.4 which is always the confidence bands but at the end of 
search, due to the presence of particular observations it goes below the lower rejection 
line. </p>
<p><img alt="" height="699" src="plots/loyalty.jpg" width="859"></p>
<a name="bq24of9-11"></a>
<h3>See Also</h3>
<p><a href="fanplot.html"><tt>fanplot</tt></a>, <a href="score.html"><tt>score</tt></a>
</p>
<p></p>
<p></p>
<table border="0" cellpadding="0" cellspacing="0" class="nav" summary="Navigation aid" width="100%">
	<tr valign="top">
		<td align="left" width="20"><a href="fsrenvmdr.html">
		<img align="bottom" alt="FSRenvmdr" border="0" src="images_help/b_prev.gif"></a>
		</td>
		<td align="left">fsrenvmdr.html</td>
		<td>&nbsp;</td>
		<td align="right">fsrh.html</td>
		<td align="right" width="20"><a href="fsrh.html">
		<img align="bottom" alt="FSRmdr" border="0" src="images_help/b_next.gif"></a></td>
	</tr>
</table>
<script type ="text/javascript" language="javaScript">
document.write(barra);
</script>
<!-- Last updated: Fri Jan 23 17:00:05 EST 2009-->

</body>

</html>
