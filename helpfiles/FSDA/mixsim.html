<html>
<head>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <title>MixSim :: Functions (Flexible Statistics Data Analysis
  Toolbox™)</title>
  <link href="docstyle.css" rel="stylesheet" type="text/css">
  <meta content="refpage" name="chunktype">
  <meta content="function:FSM" name="refentity">
  <meta content="text/javascript" http-equiv="Content-Script-Type">
  <meta content="fcn" name="toctype">
  <script type="text/javascript" language="javaScript" src="bottom.js">
 </script>
  <style type="text/css">
.auto-style1 {
	vertical-align: middle;
}
</style>
</head>

<body>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<!--FScategory:Clustering-->
<a name="top_of_page"></a> 

<p style="font-size: 1px;"> </p>

<table border="0" cellpadding="0" cellspacing="0" class="nav"
summary="Navigation aid" width="100%">
  <tbody>
    <tr>
      <td valign="baseline"><b>Flexible Statistics Data Analysis
      Toolbox™</b></td>
      <td align="right" valign="baseline"><a href="minscale.html"><img
        align="bottom" alt="fanplot" border="0"
        src="images_help/b_prev.gif"></a>   <a href="mixsimreg.html"><img
        align="bottom" alt="FSMeda" border="0"
      src="images_help/b_next.gif"></a></td>
    </tr>
  </tbody>
</table>

<a name="bq24of9-1"></a><a class="indexterm" name="zmw57dd0e69698"></a> 

<h1 class="reftitle">MixSim</h1>

<p class="purpose">Generates k clusters in v dimensions with a prespecified
average, maximum and/or standard deviation of  overlap </p>

<h2>Syntax </h2>

<p class="synopsis"><tt>[out] = MixSim(k,v)<br>
[out] =
MixSim(k,v,<i>param1</i></tt><tt>,</tt><tt><i>val1</i><tt>,</tt><i>param2</i><tt>,</tt><i>val2</i><tt>,...)<br>
</tt></tt></p>
<a name="f4811966"></a> 

<h2>Description </h2>

<p>Background: Given two generic clusters i and j with  i ≠  j =1, ..., k,
indexed by φ(x; μ<sub>i</sub>,Σ<sub>i</sub>) and φ(x;
μ<sub>j</sub>,Σ<sub>j</sub>) with probabilities of occurrence π<sub>i</sub>
and π<sub>j</sub> , the misclassification probability with respect to cluster
i, (that is conditionally on x belonging to cluster i,  which is called
w<sub>j|i</sub>) is defined as Pr[π<sub>i</sub>  φ(x;
μ<sub>i</sub>,Σ<sub>i</sub>) &lt; π<sub>j</sub>  φ(x;
μ<sub>j</sub>,Σ<sub>j</sub>)]. The matrix containing the misclassification
probabilities w<sub>j|i</sub> is called <a href="#OmegaMap">OmegaMap</a>. The
probability of overlapping, defined as a sum of two misclassification
probabilities, measures the degree of interaction between components and can be
readily employed to control the clustering complexity of datasets simulated
from mixtures. These datasets can then be used for systematic performance
investigation of clustering and finite mixture modeling algorithms. </p>
<p>More
specifically, the probability of overlapping between groups i and j (called
p<sub>ij</sub>) is given by p<sub>ij </sub>=p<sub>ji </sub>= w<sub>j|i</sub> +
w<sub>i|j</sub> = OmegaMap(i,j)+OmegaMap(j,i),  i,j=1,2, ..., k. The diagonal
elements of OmegaMap are (by definition) set equal to 1. The average overlap
(which in the code below  is called <a href="#BarOmega">BarOmega</a>) is
defined as the sum of the off diagonal elements of OmegaMap (Σ<sub>i &gt;
j=1,2, ..., k</sub> p<sub>ij </sub>) divided by k(k-1)/2. The maximum overlap
(which in the code below is called <a href="#MaxOmega">MaxOmega</a>) is defined
as max(w<sub>j|i</sub> + w<sub>i|j</sub> ) = max p<sub>ij </sub> i ≠ j=1,2,
..., k. The standard deviation of overlap (which in the code is called <a
href="#StdOmega">StdOmega</a>) is the standard deviation of the k(k-1)/2
elements  p<sub>ij</sub>. </p>
<p>The probability of misclassification w<sub>j|i</sub>
(w<sub>i|j</sub>) is nothing but the cdf of a linear combination of non central
Χ<sup>2</sup> distributions with 1 degree of freedom + a linear combination of
N(0,1) evaluated in a point c. The coefficients of the linear combinations of
non central Χ<sup>2</sup> and N(0,1) depend on the eigenvalues and
eigenvectors of matrix Σ<sub>j|i</sub> = Σ<sup>0.5</sup><sub>i</sub>
Σ<sup>-1</sup><sub>j </sub>Σ<sup>0.5</sup><sub>i</sub>. Point c depends on
the same eigenvalues and eigenvectors of matrix Σ<sub>j|i</sub>, the mixing
proportions  π<sub>i</sub> and π<sub>j </sub>and the determinants
|Σ<sub>i</sub>| and |Σ<sub>j</sub>|. This probability is computed using
routine <a href="ncx2mixtcdf.html">ncx2mixtcdf</a>.</p>

<p></p>

<p>MixSim admits the following inputs:</p>

<p><tt>k</tt>  scalar, number of groups (components)</p>

<p><tt>v</tt> scalar, number of dimensions (variables).</p>

<p> </p>

<p> </p>

<p><tt>out=MixSim(k,v)</tt> returns the following information </p>
<ul type="disc">
  <li><tt>out</tt> − A structure of additional statistics with the following
    fields. 
    <ul type="circle">
      <li><p><tt>Pi </tt> vector of length k containing mixing proportions.
        sum(out.Pi)=1.<br>
        </p>
      </li>
      <li><p><tt>Mu</tt> matrix of size k-by-v consisting of components' mean
        vectors. Each row of this matrix is a centroid of a group. </p>
      </li>
      <li><p><tt>S</tt> −array  of size v-by-v-by-k containing covariances
        for the k groups.</p>
      </li>
      <li><tt><a name="OmegaMap">OmegaMap</a></tt> matrix of misclassification
        probabilities (k-by-k); <br>
        OmegaMap(i,j) = w<sub>j|i</sub> is the probability that X coming from
        the i-th component (group) is classified to the j-th component. </li>
      <li><tt><a name="BarOmega">BarOmega</a></tt> − scalar. Value of average
        overlap. BarOmega is computed as <br>
        (sum(sum(OmegaMap))-k)/(0.5*k(k-1)). </li>
      <li><tt><a name="MaxOmega">MaxOmega</a></tt> − scalar. Value of maximum
        overlap.  MaxOmega is the<br>
         maximum of OmegaMap(i,j)+OmegaMap(j,i). In other words MaxOmega=<br>
         OmegaMap(rcMax(1),rcMax(2))+OmegaMap(rcMax(2),rcMax(1)).</li>
      <li><tt><a name="StdOmega">StdOmega</a></tt> − scalar. Value of
        standard deviation (std) of overlap.<br>
        StdOmega is the standard deviation of k*(k-1)/2  probabilities of
        overlapping  p<sub>ij </sub></li>
      <li><p><tt>rcMax</tt> − vector of length 2. It containes the row and
        column numbers associated with the pair of components<br>
        producing maximum overlap 'MaxOmega'.</p>
      </li>
    </ul>
    <ul>
      <li><p><tt>fail</tt> − scalar, flag value. 0 represents successful
        mixture generation, 1 represents failure.</p>
      </li>
    </ul>
  </li>
</ul>

<p></p>

<p><tt>[out] = MixSim(<i>k,v,
param1</i></tt><tt>,</tt><tt><i>val1</i><tt>,</tt><i>param2</i><tt>,</tt><i>val2</i><tt>,...)</tt></tt>
specifies one or more of the name/value pairs described in the following
table.</p>

<table border="2" cellpadding="4" cellspacing="0" class="body">
  <colgroup><col width="21%">
    <col width="79%">
  </colgroup>
  <thead>
    <tr valign="top">
      <th bgcolor="#B2B2B2">Parameter</th>
      <th bgcolor="#B2B2B2">Value</th>
    </tr>
  </thead>
  <tbody>
    <tr valign="top">
      <td bgcolor="#F2F2F2"><tt>'BarOmega'</tt></td>
      <td bgcolor="#F2F2F2"><p>scalar, value of desired average overlap. The
        default value is '', that is just the value of maximum
        overlap MaxOmega is used.</p>
      </td>
    </tr>
    <tr>
      <td bgcolor="#F2F2F2"><tt>'MaxOmega'</tt></td>
      <td bgcolor="#F2F2F2"><p>scalar, value of desired maximum overlap. If
        BarOmega is empty the default value of MaxOmega is 0.15.</p>
      </td>
    </tr>
    <tr>
      <td bgcolor="#F2F2F2"><tt>'StdOmega'</tt></td>
      <td bgcolor="#F2F2F2"><p>scalar, value of desired standard deviation of
        overlap. <br>
        Remark1: The probability of overlapping between two clusters i and j (i
        ne j =1, 2, ..., k), called p<sub>ij </sub>, is defined as the <br>
        sum of the two misclassification probabilities <br>
        p<sub>ij </sub>=p<sub>ji </sub>= w<sub>j|i</sub> + w<sub>i|j</sub> <br>
        Remark2: it is possible to specify average overlap (BarOmega) and only
        one between  MaxOmega and StdOmega. </p>
      </td>
    </tr>
    <tr>
      <td bgcolor="#F2F2F2"><tt>'sph'</tt></td>
      <td bgcolor="#F2F2F2"><p>scalar boolean which specifies covariance matrix
        structure <br>
        sph=false (default) ==&gt; non-spherical, <br>
        sph=true ==&gt; spherical = const*I<sub>v</sub></p>
      </td>
    </tr>
    <tr>
      <td bgcolor="#F2F2F2"><tt>'hom'</tt></td>
      <td bgcolor="#F2F2F2"><p>scalar boolean which specifies heterogeneous or
        homogeneous clusters <br>
        hom=false (default) ==&gt; heterogeneous, <br>
        hom=true ==&gt; homogeneous Σ<sub>1</sub> = ... = Σ<sub>k</sub> </p>
      </td>
    </tr>
    <tr>
      <td bgcolor="#F2F2F2"><tt>'ecc'</tt></td>
      <td bgcolor="#F2F2F2"><p>scalar in the interval (0, 1] which defines
        maximum eccentricity.<br>
        For example, if ecc=0.9 (default value), we require for each group that
        sqrt(1 - minL / maxL) &lt;= 0.9 where minL and maxL are respectively
        the min and max eigenvalue of the cov matrix of a particular group.</p>
      </td>
    </tr>
    <tr>
      <td bgcolor="#F2F2F2"><tt>'restrfactor'</tt></td>
      <td bgcolor="#F2F2F2"><p>scalar in the interval [1 ∞] which specifies
        the maximum ratio to allow between the largest eigenvalue and the
        smallest eigenvalue of the k covariance matrices which are generated.
        More in detail, if for example restrfactor=c, after generating the
        covariance matrices, we check that the ratio between the largest eigenvalue of the k cov matrices and the
        smallest eigenvalue of the k cov matrices is not larger than <tt>'restrfactor'</tt> 
	  that is</p>
	  <p>
	  <img alt="" height="93" src="images_help/img14.jpg"
        width="483" class="auto-style1"> <tt>restrfactor</tt></p>
	  <p>In
        order to apply this restriction (which is typical of <a
        href="tclust">tclust</a>) we call routine <a
        href="restreigen.html">restreigen</a>. The default value of restrfactor
        is  Inf that is no restriction is imposed. </p>
	  <p>Remark: note that while optional parameter <tt>'ecc'</tt> is referred to each group, 
	  parameter <tt>'restrfactor'</tt> consideres all eigenvalues of all covariance matrices together.</p>
      </td>
    </tr>
    <tr>
      <td bgcolor="#F2F2F2"><tt>'PiLow'</tt></td>
      <td bgcolor="#F2F2F2"><p>scalar, value of the smallest mixing proportion
        (if 'PiLow' is not reachable with respect to k, equal proportions are
        taken; PiLow = 1.0 implies equal proportions by default). PiLow must be
        a number in the interval (0 1].</p>
      </td>
    </tr>
    <tr>
      <td bgcolor="#F2F2F2"><tt>'int'</tt></td>
      <td bgcolor="#F2F2F2"><p>mean vectors are simulated uniformly on a
        hypercube with sides specified by int = [lower.bound, upper.bound]. <br>
        The default value of int is [0 1].</p>
      </td>
    </tr>
    <tr>
      <td bgcolor="#F2F2F2"><tt>'resN'</tt></td>
      <td bgcolor="#F2F2F2"><p>maximum number of mixture simulations to find
        a simulation setting with prespecified level of overlapping. <br>
        The default value of resN is 100. </p>
      </td>
    </tr>
    <tr>
      <td bgcolor="#F2F2F2"><tt>'tol'</tt></td>
      <td bgcolor="#F2F2F2"><p>vector of length 2. <br>
        tol(1) (which will be called tolmap) specifies the tolerance between
        the requested and empirical misclassification probabilities (default is
        1e-06); <br>
        tol(2) (which will be called tolnxc2) specifies the tolerance to use in
        routine ncx2mixtcdf (which computes cdf of linear combinations of non
        central chi2 distributions). The default value of tol(2) 1e-06.</p>
      </td>
    </tr>
    <tr>
      <td bgcolor="#F2F2F2"><tt>'lim'</tt></td>
      <td bgcolor="#F2F2F2"><p>maximum number of integration terms to use
        inside routine <a href="ncx2mixtcdf.html">ncx2mixtcdf</a>. Default is
        1e06. <br>
        REMARK: Optional parameters tolncx2=tol(2) and lim will be used by
        function ncx2mixtcdf.m which computes the cdf of a linear combination
        of non central chi2 r.v.. This is the probability of misclassification.
        </p>
      </td>
    </tr>
    <tr>
      <td bgcolor="#F2F2F2"><tt>'Display'</tt></td>
      <td bgcolor="#F2F2F2"><p>Level of display. <br>
        'off' displays no output; <br>
        'notify' (default) displays output if requested overlap cannot be
        reached in a particular simulation;<br>
        'iter' displays output at each iteration of each simulation.</p>
      </td>
    </tr>
    <tr>
      <td bgcolor="#F2F2F2"><tt>'R_seed'</tt></td>
      <td bgcolor="#F2F2F2"><p>scalar for the seed to be used to generate
        random numbers in a R instance. This is used to check consistency of
        the results obtained with the <a href="http://www.r-project.org/">R</a>
        package MixSim. <br>
        This option requires the installation of the R-(D)COM Interface. See
        file Connect_Matlab_with_R_HELP.m to know how to connect MATLAB with
        R.<br>
        Default is 0, i.e. random numbers are generated by matlab. If
        R_seed&gt;0 random numbers are generated using R.</p>
      </td>
    </tr>
  </tbody>
</table>

<p> </p>

<h2>References </h2>

<h3>Examples</h3>

<p>Maitra, R. and Melnykov, V. (2010) “Simulating data to study performance
of finite mixture modeling and clustering algorithms”, The Journal of
Computational and Graphical Statistics, 2:19, 354-376. (to refer to this
publication we will use "MM2010 JCGS")</p>

<p>Melnykov, V., Chen, W.-C., and Maitra, R. (2012) “MixSim: An R Package for
Simulating Data to Study Performance of Clustering Algorithms”, Journal of
Statistical Software, 51:12, 1-25. </p>

<p>Davies, R. (1980) “The distribution of a linear combination of chi-square
random variables”, Applied Statistics, 29, 323-333. </p>

<p>Garcia-Escudero, L.A.; Gordaliza, A.; Matran, C. and Mayo-Iscar, A. (2008),
"A General Trimming Approach to Robust Cluster Analysis". Annals of Statistics,
Vol.36, 1324-1345. Technical Report available at
www.eio.uva.es/inves/grupos/representaciones/trTCLUST.pdf </p>

<p>Reference below documents the problem of the ill-conditioning of the
eigenvalue-eigenvector computation. </p>

<p>Numerische Mathematik, 19. August 1969, Volume 13, Issue 4, pp 293-304
Balancing a matrix for calculation of eigenvalues and eigenvectors Dr. B. N.
Parlett, Dr. C. Reinsch </p>

<p>Parlett, B. N. and C. Reinsch, “Balancing a Matrix for Calculation of
Eigenvalues and Eigenvectors,” Handbook for Auto. Comp., Vol. II, Linear
Algebra, 1971,pp. 315-326.</p>

<h3>Example 1</h3>
Generate 3 groups in 4 dimensions using maximum overlap equal to 0.15. Function
MixSim creates the centroids, the covariance matrices and the mixing
proportions. 
<pre class="programlisting">rng(10,'twister')
out=MixSim(3,4)
disp('Print the centroids')
disp(out.Mu)
disp('Print the covariance matrices') 
disp(out.S)
disp('Print the mixing proportions')
disp(out.Pi)
disp('Print matrix of misclassification probabilities')
disp(out.OmegaMap)
disp('For example the probability of overlapping between group 2 and 3 is')
disp(['out.OmegaMap(2,3)+out.OmegaMap(3,2) =' num2str(out.OmegaMap(2,3)+out.OmegaMap(3,2))])
n=200;
[X,id]=simdataset(n, out.Pi, out.Mu, out.S);
spmplot(X,id)</pre>

<p></p>
  

<p><img alt="" src="images_help/img3.jpg"> </p>

<p>The matrix of misclassification probabilities (out.OmegaMap)</p>

<p>1.0000     0.0173     0.0228<br>
0.0351     1.0000     0.0872<br>
0.0377     0.0628     1.0000</p>

<p>shows that the most separated groups are 1 and 2</p>

<p><img alt="" src="images_help/img28.jpg"></p>

<p>while the two groups with the highest misclassification probability are 2
and 3</p>

<p><img alt="" src="images_help/img29.jpg"></p>
<pre class="programlisting">% print
disp('Show the two groups with the highest probability of overlapping (out.rcMax)')
disp(out.rcMax')</pre>

<p>2 3 </p>

<h3>Example 2</h3>
In the previous example we just controlled the maximum overlap. In this example
we generate groups with a prespecified value of both average and standard
deviation of overlapping. 

<p>For example, in the example below we generate 4 groups in 5 dimensions. In
the first case we impose BarOmega=0.10 and StdOmega=0.15 while in the second
case we impose BarOmega=0.10 and StdOmega=0.05. We compare through the matrix
OmegaMap and visually using the scatter plot matrix, the differences coming
from using a low or high standard deviation of overlapping. In order to be able
to replicate the results we use a fixed seed.</p>
<pre class="programlisting">    rng(10,'twister')
    k=4;
    v=5;
    n=200;
    BarOmega=0.10;
    StdOmega=0.15;
    out=MixSim(k,v,'BarOmega',BarOmega, 'StdOmega',StdOmega,'resN',10, 'Display', 'iter');
    [X,id]=simdataset(n, out.Pi, out.Mu, out.S);

    rng(10,'twister')
    StdOmega1=0.05;
    out1=MixSim(k,v,'BarOmega',BarOmega, 'StdOmega',StdOmega1,'resN',10, 'Display', 'iter');
    [X1,id1]=simdataset(n, out1.Pi, out1.Mu, out1.S);
    disp('Comparison using OmegaMap')
    disp('When StdOmega is large in this example groups 3 are 4 do show a strong overlap')
    disp('When StdOmega is large in this example groups 1, 2, 3 are quite separate')
    disp(out.OmegaMap)
    disp('When StdOmega is small the probabilities of overlapping are much more similar')
    disp(out1.OmegaMap)</pre>

<p>Comparison using OmegaMap<br>
When StdOmega is large in this example groups 3 are 4 do show a strong
overlap.<br>
When StdOmega is large in this example groups 1, 2, 3 are quite separate.<br>
1.0000 0.0107 0.0186 0.0123<br>
0.0112 1.0000 0.0102 0.0053<br>
0.0507 0.0261 1.0000 0.1476<br>
0.0355 0.0156 0.2564 1.0000<br>
<br>
When StdOmega is small the probabilities of overlapping are much more
similar<br>
1.0000 0.0391 0.0337 0.0487<br>
0.0397 1.0000 0.0404 0.0343<br>
0.0330 0.0402 1.0000 0.0781<br>
0.0524 0.0393 0.1213 1.0000</p>

<p>Comparison using interactive scatter plot matrices</p>
<pre class="programlisting">     disp('Comparison using interactive scatter plot matrices')
    spmplot(X,id)
    set(gcf,'name',['BarOmega=' num2str(BarOmega) ' StdOmega=' num2str(StdOmega)])
    figure
    spmplot(X1,id1)
    set(gcf,'name',['BarOmega=' num2str(BarOmega) ' StdOmega=' num2str(StdOmega1)])</pre>

<p>Groups 3 and 4 overlap much more in the left panel rather than in the right
panel of figure below.</p>

<p><img alt="" src="images_help/img18.jpg"></p>

<p>The two scatter plot matrices just show the first two groups in the two
situations.</p>

<p><img alt="" src="images_help/img19.jpg"></p>

<h3>See Also</h3>

<p><tt><a href="simdataset.html">simdataset</a></tt> </p>


<p></p>

<table border="0" cellpadding="0" cellspacing="0" class="nav"
summary="Navigation aid" width="100%">
  <tbody>
    <tr valign="top">
      <td align="left" width="20"><a href="minscale.html"><img align="bottom"
        alt="fanplot" border="0" src="images_help/b_prev.gif"></a> </td>
      <td align="left">minscale.html</td>
      <td> </td>
      <td align="right">mixsimreg.html</td>
      <td align="right" width="20"><a href="mixsimreg.html"><img align="bottom"
        alt="FSMeda" border="0" src="images_help/b_next.gif"></a></td>
    </tr>
  </tbody>
</table>
<script type="text/javascript" language="javaScript">
document.write(barra);</script>
<!-- Last updated: Fri Jan 23 17:00:05 EST 2009-->
</body>
</html>
