<!DOCTYPE HTML> <html itemscope="" xmlns="http://www.w3.org/1999/xhtml"><head><title>quickselectFSw</title><meta content="refpage" name="chunktype"><meta content="function:quickselectFSw" itemprop="refentity" name="refentity"><meta content="text/javascript" http-equiv="Content-Script-Type"><meta content="fcn" itemprop="pagetype" name="toctype"><meta content="ref/function" itemprop="infotype" name="infotype" /><meta content=" quickselectFSw finds the 100*p-th weighted order statistic for $0&lt;p&lt;1$." itemprop="description" name="description" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" /><script type="text/x-mathjax-config">MathJax.Hub.Config({extensions: ["tex2jax.js"],jax: ["input/TeX","output/HTML-CSS"],menuSettings: {zoom: "Double-Click", zscale: "300"},tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]},MathMenu: {showRenderer: false},"HTML-CSS": {availableFonts: ["TeX"],preferredFont: "TeX",imageFont: null}});</script><script type="text/javascript" src="includesFS/Mathjax/MathJax.js"></script><script src="includesFS/matlab-highlighter.min.js"></script><link href="includesFS/matlab-highlighter.css" rel="stylesheet" type="text/css"><script type="text/javascript" src="includesFS/jquery-latest.js"></script><script>$(document).ready(function(){      $("#divtop").load("includesFS/top.html");      $("#divbottom").load("includesFS/bottom.html");});</script><link href="../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/site6_lg.css" rel="stylesheet" media="screen and (min-width: 1200px)"></link><link href="../includes/product/css/site6_md.css" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)"></link><link href="../includes/product/css/site6_sm+xs.css" rel="stylesheet" media="screen and (max-width: 991px)"></link><link href="../includes/product/css/site6_sm.css" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)"></link><link href="../includes/product/css/site6_xs.css" rel="stylesheet" media="screen and (max-width: 767px)"></link><link href="../includes/product/css/site6_offcanvas.css" rel="stylesheet" type="text/css"></link><script src="../includes/shared/scripts/l10n.js" type="text/javascript"></script><script src="../includes/product/scripts/docscripts.js"></script><script src="../includes/shared/scripts/docscripts_rn.js"></script><script src="../includes/shared/scripts/mw.imageanimation.js" type="text/javascript"></script><script src="../includes/shared/scripts/jquery.highlight.js"></script><script src="../includes/product/scripts/bootstrap.min.js" type="text/javascript"></script><script src="../includes/product/scripts/global.js"></script><script src="includesFS/bottom.js" type="text/javascript"></script><script src="../includes/product/scripts/underscore-min.js"></script><script src="../includes/shared/scripts/f1help.js" type="text/javascript"></script><script src="../includes/product/scripts/suggest.js" type="text/javascript"></script><script src="../includes/shared/scripts/helpservices.js" type="text/javascript"></script><script src="../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script><!-- the following line should be kept this way only --><link href="includesFS/doc_center.css" rel="stylesheet" type="text/css"></link><link href="../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css"><link href="../includes/product/css/doc_center_print.css" media="print" rel="stylesheet" type="text/css"></head><body  onload="highlightMATLABCode();" id="responsive_offcanvas">  <div id="doc_header_spacer" class="header"></div><div class="sticky_header_container includes_subnav"><div class="section_header level_3"><div class="container-fluid"><div class="row" id="mobile_search_row"><div class="col-xs-12 col-sm-6 col-sm-push-6 col-md-5 col-md-push-7" id="mobile_search"><div class="search_nested_content_container"><form id="docsearch_form" name="docsearch_form" method="get" data-release="R2017a" data-language="en" action="../templates/searchresults.html"><div class="input-group tokenized_search_field"><label class="sr-only">Search Help</label><input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch"><div class="input-group-btn"><button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button></div></div></form></div><button class="btn icon-remove btn_search pull-right icon_32 visible-xs" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div><div class="col-sm-6 col-sm-pull-6 col-md-7 col-md-pull-5" id="section_header_title"><div class="section_header_content"><div class="section_header_title"><h1><a href="../documentation-center.html">Documentation</a></h1></div></div></div><div class="visible-xs" id="search_actuator"><button class="btn icon-search btn_search pull-right icon_16" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div></div><!--END.CLASS row--> </div><!--END.CLASS container-fluid--> </div><!--END.CLASS section_header level_3--><div class="horizontal_nav"><div class="horizontal_nav_container"><div class="offcanvas_actuator" data-toggle="offcanvas" data-target="#sidebar" id="nav_toggle"><button type="button" class="btn"><span class="sr-only">Toggle navigation</span><span class="icon-menu icon_24"></span></button><span class="offcanvas_actuator_label"></span><span class="offcanvas_actuator_close"></span> </div><div class="offcanvas_horizontal_nav"><div class="container-fluid"><div class="row"><div class="col-md-12 hidden-xs hidden-sm"></div></div></div></div></div></div></div><!--END.CLASS sticky_header_container--><div class="row-offcanvas row-offcanvas-left"><div id="sidebar" class="sidebar-offcanvas" role="navigation"><nav class="offcanvas_nav" role="navigation"><ul class="nav_breadcrumb" xmlns:atict="http://www.arbortext.com/namespace/atict"><li itemprop="breadcrumb" itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb"> <a href="../documentation-center.html" itemprop="url"> <span itemprop="title">All Products</span></a></li></ul><ul class="nav_disambiguation" xmlns:atict="http://www.arbortext.com/namespace/atict"><li class="product"><a href="index.html">Flexible Statistics and Data Analysis (FSDA)</a><div class="dropdown"> <span id="dropdownMenu1" class="icon-arrow-down icon_16" data-toggle="dropdown"> </span><ul aria-labelledby="dropdownMenu1" class="dropdown-menu dropdown-menu-right" role="menu"><li role="presentation"> <a href="examples.html" role="menuitem" tabindex="-1">Examples</a></li><li role="presentation"> <a href="function-alpha.html" role="menuitem" tabindex="-1"> Functions and Other Reference</a></li><li role="presentation"> <a href="release_notes.html?s_cid=doc_flyout" role="menuitem" tabindex="-1"> Release Notes</a></li><li role="presentation"> <a href="tutorials.html" role="menuitem" tabindex="-1"> Tutorials</a></li></ul></div></li></ul><ul xmlns:atict="http://www.arbortext.com/namespace/atict" class="nav_disambiguation"> <li><a href="index.html">Flexible Statistics and Data Analysis Toolbox</a> </li> <li><a href="function-cate.html" itemprop="url">Functions</a></li></ul><!-- --><ul class="nav_scrollspy nav" xmlns:atict="http://www.arbortext.com/namespace/atict">  <li class="nav_scrollspy_function"> <a href="#responsive_offcanvas">quickselectFSw</a></li> <li id="SSPY810-refentry" class="nav_scrollspy_title">On this page</li><li><a class="intrnllnk" href="#syntax">Syntax</a></li><li><a class="intrnllnk" href="#Description">Description</a></li><li><a class="intrnllnk" href="#Examples">Examples</a><ul><li><a class="intrnllnk" href="#Example_1">quickselectFSw without optional parameter p.</a></li><li><a class="intrnllnk" href="#Example_2">quickselectFSw for computing a generic weighted percentile.</a></li><li><a class="intrnllnk" href="#Example_3">quickselectFSw with the optional output array partially sorted.</a></li><li><a class="intrnllnk" href="#Example_4">quickselectFSw when the weights are all equal.</a></li><li><a class="intrnllnk" href="#Example_5">Verify the definition of weighted order statistic.</a></li></ul></li><li><a class="intrnllnk" href="#ExtraExamples">Extra Examples</a><ul><li><a class="intrnllnk" href="#ExtraExample_1">Use the mex function quickselectFSwmex.</a></li></ul></li><li><a class="intrnllnk" href="#Inputs">Input Arguments</a><ul><li><a class="intrnllnk" href="#input_argument_D">D</a></li><li><a class="intrnllnk" href="#input_argument_W">W</a></li><li><a class="intrnllnk" href="#input_argument_p">p</a></li></ul></li><li><a class="intrnllnk" href="#OutputArgs">Output Arguments</a><ul><li><a class="intrnllnk" href="#output_argument_kD">kD</a></li><li><a class="intrnllnk" href="#output_argument_kW">kW</a></li><li><a class="intrnllnk" href="#output_argument_kstar">kstar</a></li><li><a class="intrnllnk" href="#output_argument_varargout">varargout</a></li></ul></li><li><a class="intrnllnk" href="#MoreAbout">More About</a></li><li><a class="intrnllnk" href="#References">References</a></li><li><a class="intrnllnk" href="#SeeAlso">See Also</a></li></ul></nav><script src="../includes/product/scripts/offcanvas.js"></script></div><div id="divtop"></div><div class="site_container site_toc_closed"><div class="page_container"><div class="content_frame"><div id="content_container" class="content_container"><section id="doc_center_content"><div class="function_ref"><div itemprop="content"><h1 itemprop="title">quickselectFSw</h1><div class="doc_topic_desc"><div class="purpose_container"><p itemprop="purpose"> quickselectFSw finds the 100*p-th weighted order statistic for $0&lt;p&lt;1$</p><div class="switch"><a id="expandAllPage" href="javascript:void(0);">expand all in page</a></div></div></div></div><div class="ref_sect"><h2 id="syntax">Syntax</h2><div class="syntax_signature"><div class="syntax_signature_module"><ul><li><code class="synopsis">kD =quickselectFSw(D,W)</code><span class="syntax_example"><a class="intrnllnk" href="quickselectFSw.html#Example_1">example</a></span></li><li><code class="synopsis">kD =quickselectFSw(D,W,p)</code><span class="syntax_example"><a class="intrnllnk" href="quickselectFSw.html#Example_2">example</a></span></li><li><code class="synopsis">[kD , kW ]=quickselectFSw(___)</code><span class="syntax_example"><a class="intrnllnk" href="quickselectFSw.html#Example_3">example</a></span></li><li><code class="synopsis">[kD , kW , kstar]=quickselectFSw(___)</code><span class="syntax_example"><a class="intrnllnk" href="quickselectFSw.html#Example_4">example</a></span></li><li><code class="synopsis">[kD , kW , kstar, varargout]=quickselectFSw(___)</code><span class="syntax_example"><a class="intrnllnk" href="quickselectFSw.html#Example_5">example</a></span></li></ul></div></div></div>	<div class="ref_sect" itemprop="content">							<h2 id="Description">Description</h2>							<div class="descriptions">								<div class="description_module"><p><p>quickselectFSw generalises the calculation of the weighted median to a
 generic percentile $100pth (0&lt;p&lt;1)$. It finds the p-th weighted order
 statistic in the elements of a data vector $D$ considering the associated
 weights $W$. More precisely, the algorithm finds the element $D_{k^{*}}$
 that make the following difference as small as possible:</p> <p>
 $\sum_{i=1}^{k^{*}_{p} - 1} w_{i} - \sum_{i=k^{*}_{p}+1}^{n} w_{i}$.</p> <p>
 The linear algorithm used for the computation extends quickselectFS.</p><p>
 REMARK: we also provide the mex counterpart, quickselectFSwmex; see the
 last example to understand how it works.</p></p><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="quickselectFSw.html#Example_1">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_kD"><code>kD</code></a>=quickselectFSw(<a class="intrnllnk" href="#inputarg_D"><code>D</code></a>,<a class="intrnllnk" href="#inputarg_W"><code>W</code></a>)</code></span>quickselectFSw without optional parameter p.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="quickselectFSw.html#Example_2">	example</a></p>	<p><span itemprop="syntax"><code><a class="intrnllnk" href="#outputarg_kD"><code>kD</code></a>=quickselectFSw(<a class="intrnllnk" href="#inputarg_D"><code>D</code></a>,<a class="intrnllnk" href="#inputarg_W"><code>W</code></a>,<a class="intrnllnk" href="#inputarg_p"><code>p</code></a>)</code></span>quickselectFSw for computing a generic weighted percentile.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="quickselectFSw.html#Example_3">	example</a></p>	<p><span itemprop="syntax"><code>[<a class="intrnllnk" href="#outputarg_kD"><code>kD </code></a>,<a class="intrnllnk" href="#outputarg_kW"><code> kW </code></a>]=quickselectFSw(___)</code></span>quickselectFSw with the optional output array partially sorted.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="quickselectFSw.html#Example_4">	example</a></p>	<p><span itemprop="syntax"><code>[<a class="intrnllnk" href="#outputarg_kD"><code>kD </code></a>,<a class="intrnllnk" href="#outputarg_kW"><code> kW </code></a>,<a class="intrnllnk" href="#outputarg_kstar"><code> kstar</code></a>]=quickselectFSw(___)</code></span>quickselectFSw when the weights are all equal.</p></div><div class="description_element">	<p class="syntax_example">	<a class="intrnllnk" href="quickselectFSw.html#Example_5">	example</a></p>	<p><span itemprop="syntax"><code>[<a class="intrnllnk" href="#outputarg_kD"><code>kD </code></a>,<a class="intrnllnk" href="#outputarg_kW"><code> kW </code></a>,<a class="intrnllnk" href="#outputarg_kstar"><code> kstar</code></a>,<a class="intrnllnk" href="#outputarg_varargout"><code> varargout</code></a>]=quickselectFSw(___)</code></span>Verify the definition of weighted order statistic.</p></div>								</div>							</div>							<div class="clear">							</div>						</div><div class="ref_sect" itemprop="content"><div class="examples"><h2 id="Examples">Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="example_1" class="example_module expandableContent"><div id="Example_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> quickselectFSw without optional parameter p.</li></span></a></span></h3><div class="collapse"><p>
     It gives the weighted median. The median is 3, but the weighted one
     is 4, corresponding to the weight 0.3.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">A = [1 2 3 4 5];
W = [0.15 0.1 0.2 0.3 0.25];
[kD, kW , kstar] = quickselectFSw(A,W);</pre></div></div></p></div></div><div id="example_2" class="example_module expandableContent"><div id="Example_2"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>quickselectFSw for computing a generic weighted percentile.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">A=[1 2 3 4 5];
W=[0.15 0.1 0.2 0.3 0.25];
perc = 25;
p    = perc/100;
[kD, kW , kstar] = quickselectFSw(A,W,p);</pre></div></div></p></div></div><div id="example_3" class="example_module expandableContent"><div id="Example_3"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li>quickselectFSw with the optional output array partially sorted.</li></span></a></span></h3><div class="collapse"><p><div class="programlisting"><div class="codeinput"><pre class="matlab-code">A=randperm(10);
W=abs(randn(10,1));
W=W/sum(W);
perc = 30;
p    = perc/100;
[~, ~ , ~, As] = quickselectFSw(A,W,p);
disp(As(:,1));</pre></div></div></p></div></div><div id="example_4" class="example_module expandableContent"><div id="Example_4"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> quickselectFSw when the weights are all equal.</li></span></a></span></h3><div class="collapse"><p>
     The weighted order statistic may logically reduce to the simple
     order statistic, but pay attention to the different wy to treat even
     and odd arrays.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">n=1000;
D=randperm(n);
W=ones(1,n)./n;
p=0.2;
% Very fast way to check if elements of vector are all equal
allequal=true; e=2;
while allequal && e&lt;n
if W(1)==W(e), e=e+1; else , allequal=false; end
end
if allequal
% Option 1: apply the standard quickselectFS. Note that if the array
% has an even number of elements, we need to apply quickselectFS
% twice and take the average of the two contiguous order statistics.
k = floor(p*n);
kD = quickselectFS(D,k+1);
if mod(n,2) == 0
kD2 = quickselectFS(D,k);
kD  = (kD+kD2)/2;
end
end
% Option2: apply quickselectFSw. No need to check for equal weights,
% but the weighted order statistic with percentile p may produce a
% different result if the number of elements in the array is even.
kDw = quickselectFSw(D,W,p);
disp(['quickselectFS  -&gt; ' num2str(kD)]);
disp(['quickselectFSw -&gt; ' num2str(kDw)]);</pre></div></div><pre class="codeoutput">quickselectFS  -&gt; 200.5
quickselectFSw -&gt; 200
</pre></p></div></div><div id="example_5" class="example_module expandableContent"><div id="Example_5"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"> <li><img alt="" src="images_help/M.gif" style="width: 12px; height: 12px"> Verify the definition of weighted order statistic.</li></span></a></span></h3><div class="collapse"><p>
     Check the weighted median, that is p=0.5.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">% The weighted median is the value $x$ which minimizes the weighted
% mean absolute deviation $\sum w_{i} | x_{i} - x |$.
N = 10000;
D=randperm(N);
W = abs(randn(N,1));
W = W/sum(W);
p = 0.5;
[wm , ww , kstar, wdSort]  = quickselectFSw(D,W,p);
disp(['this is kstar               = ' num2str(kstar)]);
disp(['this is the weighted median = ' num2str(wm)]);
% compute the objective function with the definition
obj = sum(W.*abs(D-wm));
disp('check if there are elements with smaller/equal objective function');
check = false;
for i = 1 : N
obj_i = sum(wdSort(:,2).*abs(wdSort(:,1)-wdSort(i,1)));
if obj_i &lt;= obj
disp(['this is i = ' num2str(i)  ' - this is wdSort(i,1) = ' num2str(wdSort(i,1))]);
check = true;
end
end
if check
disp('optimal obj is not unique');
else
disp('optimal obj is unique');
end</pre></div></div><pre class="codeoutput">this is kstar               = 5051
this is the weighted median = 5051
check if there are elements with smaller/equal objective function
optimal obj is unique
</pre></p></div></div></div><p> </p><div class="examples"><h2 id="ExtraExamples" class="bottom_ruled">Related Examples</h2><div id="expandableExamples" class="expandableContent"><p class="switch"><a class="expandAllLink"href="javascript:void(0);">expand all</a></p><div id="Extraexample_1" class="example_module expandableContent"><div id="ExtraExample_1"></div><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="example_title"><li>Use the mex function quickselectFSwmex.</li></span></a></span></h3><div class="collapse"><p>
     REMARK 1: it is necessary to pass the number of data elements.<div class="programlisting"><div class="codeinput"><pre class="matlab-code">% REMARK 2: it is necessary to pass a modified copy of the data and 
% weight arrays as indicated in the example, as the function change the
% order of the elements in the original arrays (variables are passed by
% reference).
N = 10000;
D=randperm(N);
W = abs(randn(N,1));
W = W/sum(W);
p = 0.5;
[wm , ww , kstar, wdSort]  = quickselectFSw(D,W,p);
% The next two lines are necessary to break the link between D and the
% copy which will be passed by reference to quickselectFSwmex
D_copy = D; D_copy(end+1)=999; D_copy(end)=[]; 
W_copy = W; W_copy(end+1)=999; W_copy(end)=[]; 
wm_mex = quickselectFSwmex(D_copy,W_copy,0.5,N);
disp('  ');
disp(['this is wm      = ' num2str(wm)]);
disp(['this is wm_mex  = ' num2str(wm_mex)]);
% if zero, the sorted arrays are equal. 
sum(W_copy    - wdSort(:,2))
sum(D_copy(:) - wdSort(:,1))</pre></div></div></p></div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="Inputs">Input Arguments</h2><div class="expandableContent"><div class="arguments"><div class="input_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"> <div id="inputarg_D" class="clearfix"> </div> <h3 id="input_argument_D" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>D</code> &#8212; Input data. </span>  </a><span class="example_desc">Vector.</span></span></h3> <div class="collapse"> <p><p>A vector containing a set of $n$ data elements.</p> <p>
      </p></p> <p class="datatypelist"><strong> Data Types: </strong><code>double</code></p> </div> </div><div class="expandableContent"> <div id="inputarg_W" class="clearfix"> </div> <h3 id="input_argument_W" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>W</code> &#8212; Weights. </span>  </a><span class="example_desc">Vector.</span></span></h3> <div class="collapse"> <p><p>The vector contains a set of n positive weights
      summing to 1. The 1-sum requirement does not imply loss of
      generality: it is just to avoid extra checks and the normalization
      step inside the function.</p> <p>
      </p></p> <p class="datatypelist"><strong> Data Types: </strong><code>double</code></p> </div> </div><div id="optionalarguments" class="clearfix"></div><h3 id="namevaluepairs" class="bottom_ruled">Optional Arguments</h3><div class="expandableContent"> <div id="inputarg_p" class="clearfix"> </div> <h3 id="input_argument_p" class="expand"> <span> <a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"> <span class="argument_name"><code>p</code> &#8212; 100pth percentile ($0&lt;p&lt;1$). </span>  </a><span class="example_desc">Scalar.</span></span></h3> <div class="collapse"> <p><p>A number between 0 and 1
      indicating the fraction of total weights that should be considered
      in partitioning the associated input data. Default is p=0.5, leading
      to the weighted median.</p> <p>
      </p></p>	<p class="description_valueexample">       <strong>Example: </strong><code>p,0.2
</code></p> <p class="datatypelist"><strong> Data Types: </strong><code>double</code></p> </div> </div></div></div></div></div><div class="ref_sect" itemprop="content"><h2 id="OutputArgs" >Output Arguments</h2><div class="expandableContent"><div class="arguments"><div class="output_argument_container"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent"><div id="outputarg_kD" class="clearfix"></div><h3 id="output_argument_kD" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>kD</code> &#8212;weighted order statistic in D.</span></a><span class="example_desc">Scalar</span></span></h3><div class="collapse"><p> Element kstar in vector D
         ($D(k^{*})$), for which we have $\sum_{i=1}^{k^{*}-1} w_i&lt;=p$
         and $\sum_{j=k^{*}+1}^{n} w_j&lt;=1-p$.</p></div></div><div class="expandableContent"><div id="outputarg_kW" class="clearfix"></div><h3 id="output_argument_kW" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>kW</code> &#8212;weight associated to kD.</span></a><span class="example_desc">Scalar</span></span></h3><div class="collapse"><p> Element kstar in vector W. The
         weight partition around kW is optimal in the sense that the sum
         of the weights on its left is as close as possible to $p$ and
         those on its right account for the remaining $1-p$.</p></div></div><div class="expandableContent"><div id="outputarg_kstar" class="clearfix"></div><h3 id="output_argument_kstar" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>kstar</code> &#8212;the index of kD in D and of kW in W.</span></a><span class="example_desc">Scalar</span></span></h3><div class="collapse"><p> It is the position
         of the weighted order statistic in the data and weight vectors,
         that is $D(k^{*})$ and $W(k^{*})$.</p></div></div><div class="expandableContent"><div id="outputarg_varargout" class="clearfix"></div><h3 id="output_argument_varargout" class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span class="argument_name"><code>varargout</code> &#8212;Ds  : Output vector.</span></a><span class="example_desc">Array</span></span></h3><div class="collapse"><p> At the and of the computation the vector
         [D(:) , W(:)] is appropriately partitioned around kstar. It is
         returned ordered in the interval (1:kstar-1,:). Remark: this
         operation sorts only part of the array, but it can still slow
         down the algorithm.</p></div></div></div></div></div></div><div class="moreabout ref_sect"><h2 id="MoreAbout">More About</h2><div class="expandableContent"><p class="switch"><a class="expandAllLink" href="javascript:void(0);">expand all</a></p><div class="expandableContent" itemprop="content"><h3 class="expand"><span><a href="javascript:void(0);" style="display: block;" title="Expand/Collapse"><span>Additional Details</span></a></span></h3><div class="expand"><p><p>
   quickselectFSw builds on quickselectFS, the algorithm used to find
   order statistics. Data and weights are collapsed to a single vector
   D=[D(:),W(:)] (point 2). The core part of quickselectFS is called on D
   assuming that the weighted percentile is in position k=ceil(n*p) (point
   3). This step permutes vector D so that the elements in positions
   (1:k-1,:) are smaller than the element at position k. At this point we
   check if the array fulfills the weighted median condition by Bleich and
   Overton (1985) (point 5). If so, we stop computation (point 6.). If
   not, we apply again the core part of quickselectFS on either D(1:k,:)
   with k+1, or D(k:n,:) with k-1. The iteration will remove or add
   weights in order to approach the optimality condition (see points 7,8
   and 9). The process is iterated till success.</p> <p>

</p></p></div></div></div></div><div class="ref_sect" itemprop="content"><div class="bibliography"><h2 id="References">References</h2> <div><p>Bleich, C. and Overton, M.L. (1983), A linear-time algorithm for the
   weighted median problem. Technical Report 75, New York University,
   Courant Institute of Mathematical Sciences.</p></div><div><p>Azzini, I., Perrotta, D. and Torti, F. (2022), An efficient and
   extensible fixed-pivot selection algorithm, submitted.</p></div></div></div><div class="ref_sect"><h2 id="SeeAlso">See Also</h2><p><span itemprop="seealso"><a href="quickselectFS.html" itemprop="url"><span itemprop="name"><code>quickselectFS</code></span></a></span></div><i>This page has been automatically generated by our routine <a href="publishFS.html">publishFS</a></i></div></section></div></div></div></div><div id="divbottom"></div></body></html>